<!doctype html><html lang=en dir=ltr itemscope itemtype=https://schema.org/Article>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<title>Anonymous access for SharePoint autohosted apps</title>
<meta name=author content="Vincent Biret">
<meta name=description content="These days I’ve been working on an auto hosted app for SharePoint (office 365 actually).
I had to grant an anonymous access to one of the pages without requiring clients to give anonymous access to...">
<meta name=generator content="Hugo 0.89.0">
<meta itemprop=name content="Anonymous access for SharePoint autohosted apps">
<meta itemprop=description content="These days I’ve been working on an auto hosted app for SharePoint (office 365 actually).
I had to grant an anonymous access to one of the pages without requiring clients to give anonymous access to...">
<meta itemprop=image content="/img/logo.svg">
<meta property="og:title" content="Anonymous access for SharePoint autohosted apps">
<meta property="og:type" content="article">
<meta property="og:url" content="https://baywet.github.io/anonymous-access-for-sharepoin/">
<meta property="og:image" content="/img/logo.svg">
<meta property="og:description" content="These days I’ve been working on an auto hosted app for SharePoint (office 365 actually).
I had to grant an anonymous access to one of the pages without requiring clients to give anonymous access to...">
<meta property="og:site_name" content="Baywet's blog">
<meta property="og:updated_time" content="2021-11-03T07:05:23-04:00">
<meta property="article:published_time" content="2014-03-12T17:03:38+00:00">
<meta property="article:modified_time" content="2021-11-03T07:05:23-04:00">
<meta property="article:section" content>
<meta property="article:tag" content="autohosted">
<meta property="article:tag" content="dev">
<meta property="article:tag" content="app">
<meta property="article:tag" content="office365">
<meta property="article:tag" content="sharepoint">
<meta name=twitter:card content="summary">
<meta name=twitter:site content>
<meta name=twitter:title content="Anonymous access for SharePoint autohosted apps">
<meta name=twitter:description content="These days I’ve been working on an auto hosted app for SharePoint (office 365 actually).
I had to grant an anonymous access to one of the pages without requiring clients to give anonymous access to...">
<meta name=twitter:creator content>
<meta name=twitter:image:src content="/img/logo.svg">
<link rel=stylesheet type=text/css href=/css/capsule.min.css>
<script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-176061333-1','auto'),ga('send','pageview')</script>
<link rel=apple-touch-icon href=/img/apple-touch-icon.png>
<link rel=icon href=/img/favicon.ico>
</head>
<body style=min-height:100vh;display:flex;flex-direction:column>
<nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation">
<div class=container>
<div class=navbar-brand>
<a class=navbar-item href=/en>
<div class="title is-4">&nbsp;Baywet's blog</div>
</a>
<label class="button navbar-burger is-white" for=navbar-burger-state>
<span></span>
<span></span>
<span></span>
</label>
</div>
<input type=checkbox id=navbar-burger-state>
<div class=navbar-menu>
<div class=navbar-end>
<a class=navbar-item href=https://baywet.github.io/fr/acces-anonyme-a-une-applicatio/>Français</a>
</div>
</div>
</div>
</nav>
<section class=section style=flex:1>
<div class=container>
<h1 class=title>Anonymous access for SharePoint autohosted apps</h1>
<p class=subtitle>Mar 12, 2014</p>
<div class=content>
<p>These days I’ve been working on an auto hosted app for SharePoint (office 365 actually).</p>
<p>I had to grant an anonymous access to one of the pages without requiring clients to give anonymous access to their SharePoint site. But I still needed to read a few properties from the App Web web site (the SPWeb provisioned by SharePoint when installing an app)</p>
<p>I had to play around a lot but I finally found the solution:</p>
<p>//uri of the app web, you can pass this url via a query string parameter</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-CSharp data-lang=CSharp><span style=color:#66d9ef>var</span> targetUrl = <span style=color:#66d9ef>new</span> Uri(<span style=color:#e6db74>&#34;https://&lt;tenantname&gt;-&lt;appinstallationid&gt;.sharepoint.com/&lt;appname&gt;&#34;</span>);

<span style=color:#66d9ef>var</span> token = TokenHelper.GetAppOnlyAccessToken(TokenHelper.SharePointPrincipal, targetUrl.Authority, TokenHelper.GetRealmFromTargetUrl(targetUrl));

<span style=color:#66d9ef>using</span> (<span style=color:#66d9ef>var</span> ctx = TokenHelper.GetClientContextWithAccessToken(targetUrl.ToString(), token.AccessToken))
</code></pre></div><p>You also need to add the “allow app only calls to SharePoint” in the manifest.</p>
<p><img src=./clip_5F00_image002_5F00_thumb_5F00_2012688F.jpg alt=clip_5F00_image002_5F00_thumb_5F00_2012688F.jpg></p>
<p>I hope it’ll save you a lot of time.</p>
<p>Cheers</p>
</div>
<br>
<p class=heading>
Last edited
<a href=https://github.com/baywet/blogsource/commit/3b1b9f8366a3bec704f564b0345e4523a08e93fc>
Nov 3, 2021
</a> by <a href=https://github.com/baywet>Vincent Biret</a>
</p>
<br>
<div class=heading>Tags:</div>
<div class="field is-grouped is-grouped-multiline">
<div class=control>
<a href=/tags/autohosted>
<span class=tag>Autohosted</span>
</a>
</div>
<div class=control>
<a href=/tags/dev>
<span class=tag>Dev</span>
</a>
</div>
<div class=control>
<a href=/tags/app>
<span class=tag>App</span>
</a>
</div>
<div class=control>
<a href=/tags/office365>
<span class=tag>Office365</span>
</a>
</div>
<div class=control>
<a href=/tags/sharepoint>
<span class=tag>Sharepoint</span>
</a>
</div>
</div>
</div>
</section>
<section class=section>
<div class=container>
<div class=level>
<div class=level-left>
<div class=level-item>
<p class="control has-addons">
<a class=button href=https://baywet.github.io/outstanding-announcements-of-t/>
<span class="icon is-small"><i class="fa fa-chevron-left"></i></span>
<span class="is-hidden-touch is-hidden-desktop-only">
Outstanding announcements of the SharePoint Conference 2014 for Office 365
</span>
<span class="is-hidden-touch is-hidden-widescreen">
Outstanding announcements of the SharePoint Conference 2014 for Office 365
</span>
<span class="is-hidden-mobile is-hidden-desktop">
Outstanding announcements of the SharePoint...
</span>
<span class=is-hidden-tablet>
Outstanding announcements of the...
</span>
</a>
</p>
</div>
</div>
<div class=level-right>
<div class=level-item>
<p class="control has-addons">
<a class=button href=https://baywet.github.io/operating-system-compatibility/>
<span class="is-hidden-touch is-hidden-desktop-only">
Operating system compatibility of SharePoint 2010/2013 has evolved
</span>
<span class="is-hidden-touch is-hidden-widescreen">
Operating system compatibility of SharePoint 2010/2013 has evolved
</span>
<span class="is-hidden-mobile is-hidden-desktop">
Operating system compatibility of SharePoint...
</span>
<span class=is-hidden-tablet>
Operating system compatibility of...
</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
</a>
</p>
</div>
</div>
</div>
</div>
<br>
<br>
<div class=container>
<div id=disqus_thread></div>
<script>var disqus_config=function(){this.page.url="https://baywet.github.io/anonymous-access-for-sharepoin/",this.page.identifier=window.location.pathname};(function(){var a=document,b=a.createElement('script');b.src='https://baywet.disqus.com/embed.js',b.setAttribute('data-timestamp',+new Date),(a.head||a.body).appendChild(b)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
</div>
<br>
<div class=container>
<nav class=panel>
<p class=panel-heading>Related</p>
<a class=panel-block href=https://baywet.github.io/operating-system-compatibility/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Operating system compatibility of SharePoint 2010/2013 has evolved&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/repackaging-of-sharepoint-2010/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Repackaging of SharePoint 2010 language packs&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/march-update-of-visual-studio/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>March Update of Visual Studio tools for Office&nbsp;
<div class=tag>Dev</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/managing-resources-how-to-make/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Managing Resources, how to make your SharePoint solutions “globally deployed”&nbsp;
<div class=tag>Dev</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/help-me-to-speak-at-sp24-the-f/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Help me to speak at SP24 the first SharePoint (web) conference all around the world!&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/boost-your-sharepoint-solution-2013-12-15-12-06-00/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Boost your SharePoint solutions with distributed cache!–Part 2–Explanations tips and warnings&nbsp;
<div class=tag>Dev</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/boost-your-sharepoint-solution-2013-12-13-02-35-30/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Boost your SharePoint solutions with distributed cache!- Part 1–Introduction&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/sharepoint-auto-hosted-app-and/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>SharePoint Auto hosted app and ASP.NET MVC&nbsp;
<div class=tag>Dev</div>
<div class=tag>App</div>
<div class=tag>Office365</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/entity-framework-and-dataconte/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Entity Framework and dataContext reference for a web application&nbsp;
<div class=tag>Dev</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/speaker-at-sharepoint-saturday/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Speaker at SharePoint Saturday Ottawa!&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/the-name-initializecon/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>(English) The name 'InitializeControl' does not exist in the current context Controles utilisateur, SharePoint 2013 and Ressources&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
</nav>
</div>
</section>
<footer class=footer>
<div class=container>
<nav class=level>
</nav>
<nav class=level>
<div class="level-left has-text-centered">
<div class=level-item>
<form class="control has-icons has-icons-right" method=get action=https://bing.com>
<input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span>
</form>
</div>
</div>
<div class="level-right has-text-centered">
<div class=level-item>
<a class=button href=https://baywet.github.io/en>
<span class=icon><i class="fa fa-home"></i></span>
</a> &nbsp;
<a class=button href>
<span class=icon><i class="fa fa-rss"></i></span>
</a>
</div>
</div>
</nav>
</div>
</footer>
<script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script>
</body>
</html>