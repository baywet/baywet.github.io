<!doctype html><html lang=en dir=ltr itemscope itemtype=https://schema.org/Article><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>New SharePoint Framework PnP Samples available: using the Skype UCWA Web SDK to subscribe to people’s status</title><meta name=author content="Vincent Biret"><meta name=description content="TL;DR;
I added two new SharePoint framework WebParts PnP sample to demonstrate how to use the Unified Communications Web API JavaScript SDK from Skype for business. This SDK allows you to do things..."><meta name=generator content="Hugo 0.74.3"><meta itemprop=name content="New SharePoint Framework PnP Samples available: using the Skype UCWA Web SDK to subscribe to people’s status"><meta itemprop=description content="TL;DR;
I added two new SharePoint framework WebParts PnP sample to demonstrate how to use the Unified Communications Web API JavaScript SDK from Skype for business. This SDK allows you to do things..."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="New SharePoint Framework PnP Samples available: using the Skype UCWA Web SDK to subscribe to people’s status"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/new-sharepoint-framework-pnp-s/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="TL;DR;
I added two new SharePoint framework WebParts PnP sample to demonstrate how to use the Unified Communications Web API JavaScript SDK from Skype for business. This SDK allows you to do things..."><meta property="og:site_name" content="Baywet's blog"><meta property="og:updated_time" content="2020-09-13T11:06:20-04:00"><meta property="article:published_time" content="2018-01-08T09:00:00+00:00"><meta property="article:modified_time" content="2020-09-13T11:06:20-04:00"><meta property="article:section" content><meta property="article:tag" content="ucwa"><meta property="article:tag" content="sharepoint framework"><meta property="article:tag" content="spfx"><meta property="article:tag" content="skype"><meta property="article:tag" content="sharepoint"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="New SharePoint Framework PnP Samples available: using the Skype UCWA Web SDK to subscribe to people’s status"><meta name=twitter:description content="TL;DR;
I added two new SharePoint framework WebParts PnP sample to demonstrate how to use the Unified Communications Web API JavaScript SDK from Skype for business. This SDK allows you to do things..."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-176061333-1','auto');ga('send','pageview');</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/en><div class="title is-4">&nbsp;Baywet's blog</div></a><label class="button navbar-burger is-white" for=navbar-burger-state><span></span><span></span><span></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=https://baywet.github.io/fr/nouveaux-exemples-sharepoint-f/>Français</a></div></div></div></nav><section class=section style=flex:1><div class=container><h1 class=title>New SharePoint Framework PnP Samples available: using the Skype UCWA Web SDK to subscribe to people’s status</h1><p class=subtitle>Jan 8, 2018</p><div class=content><h2 id=tldr>TL;DR;</h2><p>I added two new SharePoint framework WebParts PnP sample to demonstrate how to use the Unified Communications Web API JavaScript SDK from Skype for business. This SDK allows you to do things like subscribe to a person status, start instant messaging conversations, calls…</p><p><img src=./16.gif alt=16.gif></p><p>To get a look:</p><ul><li>The <a href=https://github.com/SharePoint/sp-dev-fx-webparts/tree/master/samples/js-skype-status>plain JS sample</a></li><li>The <a href=https://github.com/SharePoint/sp-dev-fx-webparts/tree/master/samples/react-skype-status>reactJS + Office UI Fabric React sample</a>(persona card)</li></ul><h2 id=long-version>Long version</h2><p>I recently had the occasion to make my first contribution to PnP (besides creating issues and helping investigate those). In these two new samples I show you how to you how to leverage the Skype UCWA SDK to subscribe and display people skype status.</p><p>That skype status will update itself it changes (ie: the target user sets his/her status to something different in Skype for business or goes offline).</p><p>This approach is better than the previous ones leveraging <a href=https://social.technet.microsoft.com/Forums/en-US/be668c7e-19f8-41c4-a568-20f3e29e378c/how-to-display-lync-status-on-content-query-webpart-in-sharepoint-online>office integration, activeX</a> or the SharePoint File User Status because:</p><ul><li>It is cross platform (doesn’t need activeX, Internet Explorer, or security zones configuration)</li><li>It does not require Office to be installed on the machine or the user to be singed in Skype for Business</li><li>It updates with status changes</li><li>It does not need a file to be created and can be rendered anywhere on the page<ul><li>(<em>the file presence indicator is SharePoint talking to the Skype server and rendering some HTML, but it only does so in libraries)</em></li></ul></li></ul><h3 id=the-ucwa>The UCWA</h3><p>The API itself is a bit peculiar a doesn’t necessary works like a “standard API” (OAuth + REST). The key differences being:</p><ul><li>You can subscribe to some of the object model (status, conversations, audio/video feeds…)</li><li>Authentication is a bit (too) complex<ul><li>It’s not standard and expects you to get a 403 in order to get the identity provider information</li><li>The discovery server also acts like a relay and the “API” is segmented in multiple resources (besides the permissions) which necessitates multiple rounds of authorization.</li></ul></li><li>Not OData capable (we got used to that in the Microsoft world)</li></ul><p>All those differences impart the few SDK’s. The JS SDK (the one used in the samples) is a bit “old fashioned”. I really wish they spent some time:</p><ul><li>Moving to UMD and not a global var</li><li>Providing npm packages and not a single bundle on the CDN</li><li>Providing types definitions</li><li>Providing better version information (+ semver)</li><li>Allowing developer to leverage their own auth libraries (like hellojs or msal) instead of the implementation the have bundled.</li></ul><p>Those are the main reasons why I’m side loading the script and not including it as an external dependency in the samples.</p><p>Lastly, the documentation is a little bit all over the place, I’d suggest you corroborate the information even from official sources because it looks like some of the documentation hasn’t been updated. Here are the entry points:</p><ul><li><a href="https://msdn.microsoft.com/en-us/skype/ucwa/unifiedcommunicationswebapi2_0?f=255&MSPPError=-2147217396">https://msdn.microsoft.com/en-us/skype/ucwa/unifiedcommunicationswebapi2_0?f=255&MSPPError=-2147217396</a></li><li><a href=https://ucwa.skype.com/>https://ucwa.skype.com/</a></li><li><a href=https://ucwa.skype.com/reference/WebSDK/modules/_s4b_sdk_d_.jcafe.html>https://ucwa.skype.com/reference/WebSDK/modules/_s4b_sdk_d_.jcafe.html</a></li></ul><h3 id=microsoft-teams-vs-skype>Microsoft Teams vs Skype</h3><p>The skype for business API’s are still not available through the Microsoft Graph. And Microsoft<a href=https://www.theverge.com/2017/9/25/16360072/microsoft-teams-replacing-skype-for-business>announced that Microsoft Teams is going to be the future</a> for unified communications, instant messaging and so much more. However, Skype for business Server is going to keep being the backend (and at least provide some of the APIs) for a least a few years.</p></div><br><p class=heading>Last edited
<a href=https://github.com/baywet/blogsource/commit/568d5785231309e09639a038db8aa4f4e71568c3>Sep 13, 2020</a> by <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/tags/ucwa><span class=tag>Ucwa</span></a></div><div class=control><a href=/tags/sharepoint-framework><span class=tag>Sharepoint Framework</span></a></div><div class=control><a href=/tags/spfx><span class=tag>Spfx</span></a></div><div class=control><a href=/tags/skype><span class=tag>Skype</span></a></div><div class=control><a href=/tags/sharepoint><span class=tag>Sharepoint</span></a></div><div class=control><a href=/tags/development><span class=tag>Development</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/git-forkimportmanual-copy-keep/><span class="icon is-small"><i class="fa fa-chevron-left"></i></span><span class="is-hidden-touch is-hidden-desktop-only">Git: fork/import/manual copy, keep it clean</span>
<span class="is-hidden-touch is-hidden-widescreen">Git: fork/import/manual copy, keep it clean</span>
<span class="is-hidden-mobile is-hidden-desktop">Git: fork/import/manual copy, keep it clean</span>
<span class=is-hidden-tablet>Git: fork/import/manual copy, keep it...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/speaking-at-sharepoint-fest-dc-2018-01-05-09-00-00/><span class="is-hidden-touch is-hidden-desktop-only">Speaking at SharePoint Fest DC (Washington) 2018</span>
<span class="is-hidden-touch is-hidden-widescreen">Speaking at SharePoint Fest DC (Washington) 2018</span>
<span class="is-hidden-mobile is-hidden-desktop">Speaking at SharePoint Fest DC (Washington) 2018</span>
<span class=is-hidden-tablet>Speaking at SharePoint Fest DC...</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/new-sharepoint-framework-pnp-s/";this.page.identifier=window.location.pathname;};(function(){var d=document,s=d.createElement('script');s.src='https://baywet.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/full-version-of-lodash-now-ava/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Full version of lodash now available in the SharePoint Framework&nbsp;<div class=tag>Sharepoint Framework</div><div class=tag>Spfx</div><div class=tag>Development</div></span></a><a class=panel-block href=https://baywet.github.io/speaking-at-sharepoint-saturda-2017-11-16-17-26-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Speaking at SharePoint Saturday Detroit 2017&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/using-pnp-powershell-on-visual/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Using PnP PowerShell on Visual Studio Team Services (VSTS) Hosted Agent&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/speaking-at-sharepoint-saturda-2017-09-07-08-00-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Speaking at SharePoint Saturday Ottawa 2017&nbsp;<div class=tag>Sharepoint Framework</div></span></a><a class=panel-block href=https://baywet.github.io/speaking-at-sharepoint-saturda-2017-07-13-08-00-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Speaking at SharePoint Saturday Brussels 2017&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/re-awarded-microsoft-mvp-for-y/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Re-awarded Microsoft MVP for year 2017 2018&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/speaking-at-sharepoint-saturda-2017-07-06-08-00-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Speaking at SharePoint Saturday New York City 2017&nbsp;<div class=tag>Sharepoint Framework</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/sharepoint-framework-in-my-own/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>SharePoint Framework in my own words&nbsp;<div class=tag>Sharepoint Framework</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/update-to-sppagecontextinfo-ty/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Update to _spPageContextInfo type definitions - new properties available&nbsp;<div class=tag>Sharepoint Framework</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/customizing-page-layouts-maste/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Customizing page layouts, master pages and image renditions in SharePoint Online&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/speaking-at-techorama-belgium/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Speaking at Techorama Belgium 2017&nbsp;<div class=tag>Sharepoint Framework</div><div class=tag>Spfx</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/publishing-sharepoint-image-re/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Publishing SharePoint Image renditions with PnP Provisioning&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/speaking-at-sharepoint-saturda-2017-03-09-14-00-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Speaking at SharePoint Saturday Vancouver 2017&nbsp;<div class=tag>Sharepoint Framework</div><div class=tag>Spfx</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/speaking-at-sharepoint-saturda-2017-03-07-16-00-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Speaking at SharePoint Saturday Calgary 2017&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/speaking-at-aos-tours-ottawa-a/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Speaking at Aos Tours Ottawa and Toronto&nbsp;<div class=tag>Sharepoint</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/en><span class=icon><i class="fa fa-home"></i></span></a>&nbsp;
<a class=button href><span class=icon><i class="fa fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>