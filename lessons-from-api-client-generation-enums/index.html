<!doctype html><html lang=en dir=ltr itemscope itemtype=https://schema.org/Article><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Lessons learned from API client generation - 02 Enumerations</title>
<meta name=author content="Vincent Biret"><meta name=description content="First pattern of our series: enumerations. They are essential to any programing language to describe a discrete set of options. Consider the following examples:
components:
  schemas:
    Model:..."><meta name=generator content="Hugo 0.123.0"><meta itemprop=name content="Lessons learned from API client generation - 02 Enumerations"><meta itemprop=description content="First pattern of our series: enumerations. They are essential to any programing language to describe a discrete set of options. Consider the following examples:
components:
  schemas:
    Model:..."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Lessons learned from API client generation - 02 Enumerations"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/lessons-from-api-client-generation-enums/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="First pattern of our series: enumerations. They are essential to any programing language to describe a discrete set of options. Consider the following examples:
components:
  schemas:
    Model:..."><meta property="og:site_name" content="Baywet's blog"><meta property="og:updated_time" content="2024-02-19T17:03:44-05:00"><meta property="article:published_time" content="2022-10-01T10:21:00+00:00"><meta property="article:modified_time" content="2024-02-19T17:03:44-05:00"><meta property="article:section" content><meta property="article:tag" content="kiota"><meta property="article:tag" content="OpenAPI"><meta property="article:tag" content="REST"><meta property="article:tag" content="JSON Schema"><meta property="article:tag" content="ASC 2022 session rundown"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Lessons learned from API client generation - 02 Enumerations"><meta name=twitter:description content="First pattern of our series: enumerations. They are essential to any programing language to describe a discrete set of options. Consider the following examples:
components:
  schemas:
    Model:..."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/js/all.js integrity=sha384-IkmLcEDxkvCioiswmdraONwAU9uwbPWUbvuHAGrejK3zNlL74FCwCjvnTGJcrdbQ crossorigin=anonymous></script><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-176061333-1","auto"),ga("send","pageview")</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/><div class="title is-4">&nbsp;Baywet's blog</div></a><label role=button class="navbar-burger has-text-dark" aria-label=menu aria-expanded=false for=navbar-burger-state><span aria-hidden=true></span>
<span aria-hidden=true></span>
<span aria-hidden=true></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=/fr>Français</a></div></div></div></nav><section class=section style=flex:1><div class=container><h1 class=title>Lessons learned from API client generation - 02 Enumerations</h1><p class=subtitle>Oct 1, 2022</p><div class=content><p>First pattern of <a href=https://baywet.github.io/tags/asc-2022-session-rundown/>our series</a>: enumerations. They are essential to any programing language to describe a discrete set of options. Consider the following examples:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>components</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>schemas</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>Model</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>object</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>properties</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>enumString</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>type</span>: <span style=color:#ae81ff>string</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>enum</span>:
</span></span><span style=display:flex><span>          - <span style=color:#ae81ff>value1</span>
</span></span><span style=display:flex><span>          - <span style=color:#ae81ff>value2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>enumInteger</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>type</span>: <span style=color:#ae81ff>integer</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>enum</span>:
</span></span><span style=display:flex><span>          - <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>          - <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>enumBoolean</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>type</span>: <span style=color:#ae81ff>boolean</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>enum</span>:
</span></span><span style=display:flex><span>          - <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>          - <span style=color:#66d9ef>false</span>
</span></span></code></pre></div><p><strong>EnumString</strong> describes two possible values, however it’s missing a lot of information:</p><ul><li>We can’t specify a different serialization value from the symbol.</li><li>We can’t specify a description which would be helpful to developers who discover the API surface through a client.</li></ul><p><strong>EnumInteger</strong> describes an integer type enumeration, where each option is a number. While this is a valid scenario, it makes code generation harder as most programming languages don’t accept numbers or strings starting with numbers as valid symbols which leads to compilation errors. Additionally, if the enumeration values are powers of 2, the enumeration is flaggable (supports compounded values through a bitwise or). But we have no way to convey this information.</p><p><strong>EnumBoolean</strong> is a Boolean type enumeration. In my opinion, it is completely useless. A boolean is an enumeration that can only hold two possible values.</p><h2 id=suggestions>Suggestions</h2><p>Interestingly enough, <a href=https://azure.github.io/autorest/extensions/#x-ms-enum>autorest already has an extension defined</a> to bridge some of those gaps and I believe the solution should be based on that early work.
First, we need to introduce the placeholder for the missing information, and if possible, avoid breaking existing descriptions out there.
The enum property should be extended in the OpenAPI JSON schema vocabulary to be an array of symbols (like it is today) or an object with the following properties:</p><ul><li>Items, array of objects (value, name, description).</li><li>Composable (Boolean).</li><li>Description.</li><li>Summary.</li></ul><p>Second, we must encourage people to do the right thing when describing their APIs and I think linting tools like spectral should introduce the following rules:</p><ul><li>Error if the description contains an enum of type Boolean, just use a Boolean.</li><li>Error if the description contains a number enum item without the name property we introduced above.</li><li>Error if the description contains a composable enum, but the values are not powers of 2.</li><li>Warning if enum items don’t have descriptions.</li></ul><p>The resulting enum would look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>components</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>schemas</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>Model</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>object</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>properties</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>enumInteger</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>type</span>: <span style=color:#ae81ff>integer</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>default</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>enum</span>:
</span></span><span style=display:flex><span>          - <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>          - <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>x-ms-enum</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>name</span>: <span style=color:#ae81ff>EnumInteger</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>flags</span>: <span style=color:#66d9ef>true</span> <span style=color:#75715e># this doesn&#39;t exist in the extension today</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>values</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>value</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Value1</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>description</span>: <span style=color:#ae81ff>Value 1</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>value</span>: <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Value2</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>description</span>: <span style=color:#ae81ff>Value 2</span>
</span></span></code></pre></div></div><br><p class=heading>Last edited
<a href=https://github.com/baywet/blogsource/commit/e20f40f9f1f37d9073420b1cccf86f5d84391eb0>Feb 19, 2024
</a>by <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/tags/kiota><span class=tag>Kiota</span></a></div><div class=control><a href=/tags/openapi><span class=tag>Open API</span></a></div><div class=control><a href=/tags/rest><span class=tag>Rest</span></a></div><div class=control><a href=/tags/json-schema><span class=tag>JSON Schema</span></a></div><div class=control><a href=/tags/asc-2022-session-rundown><span class=tag>Asc 2022 Session Rundown</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/lessons-from-api-client-generation-collections/><span class="icon is-small"><i class="fas fa-chevron-left"></i></span>
<span class="is-hidden-touch is-hidden-desktop-only">Lessons learned from API client generation - 03 Collections
</span><span class="is-hidden-touch is-hidden-widescreen">Lessons learned from API client generation - 03 Collections
</span><span class="is-hidden-mobile is-hidden-desktop">Lessons learned from API client generation - 03...
</span><span class=is-hidden-tablet>Lessons learned from API client...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/lessons-from-api-client-generation-intro/><span class="is-hidden-touch is-hidden-desktop-only">Lessons learned from API client generation - 01 Introduction
</span><span class="is-hidden-touch is-hidden-widescreen">Lessons learned from API client generation - 01 Introduction
</span><span class="is-hidden-mobile is-hidden-desktop">Lessons learned from API client generation - 01...
</span><span class=is-hidden-tablet>Lessons learned from API client...
</span><span class="icon is-small"><i class="fas fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/lessons-from-api-client-generation-enums/",this.page.identifier=window.location.pathname};(function(){var e=document,t=e.createElement("script");t.src="https://baywet.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/lessons-from-api-client-generation-intro/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Lessons learned from API client generation - 01 Introduction&nbsp;<div class=tag>Kiota</div><div class=tag>Open API</div><div class=tag>Rest</div><div class=tag>JSON Schema</div><div class=tag>Asc 2022 Session Rundown</div></span></a><a class=panel-block href=https://baywet.github.io/speaking-at-cdc-2022/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Speaking at Caribbean Developer Conference 2022&nbsp;<div class=tag>Kiota</div><div class=tag>Open API</div></span></a><a class=panel-block href=https://baywet.github.io/speaking-at-collabdays-belgium-2022/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Speaking at CollabDays Belgium 2022&nbsp;<div class=tag>Kiota</div><div class=tag>Open API</div></span></a><a class=panel-block href=https://baywet.github.io/speaking-at-api-specification-conf-2022/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Speaking at the API specification conference 2022&nbsp;<div class=tag>Kiota</div><div class=tag>Open API</div><div class=tag>JSON Schema</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fas fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/en><span class=icon><i class="fa fa-home"></i></span>
</a>&nbsp;
<a class=button href><span class=icon><i class="fas fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>