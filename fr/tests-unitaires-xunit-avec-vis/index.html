<!doctype html><html lang=fr dir=ltr itemscope itemtype=https://schema.org/Article><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Tests unitaires xUnit avec Visual Studio Team Services de projets DNX</title><meta name=author content="Vincent Biret"><meta name=description content="Tests unitaires xUnit avec Visual Studio Team Services de projets DNX
Introduction
Avec DNX qui va bientôt passer en version finale vous allez être de plus en plus nombreux à vouloir effectuer des..."><meta name=generator content="Hugo 0.111.3"><meta itemprop=name content="Tests unitaires xUnit avec Visual Studio Team Services de projets DNX"><meta itemprop=description content="Tests unitaires xUnit avec Visual Studio Team Services de projets DNX
Introduction
Avec DNX qui va bientôt passer en version finale vous allez être de plus en plus nombreux à vouloir effectuer des..."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Tests unitaires xUnit avec Visual Studio Team Services de projets DNX"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/fr/tests-unitaires-xunit-avec-vis/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="Tests unitaires xUnit avec Visual Studio Team Services de projets DNX
Introduction
Avec DNX qui va bientôt passer en version finale vous allez être de plus en plus nombreux à vouloir effectuer des..."><meta property="og:site_name" content="Le blog de baywet"><meta property="og:updated_time" content="2023-04-07T15:30:25-04:00"><meta property="article:published_time" content="2016-03-01T14:00:00+00:00"><meta property="article:modified_time" content="2023-04-07T15:30:25-04:00"><meta property="article:section" content><meta property="article:tag" content="build"><meta property="article:tag" content="qualite"><meta property="article:tag" content="tests"><meta property="article:tag" content="alm"><meta property="article:tag" content="vsts"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Tests unitaires xUnit avec Visual Studio Team Services de projets DNX"><meta name=twitter:description content="Tests unitaires xUnit avec Visual Studio Team Services de projets DNX
Introduction
Avec DNX qui va bientôt passer en version finale vous allez être de plus en plus nombreux à vouloir effectuer des..."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-176061333-1","auto"),ga("send","pageview")</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/fr><div class="title is-4">&nbsp;Le blog de baywet</div></a><label class="button navbar-burger is-white" for=navbar-burger-state><span></span>
<span></span>
<span></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=https://baywet.github.io/units-tests-using-xunit-and-vi/>English</a></div></div></div></nav><section class=section style=flex:1><div class=container><h1 class=title>Tests unitaires xUnit avec Visual Studio Team Services de projets DNX</h1><p class=subtitle>Mar 1, 2016</p><div class=content><p>Tests unitaires xUnit avec Visual Studio Team Services de projets DNX</p><h2 id=introduction>Introduction</h2><p>Avec DNX qui va bientôt passer en version finale vous allez être de plus en plus nombreux à vouloir effectuer des tests unitaires afin de vous assurer de la qualité des développements effectués.</p><p>Idéalement ces tests seront exécutés dans un processus d’intégration continue afin de s’assurer qu’il n’y a pas eu de régressions techniques, fonctionnelles et/ou de performance.</p><p>Dans le monde du .NET il existe historiquement plusieurs outils pour mettre en place cela :</p><ul><li><p>MSTest/VSTest</p></li><li><p>Nunit</p></li><li><p>xUnit</p></li><li><p>…</p></li></ul><p>(une liste non exhaustive <a href=https://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#C.23>https://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#C.23</a> )</p><p>Dans notre cas nous avions fait le choix d’utiliser xUnit car en plus d’être largement utilisé et supporté par la communauté, c’est l’un des rares à supporter DNX.</p><p>Autre chose, vous avez dû le remarquer au travers de mes billets précédents, nous utilisons massivement l’industrie logicielle fournie par Visual Studio Team Services (VSO) avec notamment le build2015 et le release management.</p><p>Pour rappel DNX = « nouveau framework » ce qui veut dire que l’outillage doit être adapté et recompilé pour le supporter correctement.</p><h2 id=tests-locaux-et-projet-de-tests>Tests locaux et projet de tests</h2><p>Après avoir suivi ce tutoriel, il nous a été possible d’écrire des tests dans un projet de librairie dnx (qui donne un nuget à la fin) et d’exécuter ces tests en local via la console (dnx test) ou bien via le test explorer.</p><p><a href=https://asp.net-hacker.rocks/2015/12/15/unit-testing-dnx-libraries-with-xunit.html>https://asp.net-hacker.rocks/2015/12/15/unit-testing-dnx-libraries-with-xunit.html</a></p><p><a href=https://xunit.github.io/docs/getting-started-dnx.html>https://xunit.github.io/docs/getting-started-dnx.html</a></p><p><img src=./73.png alt=73.png></p><p><img src=./74.png alt=74.png></p><p><img src=./75.png alt=75.png></p><p>Note vous pouvez aussi utiliser yeoman pour générer le projet de tests en tapant yo aspnet et en sélectionnant l’entrée correspondant aux tests.</p><p><strong>Maintenant la question est la suivante : comment faire pour que VSO/VSTS exécute et rapatrie le résultat de ces tests dans les informations de build/test ?</strong></p><h2 id=exécution-des-tests-dans-lagent>Exécution des tests dans l’agent</h2><p>La première étape c’est de demander à l’agent VSO d’exécuter les tests, pour cela rien de plus facile, il suffit d’exécuter un script powerhell.</p><p>dnx -p &ldquo;.\src\BizDesk365ContentService.Tests" test -xml TestResults.xml</p><p>Le premier paramètre est le chemin relatif de mon projet de tests. Le second demande au runner dnx de xunit de produire les résultats dans un fichier xml dont nous auront besoin plus tard.</p><p>Dans mon exemple ici j’ai rajouté des lignes qui me permettent de m’assurer que dnvm, mon runtime et dnx sont bien là, mais selon votre configuration ce n’est pas forcément obligatoire.</p><p><a href=https://gist.github.com/baywet/4daabc875cab427ef1bc>https://gist.github.com/baywet/4daabc875cab427ef1bc</a></p><p><img src=./76.png alt=76.png></p><h2 id=récupération-des-résultats-de-tests>Récupération des résultats de tests</h2><p>Maintenant il faut indiquer à VSTS de récupérer les résultats de tests et de les interpréter, pour cela ajouter une étape publish test results</p><p>Dans le type sélectionner xunit et indiquer l’emplacement de votre fichier de résultat.</p><p><img src=./77.png alt=77.png></p><h2 id=conclusion>Conclusion</h2><p>Les résultats de tests remontent avec notre build dans VSTS et on peut voir qu’avec un peu de configuration et de scripts il est facile d’automatiser les tests unitaires pour des projets DNX.</p><p>Bons tests !</p><p><img src=./78.png alt=78.png></p></div><br><p class=heading>Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/605e3673b260df245d78622a6b90ac6850f55219>7 Apr 2023</a> par <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/fr/tags/build><span class=tag>Build</span></a></div><div class=control><a href=/fr/tags/qualite><span class=tag>Qualite</span></a></div><div class=control><a href=/fr/tags/tests><span class=tag>Tests</span></a></div><div class=control><a href=/fr/tags/alm><span class=tag>Alm</span></a></div><div class=control><a href=/fr/tags/vsts><span class=tag>Vsts</span></a></div><div class=control><a href=/fr/tags/vso><span class=tag>Vso</span></a></div><div class=control><a href=/fr/tags/dnx><span class=tag>Dnx</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/mise-a-jour-maitrisee-de-schem/><span class="icon is-small"><i class="fa fa-chevron-left"></i></span>
<span class="is-hidden-touch is-hidden-desktop-only">Mise à jour maitrisée de schema SQL avec Entity Framework Code First dans un processus de livraison...</span>
<span class="is-hidden-touch is-hidden-widescreen">Mise à jour maitrisée de schema SQL avec Entity Framework Code First dans...</span>
<span class="is-hidden-mobile is-hidden-desktop">Mise à jour maitrisée de schema SQL avec Entity...</span>
<span class=is-hidden-tablet>Mise à jour maitrisée de schema SQL avec...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/build-dnx-avec-agent-build-vne/><span class="is-hidden-touch is-hidden-desktop-only">Build DNX avec agent build vnext installé (TFS , VSTS)</span>
<span class="is-hidden-touch is-hidden-widescreen">Build DNX avec agent build vnext installé (TFS , VSTS)</span>
<span class="is-hidden-mobile is-hidden-desktop">Build DNX avec agent build vnext installé (TFS ,...</span>
<span class=is-hidden-tablet>Build DNX avec agent build vnext...</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/tests-unitaires-xunit-avec-vis/",this.page.identifier=window.location.pathname};(function(){var e=document,t=e.createElement("script");t.src="https://baywet.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/fr/build-dnx-avec-agent-build-vne/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Build DNX avec agent build vnext installé (TFS , VSTS)&nbsp;<div class=tag>Build</div><div class=tag>Vsts</div><div class=tag>Vso</div><div class=tag>Dnx</div></span></a><a class=panel-block href=https://baywet.github.io/fr/erreur-lors-de-la-publication/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Erreur lors de la publication de sites web asp.net 5 (core) vers Azure&nbsp;<div class=tag>Dnx</div></span></a><a class=panel-block href=https://baywet.github.io/fr/incrementer-automatiquement-le/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Incrémenter automatiquement le numéro de version de fonctionnalité SharePoint avec le build 2015&nbsp;<div class=tag>Build</div><div class=tag>Alm</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-sharepoint-sat-2015-11-10-14-00-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Conférencier au SharePoint Saturday Ottawa 2015&nbsp;<div class=tag>Alm</div></span></a><a class=panel-block href=https://baywet.github.io/fr/deploiement-de-cloud-services/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Déploiement de Cloud services Azure via les builds 2015&nbsp;<div class=tag>Build</div><div class=tag>Alm</div></span></a><a class=panel-block href=https://baywet.github.io/fr/build-automatise-de-solutions/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Build automatisé de solutions SharePoint (full trust) 2013 – Où sont mes solutions?&nbsp;<div class=tag>Build</div><div class=tag>Alm</div></span></a><a class=panel-block href=https://baywet.github.io/fr/visual-studio-2013-update-4-et/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Visual Studio 2013 Update 4 et build automatisé de solutions SharePoint (full trust)&nbsp;<div class=tag>Build</div><div class=tag>Alm</div></span></a><a class=panel-block href=https://baywet.github.io/fr/build-automatise-de-solution-s/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Build automatisé de solution SharePoint server (fulltrust) avec visual studio online&nbsp;<div class=tag>Build</div><div class=tag>Alm</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conversion-dun-certificat-prot/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Conversion d’un certificat protégé par mot de passe (pfx) en certificat non protégé (snk)&nbsp;<div class=tag>Build</div><div class=tag>Alm</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/fr><span class=icon><i class="fa fa-home"></i></span></a> &nbsp;
<a class=button href><span class=icon><i class="fa fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>