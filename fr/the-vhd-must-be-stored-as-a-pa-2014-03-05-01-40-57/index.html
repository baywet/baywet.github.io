<!doctype html><html lang=fr dir=ltr itemscope itemtype=https://schema.org/Article>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<title>The VHD must be stored as a page blob. Uploader un vhd vers azure</title>
<meta name=author content="Vincent Biret">
<meta name=description content="
Mise en contexte
Récemment j’ai dû monter une ferme SharePoint sur Windows Azure. C’est très pratique en termes de délais de provisionnement et de simplicité d’utilisation. Pour monter ma ferme,...">
<meta name=generator content="Hugo 0.89.0">
<meta itemprop=name content="The VHD must be stored as a page blob. Uploader un vhd vers azure">
<meta itemprop=description content="
Mise en contexte
Récemment j’ai dû monter une ferme SharePoint sur Windows Azure. C’est très pratique en termes de délais de provisionnement et de simplicité d’utilisation. Pour monter ma ferme,...">
<meta itemprop=image content="/img/logo.svg">
<meta property="og:title" content="The VHD must be stored as a page blob. Uploader un vhd vers azure">
<meta property="og:type" content="article">
<meta property="og:url" content="https://baywet.github.io/fr/the-vhd-must-be-stored-as-a-pa-2014-03-05-01-40-57/">
<meta property="og:image" content="/img/logo.svg">
<meta property="og:description" content="
Mise en contexte
Récemment j’ai dû monter une ferme SharePoint sur Windows Azure. C’est très pratique en termes de délais de provisionnement et de simplicité d’utilisation. Pour monter ma ferme,...">
<meta property="og:site_name" content="Le blog de baywet">
<meta property="og:updated_time" content="2021-11-03T07:05:23-04:00">
<meta property="article:published_time" content="2014-03-05T01:40:57+00:00">
<meta property="article:modified_time" content="2021-11-03T07:05:23-04:00">
<meta property="article:section" content>
<meta property="article:tag" content="tools">
<meta property="article:tag" content="vm">
<meta property="article:tag" content="upload">
<meta property="article:tag" content="azure">
<meta property="article:tag" content="visual studio">
<meta name=twitter:card content="summary">
<meta name=twitter:site content>
<meta name=twitter:title content="The VHD must be stored as a page blob. Uploader un vhd vers azure">
<meta name=twitter:description content="
Mise en contexte
Récemment j’ai dû monter une ferme SharePoint sur Windows Azure. C’est très pratique en termes de délais de provisionnement et de simplicité d’utilisation. Pour monter ma ferme,...">
<meta name=twitter:creator content>
<meta name=twitter:image:src content="/img/logo.svg">
<link rel=stylesheet type=text/css href=/css/capsule.min.css>
<script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-176061333-1','auto'),ga('send','pageview')</script>
<link rel=apple-touch-icon href=/img/apple-touch-icon.png>
<link rel=icon href=/img/favicon.ico>
</head>
<body style=min-height:100vh;display:flex;flex-direction:column>
<nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation">
<div class=container>
<div class=navbar-brand>
<a class=navbar-item href=/fr>
<div class="title is-4">&nbsp;Le blog de baywet</div>
</a>
<label class="button navbar-burger is-white" for=navbar-burger-state>
<span></span>
<span></span>
<span></span>
</label>
</div>
<input type=checkbox id=navbar-burger-state>
<div class=navbar-menu>
<div class=navbar-end>
<a class=navbar-item href=/en>English</a>
</div>
</div>
</div>
</nav>
<section class=section style=flex:1>
<div class=container>
<h1 class=title>The VHD must be stored as a page blob. Uploader un vhd vers azure</h1>
<p class=subtitle>Mar 5, 2014</p>
<div class=content>
<p><img src=./clip_5F00_image002_5F00_thumb_5F00_234C3B1E.jpg alt=clip_5F00_image002_5F00_thumb_5F00_234C3B1E.jpg></p>
<h3 id=mise-en-contexte>Mise en contexte</h3>
<p>Récemment j’ai dû monter une ferme SharePoint sur Windows Azure. C’est très pratique en termes de délais de provisionnement et de simplicité d’utilisation. Pour monter ma ferme, j’avais besoin de fichiers ISO (de sources d’installation). En lisant la documentation j’apprends que la manière la plus recommandée d’effectuer cela est de tout mettre dans un vhd en local, de pousser ce vhd sur azure puis de l’attacher à la vm en question.</p>
<p>En tant que développeur discipliné je me dis « azure bénéficie d’une intégration forte avec visual studio, on a un storage explorer, utilisons le ». Pour ceux qui ne savent pas, c’est dans le server explorer à gauche.</p>
<p><img src=./clip_5F00_image004_5F00_thumb_5F00_2DA280E0.jpg alt=clip_5F00_image004_5F00_thumb_5F00_2DA280E0.jpg></p>
<p>Une fois le vhd uploadé (4Go, ça prend une heure quand même hein) je me connecte à l’interface azure et j’essaie de créer un disque (comprendre utilisable par les machines virtuelles) pour ensuite le lier aux machines.</p>
<p>Cependant après avoir lancé la tâche de création j’obtiens cette erreur « The VHD must be stored as a page blob. »</p>
<p>Après quelques recherches je comprends qu’il y a deux formats de fichiers majeurs dans le stockage azure :</p>
<ul>
<li>
<p>Page blob : principalement utilisé pour les vhd (CloudPageBlob) <a href="https://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.blob.cloudpageblob%28v=azure.10%29.aspx">https://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.blob.cloudpageblob(v=azure.10).aspx</a></p>
</li>
<li>
<p>Block Blob : pour tout autre fichier (CloudBlockBlob) <a href="https://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.blob.cloudblockblob%28v=azure.10%29.aspx">https://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.blob.cloudblockblob(v=azure.10).aspx</a></p>
</li>
</ul>
<p>On peut d’ailleurs voir la différence avec le mime-type (le fichier que je veux transformer en disque est le premier)</p>
<p><img src=./clip_5F00_image006_5F00_thumb_5F00_1534FE34.jpg alt=clip_5F00_image006_5F00_thumb_5F00_1534FE34.jpg></p>
<h3 id=résolution>Résolution</h3>
<p>La solution est venue en lisant ce blog post. L’auteur indique qu’il fallait un outil spécial pour uploader des vhd (qui est maintenant déprécié) et comment le faire via powershell maintenant.</p>
<p><a href=https://michaelwasham.com/windows-azure-powershell-reference-guide/uploading-and-downloading-vhds-to-windows-azure/>https://michaelwasham.com/windows-azure-powershell-reference-guide/uploading-and-downloading-vhds-to-windows-azure/</a></p>
<p>En gros il suffit que pendant l’upload on dise à azure « ça c’est un vhd que je t’envoie » pour qu’il mette le fichier au bon format et que vous puissiez l’utiliser par la suite. C’est simplement dommage qu’on ne puisse pas le spécifier directement via l’explorateur Visual Studio.</p>
<p>En espérant que ça vous fera gagner du temps.</p>
</div>
<br>
<p class=heading>
Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/3b1b9f8366a3bec704f564b0345e4523a08e93fc>
3 Nov 2021
</a> par <a href=https://github.com/baywet>Vincent Biret</a>
</p>
<br>
<div class=heading>Tags:</div>
<div class="field is-grouped is-grouped-multiline">
<div class=control>
<a href=/fr/tags/tools>
<span class=tag>Tools</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/vm>
<span class=tag>Vm</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/upload>
<span class=tag>Upload</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/azure>
<span class=tag>Azure</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/visual-studio>
<span class=tag>Visual Studio</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/vhd>
<span class=tag>Vhd</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/powershell>
<span class=tag>Powershell</span>
</a>
</div>
</div>
</div>
</section>
<section class=section>
<div class=container>
<div class=level>
<div class=level-left>
<div class=level-item>
<p class="control has-addons">
<a class=button href=https://baywet.github.io/fr/the-vhd-must-be-stored-as-a-pa-2014-03-05-01-45-11/>
<span class="icon is-small"><i class="fa fa-chevron-left"></i></span>
<span class="is-hidden-touch is-hidden-desktop-only">
The VHD must be stored as a page blob. Upload a vhd to azure
</span>
<span class="is-hidden-touch is-hidden-widescreen">
The VHD must be stored as a page blob. Upload a vhd to azure
</span>
<span class="is-hidden-mobile is-hidden-desktop">
The VHD must be stored as a page blob. Upload a...
</span>
<span class=is-hidden-tablet>
The VHD must be stored as a page blob....
</span>
</a>
</p>
</div>
</div>
<div class=level-right>
<div class=level-item>
<p class="control has-addons">
<a class=button href=https://baywet.github.io/fr/service-pack-1-for-office-suit/>
<span class="is-hidden-touch is-hidden-desktop-only">
Service Pack 1 for Office suite 2013 (client and server) is out!
</span>
<span class="is-hidden-touch is-hidden-widescreen">
Service Pack 1 for Office suite 2013 (client and server) is out!
</span>
<span class="is-hidden-mobile is-hidden-desktop">
Service Pack 1 for Office suite 2013 (client and...
</span>
<span class=is-hidden-tablet>
Service Pack 1 for Office suite 2013...
</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
</a>
</p>
</div>
</div>
</div>
</div>
<br>
<br>
<div class=container>
<div id=disqus_thread></div>
<script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/the-vhd-must-be-stored-as-a-pa-2014-03-05-01-40-57/",this.page.identifier=window.location.pathname};(function(){var a=document,b=a.createElement('script');b.src='https://baywet.disqus.com/embed.js',b.setAttribute('data-timestamp',+new Date),(a.head||a.body).appendChild(b)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
</div>
<br>
<div class=container>
<nav class=panel>
<p class=panel-heading>Related</p>
<a class=panel-block href=https://baywet.github.io/fr/trois-nouveaux-sur-la-platefor/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Trois nouveaux sur la plateforme Microsoft Touch !&nbsp;
<div class=tag>Powershell</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/sharepoint-autohosted-app-et-a/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>SharePoint autohosted app et ASP.NET MVC&nbsp;
<div class=tag>Visual Studio</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/entity-framework-et-reference/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Entity Framework et référence au dataContext pour une application web&nbsp;
<div class=tag>Visual Studio</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/visual-studio-2013-rc-comptag/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Visual Studio 2013 RC : Comptage des références à votre code&nbsp;
<div class=tag>Visual Studio</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/mise-a-jour-des-outils-cks/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Mise à jour des Outils CKS&nbsp;
<div class=tag>Visual Studio</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/configuration-de-la-topologie/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Configuration de la topologie de recherche d’entreprise dans SharePoint 2013&nbsp;
<div class=tag>Powershell</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/sharepoint-2013-et-les-workflo/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>SharePoint 2013 et les workflows - nouveautés&nbsp;
<div class=tag>Visual Studio</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/wcf-entity-framework-code-fir/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>WCF + Entity FrameWork Code First + Azure&nbsp;
<div class=tag>Azure</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/creer-des-librairies-pour-les/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Créer des librairies pour les projets SharePoint&nbsp;
<div class=tag>Visual Studio</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/deployer-son-ou-ses-blogs-blog/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Déployer son (ou ses) blog(s) BlogEngine sur Azure&nbsp;
<div class=tag>Azure</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/visual-studio-2010-amp-les-out/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Visual Studio 2010 & les outils autours des données (SQL)&nbsp;
<div class=tag>Visual Studio</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/uploader-automatiquement-les-p/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Uploader automatiquement les photos des utilisateurs SharePoint sur leur profil en PowerShell&nbsp;
<div class=tag>Upload</div>
<div class=tag>Powershell</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/ajouter-un-nouvel-administrate/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Ajouter un nouvel administrateur de ferme SharePoint pouvant éxécuter la console PowerShell sans encombres&nbsp;
<div class=tag>Powershell</div>
</span>
</a>
</nav>
</div>
</section>
<footer class=footer>
<div class=container>
<nav class=level>
</nav>
<nav class=level>
<div class="level-left has-text-centered">
<div class=level-item>
<form class="control has-icons has-icons-right" method=get action=https://bing.com>
<input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span>
</form>
</div>
</div>
<div class="level-right has-text-centered">
<div class=level-item>
<a class=button href=https://baywet.github.io/fr>
<span class=icon><i class="fa fa-home"></i></span>
</a> &nbsp;
<a class=button href>
<span class=icon><i class="fa fa-rss"></i></span>
</a>
</div>
</div>
</nav>
</div>
</footer>
<script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script>
</body>
</html>