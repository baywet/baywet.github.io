<!doctype html><html lang=fr dir=ltr itemscope itemtype=https://schema.org/Article>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<title>Ajouter une Web App SharePoint à un SSO AD FS existant</title>
<meta name=author content="Vincent Biret">
<meta name=description content="Introduction
Cet article vient compléter une série d’articles sur le SSO dans SharePoint avec AD FS (que je vous conseille de lire pour mieux comprendre celui-ci) suite à une demande de certains...">
<meta name=generator content="Hugo 0.88.1">
<meta itemprop=name content="Ajouter une Web App SharePoint à un SSO AD FS existant">
<meta itemprop=description content="Introduction
Cet article vient compléter une série d’articles sur le SSO dans SharePoint avec AD FS (que je vous conseille de lire pour mieux comprendre celui-ci) suite à une demande de certains...">
<meta itemprop=image content="/img/logo.svg">
<meta property="og:title" content="Ajouter une Web App SharePoint à un SSO AD FS existant">
<meta property="og:type" content="article">
<meta property="og:url" content="https://baywet.github.io/fr/ajouter-une-web-app-sharepoint/">
<meta property="og:image" content="/img/logo.svg">
<meta property="og:description" content="Introduction
Cet article vient compléter une série d’articles sur le SSO dans SharePoint avec AD FS (que je vous conseille de lire pour mieux comprendre celui-ci) suite à une demande de certains...">
<meta property="og:site_name" content="Le blog de baywet">
<meta property="og:updated_time" content="2021-09-06T09:54:53-07:00">
<meta property="article:published_time" content="2012-01-05T18:44:00+00:00">
<meta property="article:modified_time" content="2021-09-06T09:54:53-07:00">
<meta property="article:section" content>
<meta property="article:tag" content="webapp">
<meta property="article:tag" content="sso">
<meta property="article:tag" content="stepbystep">
<meta property="article:tag" content="adfs">
<meta property="article:tag" content="sharepoint">
<meta name=twitter:card content="summary">
<meta name=twitter:site content>
<meta name=twitter:title content="Ajouter une Web App SharePoint à un SSO AD FS existant">
<meta name=twitter:description content="Introduction
Cet article vient compléter une série d’articles sur le SSO dans SharePoint avec AD FS (que je vous conseille de lire pour mieux comprendre celui-ci) suite à une demande de certains...">
<meta name=twitter:creator content>
<meta name=twitter:image:src content="/img/logo.svg">
<link rel=stylesheet type=text/css href=/css/capsule.min.css>
<script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-176061333-1','auto'),ga('send','pageview')</script>
<link rel=apple-touch-icon href=/img/apple-touch-icon.png>
<link rel=icon href=/img/favicon.ico>
</head>
<body style=min-height:100vh;display:flex;flex-direction:column>
<nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation">
<div class=container>
<div class=navbar-brand>
<a class=navbar-item href=/fr>
<div class="title is-4">&nbsp;Le blog de baywet</div>
</a>
<label class="button navbar-burger is-white" for=navbar-burger-state>
<span></span>
<span></span>
<span></span>
</label>
</div>
<input type=checkbox id=navbar-burger-state>
<div class=navbar-menu>
<div class=navbar-end>
<a class=navbar-item href=/en>English</a>
</div>
</div>
</div>
</nav>
<section class=section style=flex:1>
<div class=container>
<h1 class=title>Ajouter une Web App SharePoint à un SSO AD FS existant</h1>
<p class=subtitle>Jan 5, 2012</p>
<div class=content>
<h2 id=introduction>Introduction</h2>
<p>Cet article vient compléter une série d’articles sur le SSO dans SharePoint avec AD FS (que je vous conseille de lire pour mieux comprendre celui-ci) suite à une demande de certains lecteurs.</p>
<p>La demande de leur part était la suivante, quelle est la marche à suivre pour ajouter une web app à notre SSO avec AD FS ? Dans la série évoquée j’avais indiqué que je rédigerai peut être cet article, chose promise chose due.</p>
<p>Petit récapitulatif : A ce stade vous avez normalement une installation AD FS fonctionnelle et une web app SharePoint qui utilise ce fournisseur d’authentification pour authentifier les utilisateurs. Vous avez compris les concepts d’identification, d’authentification, de fédération d’identité, de chaine de certificats, de secure token service et de SPTrustedIdentityTokenIssuer.</p>
<p>Vous avez aussi déjà créé la web app que vous voulez ajouter à votre SSO avec un binding en HTTPS et le certificat valide est installé sur IIS. (pour le moment elle a une zone d’authentification en claims NTLM)</p>
<p>La procédure que nous allons donc dérouler ici consiste principalement à ajouter un RP-STS (application qui consomme des identités) côté AD FS et ajouter des domaines d’authentification sur notre SPTrustedIdentityTokenIssuer, enfin nous terminerons par une rapide configuration de la web app.</p>
<h2 id=etape-1-ajout-du-rp-sts-dans-ad-fs>Etape 1 ajout du RP-STS dans AD FS</h2>
<p>Première partie, ouvrez la console AD FS et ajoutez une relation de confiance à un tiers de cette manière</p>
<p><img src=./RPT1.jpg alt=RPT1.jpg></p>
<p>Une fenêtre apparait, cliquez sur « Suivant » pour passer le message de bienvenue.</p>
<p><img src=./RPT2.jpg alt=RPT2.jpg></p>
<p>Sélectionnez « entrer les données manuellement » et cliquez sur « Suivant »</p>
<p><img src=./RPT3.jpg alt=RPT3.jpg></p>
<p>Entrez un nom pour cette nouvelle relation (et des notes au besoin) et cliquez sur « Suivant »</p>
<p><img src=./RPT4.jpg alt=RPT4.jpg></p>
<p>Sélectionnez la version 2 et cliquez sur « Suivant »</p>
<p><img src=./RPT5.jpg alt=RPT5.jpg></p>
<p>Si vous utilisez un certificat pour chiffrer les jetons au sein des communications (en plus des communications qui sont déjà chiffrées pour rappel) sélectionnez-le, cliquez sur « Suivant ».</p>
<p><img src=./RPT6.jpg alt=RPT6.jpg></p>
<p>Cochez la première case (WS-Passive) et entrez l’url complète de votre Web App SharePoint suivie de /_trust/, cliquez sur « Suivant »</p>
<p><img src=./RPT7.jpg alt=RPT7.jpg></p>
<p>Entrez le domaine de la relation (pour rappel il s’agit d’une clef de la forme foo:bar:foo connue du RP-STS et de l’IP-STS qui permet d’identifier les requêtes d’authentification et les jetons délivrés), cliquez sur « Ajouter » puis sur « Suivant ».</p>
<p><img src=./RPT8.jpg alt=RPT8.jpg></p>
<p>Cochez la politique d’autorisation d’accès par défaut à appliquer à votre RP-STS (pour ma part permit all) et cliquez sur « Suivant ».</p>
<p><img src=./RPT9.jpg alt=RPT9.jpg></p>
<p>Contrôlez le récapitulatif de votre configuration puis cliquez sur « Suivant » et « Fermer »</p>
<p>Une nouvelle ligne apparait alors dans la liste des relations et une nouvelle fenêtre s’ouvre.</p>
<p><img src=./RPT10.jpg alt=RPT10.jpg></p>
<p>Cliquez sur « Ajouter une règle ».</p>
<p><img src=./RPT11.jpg alt=RPT11.jpg></p>
<p>Paramétrez la règle de transmission des revendications au jeton telle que vous l’avez paramétrée pour les autres applications.</p>
<p><img src=./RPT12.jpg alt=RPT12.jpg></p>
<p><img src=./RPT13.jpg alt=RPT13.jpg></p>
<p>Cliquez sur « OK »</p>
<p>Maintenant que notre RP-STS supplémentaire est configuré côté AD FS, c’est-à-dire que l’on a indiqué à AD FS que l’on pouvait délivrer des jetons SAML d’authentification à une nouvelle application, nous allons indiquer à SharePoint qu’il peut utiliser notre service de SSO pour une Web Application supplémentaire.</p>
<h2 id=etape-2-configuration-du-sptrutedidentitytokenissuer>Etape 2 Configuration du SPTrutedIdentityTokenIssuer</h2>
<p>Nous allons dans un premier temps indiquer à notre SPTrutedIdentityTokenIssuer, qu’une autre de nos Web Applications va l’utiliser pour gérer l’authentification. Cet objet c’est l’objet côté SharePoint qui représente notre IP-STS ainsi que la configuration pour communiquer avec et permet à nos Web Applications (RP-STS du point de vue d’AD FS) de l’utiliser.</p>
<p>$sptiti = Get-SPTrustedIdentityTokenIssuer | where{$_.Name –eq “nomduIssuerr”}</p>
<p>$sptiti.ProviderRealms.Add(&ldquo;<a href=https://www.toto.net/%22,%22urn:claims:totonet%22>https://www.toto.net/","urn:claims:totonet"</a>)</p>
<p>$sptiti.Update()</p>
<p>Spécifiez le nom de votre SPTrutedIdentityTokenIssuer à la place de » nomduIssuerr » ainsi que l’url de votre web app et le domaine entré précédemment dans la configuration du RP-STS.</p>
<h2 id=etape-3-modification-du-provider-dauthentification-de-la-web-app>Etape 3 : modification du provider d’authentification de la web app</h2>
<p>Cette étape va consister à indiquer à la web app qu’elle peut se servir de notre configuration d’IP-STS côté SharePoint pour procéder à ses authentifications. Pour cela rendez-vous dans la centrale d’admin et cliquez sur « Gérer les applications Web », sélectionnez votre Web App et cliquez sur « Fournisseurs d’authentification » dans le ruban. Cliquez sur la zone d’authentification sur laquelle vous voulez mettre en place le SSO et descendez au niveau des types d’authentifications par revendication.</p>
<p>A ce niveau décochez l’authentification Windows et cochez votre fournisseur d’identité, cliquez sur « Sauvegarder »</p>
<h2 id=etape-4-autorisation-des-utilisateurs>Etape 4 : autorisation des utilisateurs</h2>
<p>Ajoutez ensuite « all authenticated users »ou les utilisateurs souhaités via le menu user policy dans la gestion des applications web ou via la gestion des groupes sur le site et vous pouvez maintenant utiliser votre SSO !</p>
<p>Note : le correctif cumulatif de Juin 2011 (et ultérieurs) corrige un problème d’affichage des claims providers dans le people picker</p>
<p><a href=https://social.technet.microsoft.com/Forums/sr-Latn-CS/sharepoint2010setup/thread/bda5d7c0-f775-457a-9980-e86f24f8b1f1>https://social.technet.microsoft.com/Forums/sr-Latn-CS/sharepoint2010setup/thread/bda5d7c0-f775-457a-9980-e86f24f8b1f1</a></p>
<p><img src=./WorkingADFSPP.jpg alt=WorkingADFSPP.jpg></p>
<p>Votre People Picker devrait ressembler à ça</p>
</div>
<br>
<p class=heading>
Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/f1c07980424f8c88fce2580454819da383433fb8>
6 Sep 2021
</a> par <a href=https://github.com/baywet>Vincent Biret</a>
</p>
<br>
<div class=heading>Tags:</div>
<div class="field is-grouped is-grouped-multiline">
<div class=control>
<a href=/fr/tags/webapp>
<span class=tag>Webapp</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/sso>
<span class=tag>Sso</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/stepbystep>
<span class=tag>Stepbystep</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/adfs>
<span class=tag>Adfs</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/sharepoint>
<span class=tag>Sharepoint</span>
</a>
</div>
</div>
</div>
</section>
<section class=section>
<div class=container>
<div class=level>
<div class=level-left>
<div class=level-item>
<p class="control has-addons">
<a class=button href=https://baywet.github.io/fr/visual-studio-2010-amp-les-out/>
<span class="icon is-small"><i class="fa fa-chevron-left"></i></span>
<span class="is-hidden-touch is-hidden-desktop-only">
Visual Studio 2010 & les outils autours des données (SQL)
</span>
<span class="is-hidden-touch is-hidden-widescreen">
Visual Studio 2010 & les outils autours des données (SQL)
</span>
<span class="is-hidden-mobile is-hidden-desktop">
Visual Studio 2010 & les outils autours des...
</span>
<span class=is-hidden-tablet>
Visual Studio 2010 & les outils autours...
</span>
</a>
</p>
</div>
</div>
<div class=level-right>
<div class=level-item>
<p class="control has-addons">
<a class=button href=https://baywet.github.io/fr/localisation-du-repertoire-de/>
<span class="is-hidden-touch is-hidden-desktop-only">
Localisation du répertoire de décompression du setup SharePoint
</span>
<span class="is-hidden-touch is-hidden-widescreen">
Localisation du répertoire de décompression du setup SharePoint
</span>
<span class="is-hidden-mobile is-hidden-desktop">
Localisation du répertoire de décompression du...
</span>
<span class=is-hidden-tablet>
Localisation du répertoire de...
</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
</a>
</p>
</div>
</div>
</div>
</div>
<br>
<br>
<div class=container>
<div id=disqus_thread></div>
<script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/ajouter-une-web-app-sharepoint/",this.page.identifier=window.location.pathname};(function(){var a=document,b=a.createElement('script');b.src='https://baywet.disqus.com/embed.js',b.setAttribute('data-timestamp',+new Date),(a.head||a.body).appendChild(b)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
</div>
<br>
<div class=container>
<nav class=panel>
<p class=panel-heading>Related</p>
<a class=panel-block href=https://baywet.github.io/fr/localisation-du-repertoire-de/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Localisation du répertoire de décompression du setup SharePoint&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/introduction-au-single-sign-on-2011-09-26-22-29-00/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Introduction au single sign on sur SharePoint 2010 - partie 7&nbsp;
<div class=tag>Sso</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/introduction-au-single-sign-on-2011-09-26-22-26-00/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Introduction au single sign on sur SharePoint 2010 - partie 6&nbsp;
<div class=tag>Sso</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/introduction-au-single-sign-on-2011-09-26-22-25-00/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Introduction au single sign on sur SharePoint 2010 - partie 5&nbsp;
<div class=tag>Sso</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/introduction-au-single-sign-on-2011-09-26-22-23-00/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Introduction au single sign on sur SharePoint 2010 - partie 4&nbsp;
<div class=tag>Sso</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/introduction-au-single-sign-on-2011-09-26-22-22-00/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Introduction au single sign on sur SharePoint 2010 - partie 3&nbsp;
<div class=tag>Sso</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/introduction-au-single-sign-on-2011-09-26-22-21-00/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Introduction au single sign on sur SharePoint 2010 - partie 2&nbsp;
<div class=tag>Sso</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/introduction-au-single-sign-on-2011-09-26-22-18-00/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Introduction au single sign on sur SharePoint 2010 - partie 1&nbsp;
<div class=tag>Sso</div>
<div class=tag>Adfs</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/reconduite-de-mon-titre-msp/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Reconduite de mon titre MSP&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/uploader-automatiquement-les-p/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Uploader automatiquement les photos des utilisateurs SharePoint sur leur profil en PowerShell&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/upgrade-des-bases-de-donnees-m/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Upgrade des bases de données mirrorées avec le SP1 de SharePoint&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/re-realease-de-la-mise-a-jour/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Re-Realease de la mise à jour cumulative de Juin (CU1 June)&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/industrialisation-des-installa-2011-07-06-16-42-00/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Industrialisation des installations de ferme SharePoint 2010(CU, SP, Langues, SlipStream) Part 3&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/industrialisation-des-installa-2011-07-06-16-11-00/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Industrialisation des installations de ferme SharePoint 2010(CU, SP, Langues, SlipStream) Part 2&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/industrialisation-des-installa-2011-07-06-15-47-00/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Industrialisation des installations de ferme SharePoint 2010(CU, SP, Langues, SlipStream) Part 1&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
</nav>
</div>
</section>
<footer class=footer>
<div class=container>
<nav class=level>
</nav>
<nav class=level>
<div class="level-left has-text-centered">
<div class=level-item>
<form class="control has-icons has-icons-right" method=get action=https://bing.com>
<input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span>
</form>
</div>
</div>
<div class="level-right has-text-centered">
<div class=level-item>
<a class=button href=https://baywet.github.io/fr>
<span class=icon><i class="fa fa-home"></i></span>
</a> &nbsp;
<a class=button href>
<span class=icon><i class="fa fa-rss"></i></span>
</a>
</div>
</div>
</nav>
</div>
</footer>
<script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script>
</body>
</html>