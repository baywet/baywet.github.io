<!doctype html><html lang=fr dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Localisation du JavaScript d’une solution Full Trust</title><meta name=author content="Vincent Biret"><meta name=description content="Introduction
Nous, développeurs SharePoint des anciens temps où régnaient les solutions « full trust » avons bien compris une chose : l’utilisation de JavaScript améliore de loin nos solutions.
En..."><meta name=generator content="Hugo 0.74.3"><meta itemprop=name content="Localisation du JavaScript d’une solution Full Trust"><meta itemprop=description content="Introduction
Nous, développeurs SharePoint des anciens temps où régnaient les solutions « full trust » avons bien compris une chose : l’utilisation de JavaScript améliore de loin nos solutions.
En..."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Localisation du JavaScript d’une solution Full Trust"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/fr/localisation-du-javascript-dun/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="Introduction
Nous, développeurs SharePoint des anciens temps où régnaient les solutions « full trust » avons bien compris une chose : l’utilisation de JavaScript améliore de loin nos solutions.
En..."><meta property="og:site_name" content="Le blog de baywet"><meta property="og:updated_time" content="2020-09-10T13:23:17-04:00"><meta property="article:published_time" content="2014-08-13T03:58:20+00:00"><meta property="article:modified_time" content="2020-09-10T13:23:17-04:00"><meta property="article:section" content><meta property="article:tag" content="ressources"><meta property="article:tag" content="bonnes pratiques"><meta property="article:tag" content="javascript"><meta property="article:tag" content="exemple"><meta property="article:tag" content="multinlingue"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Localisation du JavaScript d’une solution Full Trust"><meta name=twitter:description content="Introduction
Nous, développeurs SharePoint des anciens temps où régnaient les solutions « full trust » avons bien compris une chose : l’utilisation de JavaScript améliore de loin nos solutions.
En..."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-176061333-1','auto');ga('send','pageview');</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/fr><div class="title is-4">&nbsp;Le blog de baywet</div></a><label class="button navbar-burger is-white" for=navbar-burger-state><span></span><span></span><span></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=https://baywet.github.io/localizing-javascript-of-a-ful/>English</a></div></div></div></nav><section class=section style=flex:1><div class=container><p class=title>Localisation du JavaScript d’une solution Full Trust</p><p class=subtitle>Aug 13, 2014</p><div class=content><h4 id=introduction>Introduction</h4><p>Nous, développeurs SharePoint des anciens temps où régnaient les solutions « full trust » avons bien compris une chose : l’utilisation de JavaScript améliore de loin nos solutions.</p><p>En effet cela permet de diminuer la charge des serveurs et de rendre l’expérience utilisateur plus « responsive ».</p><p>Mais voilà, lorsque l’on veut afficher des messages dans des langues différentes en fonction de l’utilisateur, comment faire ? En .NET (comprenez côté serveur) c’est assez simple, il suffit d’utiliser des ressources. (<a href=../the-name-initializecontrol-doe>voir un de mes billets relatif au sujet</a>)</p><h4 id=solutions-pour-aspnet-standard>Solutions pour ASP.NET standard</h4><p>Le framework asp.net permet déjà une localisation des fichiers JavaScripts, cependant ces méthodologies n’est pas forcément très pratiques compte tenu du cycle de déploiement de SharePoint.</p><p><a href=https://msdn.microsoft.com/en-us/library/bb398935.aspx>https://msdn.microsoft.com/en-us/library/bb398935.aspx</a></p><p><a href=https://msdn.microsoft.com/en-us/magazine/cc135974.aspx>https://msdn.microsoft.com/en-us/magazine/cc135974.aspx</a></p><p>Une autre méthodologie plus adaptée à SharePoint consiste à faire des dupliquas des fichiers JavaScript et de les déployer dans des sous-dossiers par LCID (1033, 1036…). Cela oblige au pire à dupliquer du code, au mieux à avoir un autre emplacement où l’on gère les ressources. (en plus des resx). (c’est comme ça que SharePoint fonctionne en interne)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JS data-lang=JS><span style=color:#a6e22e>ScriptLink</span>.<span style=color:#a6e22e>RegisterScriptAfterUI</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>Page</span>, <span style=color:#e6db74>&#34;JSample/Scripts/myscript.min.js&#34;</span>, <span style=color:#66d9ef>true</span>, <span style=color:#66d9ef>true</span>);
</code></pre></div><p>C’est le second paramètre à true qui permet de faire ça lors de l’appel du script.</p><h4 id=solution-proposée-par-microsoft>Solution proposée par Microsoft</h4><p>En continuant de chercher je suis tombé sur ce billet de l’équipe produit SharePoint <a href=https://blogs.msdn.com/b/sharepointdev/archive/2012/04/05/how-to-localize-custom-script-resources-in-sharepoint-2010-abhishek-verma.aspx>https://blogs.msdn.com/b/sharepointdev/archive/2012/04/05/how-to-localize-custom-script-resources-in-sharepoint-2010-abhishek-verma.aspx</a></p><p>Ils expliquent que SharePoint contient un handler qui permet d’exposer les ressources situées dans la ruche sous forme de JSON (génial !).</p><p>Cependant je ne suis pas hyper fan de la manière dont ils appellent ces ressources car :</p><ul><li><p>La manière dont c’est présenté suggérerait de devoir faire du script inline (pas bien)</p></li><li><p>L’appel qu’ils font risque de planter si on est dans une collection de site sur une web app qui n’a pas de collection de site racine</p></li><li><p>Les ressources une fois chargée ne sont pas confinées à un espace de nom ce qui risque de conduire à des conflits avec d’autres composants</p></li><li><p>On ne contrôle pas la séquence de chargement avec l’appel qui est fait, autre risque de conflits</p></li><li><p>Le chargement se fait en même temps que le reste de la page et non de manière asynchrone ce qui dégrade l’expérience utilisateur</p></li></ul><h4 id=ma-solution>Ma solution</h4><p>Voici la solution que je propose, nous allons faire un chargement de script asynchrone via jquery et le JSOM SharePoint et charger les ressources dans un espace de nom dédié. Cela va nous permettre de nous affranchir de toutes les limitations citées plus haut. Le seul point négatif, il va falloir ajouter jquery si ce n’est pas déjà présent. Ce problème n’en est pas vraiment un puisque depuis plusieurs années déjà les développeurs SharePoint utilisent JQuery au sein de leurs projets.</p><p>Vous trouverez l’exemple de code à cette adresse <a href=https://github.com/baywet/jsfulltrustlocalize>https://github.com/baywet/jsfulltrustlocalize</a></p><h4 id=github>Github</h4><p>Puisqu’il faut bien une première fois, j’en profite pour vous annoncer que j’ai créé un compte sur github et que c’est là-bas que je posterai mes exemples de code à partir de maintenant. C’est une plateforme très intéressante.</p><p>Le gros point positif ? Si jamais il y a des points d’amélioration dans mes exemples, vous pouvez y participer (ou les autres développeurs présents dans le monde entier).</p></div><br><p class=heading>Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/06a349de09ea77651223dd3690c9ea4badfbf31f>10 Sep 2020</a> par <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/fr/tags/ressources><span class=tag>Ressources</span></a></div><div class=control><a href=/fr/tags/bonnes-pratiques><span class=tag>Bonnes Pratiques</span></a></div><div class=control><a href=/fr/tags/javascript><span class=tag>Javascript</span></a></div><div class=control><a href=/fr/tags/exemple><span class=tag>Exemple</span></a></div><div class=control><a href=/fr/tags/multinlingue><span class=tag>Multinlingue</span></a></div><div class=control><a href=/fr/tags/code><span class=tag>Code</span></a></div><div class=control><a href=/fr/tags/fulltrust><span class=tag>Fulltrust</span></a></div><div class=control><a href=/fr/tags/sharepoint><span class=tag>Sharepoint</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/conversion-dun-certificat-prot/><span class="icon is-small"><i class="fa fa-chevron-left"></i></span><span class="is-hidden-touch is-hidden-desktop-only">Conversion d’un certificat protégé par mot de passe (pfx) en certificat non protégé (snk)</span>
<span class="is-hidden-touch is-hidden-widescreen">Conversion d’un certificat protégé par mot de passe (pfx) en certificat non...</span>
<span class="is-hidden-mobile is-hidden-desktop">Conversion d’un certificat protégé par mot de...</span>
<span class=is-hidden-tablet>Conversion d’un certificat protégé par...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/pourquoi-ne-pas-inclure-de-con/><span class="is-hidden-touch is-hidden-desktop-only">Pourquoi ne pas inclure de contrôles télérik dans vos produits SharePoint ?</span>
<span class="is-hidden-touch is-hidden-widescreen">Pourquoi ne pas inclure de contrôles télérik dans vos produits SharePoint ?</span>
<span class="is-hidden-mobile is-hidden-desktop">Pourquoi ne pas inclure de contrôles télérik dans...</span>
<span class=is-hidden-tablet>Pourquoi ne pas inclure de contrôles...</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/localisation-du-javascript-dun/";this.page.identifier=window.location.pathname;};(function(){var d=document,s=d.createElement('script');s.src='https://baywet.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/fr/pourquoi-ne-pas-inclure-de-con/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Pourquoi ne pas inclure de contrôles télérik dans vos produits SharePoint ?&nbsp;<div class=tag>Bonnes Pratiques</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/changement-dans-le-cycle-de-li/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Changement dans le cycle de livraison des CU pour SharePoint&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/office-365-mise-a-disposition/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Office 365 mise à disposition de la roadmap&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/selectionne-pour-le-sharepoint/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Sélectionné pour le SharePoint Saturday New York City !&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/depreciation-des-apps-auto-heb/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Dépréciation des Apps Auto-hébergées&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/petit-msp-devient-grand-mvp/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Petit MSP devient grand MVP&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/remise-a-disposition-du-sp1-po/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Remise à disposition du SP1 pour SharePoint 2013&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/retrait-du-sp1-de-sp2013-sp1/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Retrait du SP1 de SP2013 / SP1 for SP2013 not available anymore&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/donnez-votre-avis-sur-le-rempl/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Donnez votre avis sur le remplaçant d’infopath !&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/les-annonces-marquantes-de-la/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Les annonces marquantes de la SharePoint Conference 2014 pour Office 365&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/webcast-pour-les-itpros-sur-of/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Webcast pour les ITPros sur Office 365&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/acces-anonyme-a-une-applicatio/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Accès anonyme à une application auto-hébergée pour SharePoint&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/evolution-de-la-compatibilite/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Evolution de la compatibilité système SharePoint 2010 et 2013&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/refonte-des-packs-de-langue-po/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Refonte des packs de langue pour SharePoint 2010&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/mise-a-jour-de-mars-des-outils/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Mise à jour de Mars des outils de développement Office pour Visual Studio&nbsp;<div class=tag>Sharepoint</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/fr><span class=icon><i class="fa fa-home"></i></span></a>&nbsp;
<a class=button href><span class=icon><i class="fa fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>