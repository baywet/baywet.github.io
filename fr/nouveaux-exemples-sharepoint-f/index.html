<!doctype html><html lang=fr dir=ltr itemscope itemtype=https://schema.org/Article><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Nouveaux exemples SharePoint Framework PnP disponibles : utiliser le SDK Web Skype UCWA pour afficher le statut d’une personne</title><meta name=author content="Vincent Biret"><meta name=description content="En Bref
J’ai ajouté deux nouveaux exemples de WebParts SharePoint Framework qui démontre l’utilisation du SDK JavaScript pour l’API « Unified Communication Web API » de Skype for Business. Ce SDK vous..."><meta name=generator content="Hugo 0.74.3"><meta itemprop=name content="Nouveaux exemples SharePoint Framework PnP disponibles : utiliser le SDK Web Skype UCWA pour afficher le statut d’une personne"><meta itemprop=description content="En Bref
J’ai ajouté deux nouveaux exemples de WebParts SharePoint Framework qui démontre l’utilisation du SDK JavaScript pour l’API « Unified Communication Web API » de Skype for Business. Ce SDK vous..."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Nouveaux exemples SharePoint Framework PnP disponibles : utiliser le SDK Web Skype UCWA pour afficher le statut d’une personne"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/fr/nouveaux-exemples-sharepoint-f/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="En Bref
J’ai ajouté deux nouveaux exemples de WebParts SharePoint Framework qui démontre l’utilisation du SDK JavaScript pour l’API « Unified Communication Web API » de Skype for Business. Ce SDK vous..."><meta property="og:site_name" content="Le blog de baywet"><meta property="og:updated_time" content="2020-09-13T16:50:50-04:00"><meta property="article:published_time" content="2018-01-08T09:00:00+00:00"><meta property="article:modified_time" content="2020-09-13T16:50:50-04:00"><meta property="article:section" content><meta property="article:tag" content="ucwa"><meta property="article:tag" content="sharepoint framework"><meta property="article:tag" content="webpart"><meta property="article:tag" content="spfx"><meta property="article:tag" content="react"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Nouveaux exemples SharePoint Framework PnP disponibles : utiliser le SDK Web Skype UCWA pour afficher le statut d’une personne"><meta name=twitter:description content="En Bref
J’ai ajouté deux nouveaux exemples de WebParts SharePoint Framework qui démontre l’utilisation du SDK JavaScript pour l’API « Unified Communication Web API » de Skype for Business. Ce SDK vous..."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-176061333-1','auto');ga('send','pageview');</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/fr><div class="title is-4">&nbsp;Le blog de baywet</div></a><label class="button navbar-burger is-white" for=navbar-burger-state><span></span><span></span><span></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=https://baywet.github.io/new-sharepoint-framework-pnp-s/>English</a></div></div></div></nav><section class=section style=flex:1><div class=container><h1 class=title>Nouveaux exemples SharePoint Framework PnP disponibles : utiliser le SDK Web Skype UCWA pour afficher le statut d’une personne</h1><p class=subtitle>Jan 8, 2018</p><div class=content><h2 id=en-bref>En Bref</h2><p>J’ai ajouté deux nouveaux exemples de WebParts SharePoint Framework qui démontre l’utilisation du SDK JavaScript pour l’API « Unified Communication Web API » de Skype for Business. Ce SDK vous permet vous abonner au statut d’une personne, démarrer une conversation skype, des appels…</p><p><img src=./17.gif alt=17.gif></p><p>Les exemples :</p><ul><li><a href=https://github.com/SharePoint/sp-dev-fx-webparts/tree/master/samples/js-skype-status>L’exemple en JavaScript simple</a></li><li><a href=https://github.com/SharePoint/sp-dev-fx-webparts/tree/master/samples/react-skype-status>L’exemple avec reactJs + Office UI Fabric React (persona)</a></li></ul><h2 id=version-longue>Version longue</h2><p>J’ai récemment eu l’occasion d’effectuer ma première contribution à PnP (au-delà de rapporter et aider à résoudre des problèmes). Dans ces deux nouveaux exemples je vous montre comment utiliser le SDK Skype UCWA pour vous abonner à et afficher le statut Skype d’un usager.</p><p>Ce statut Skype va se mettre à jour s’il change (ie : si l’utilisateur change son statut dans Skype ou se connecte/déconnecte).</p><p>Cette approche est meilleure que les approches précédentes que nous avions l’habitude d’utiliser dans SharePoint telles que <a href=https://social.technet.microsoft.com/Forums/en-US/be668c7e-19f8-41c4-a568-20f3e29e378c/how-to-display-lync-status-on-content-query-webpart-in-sharepoint-online>l’intégration Office avec ActiveX</a> ou le statut d’auteur de fichier dans SharePoint car :</p><ul><li>C’est multi-plateformes (pas besoin d’activeX, Internet Explorer ou de configuration de zones de sécurité)</li><li>C’est indépendant d’une installation d’Office sur la machine ou du fait d’avoir Skype for business démarré</li><li>Ça se met à jour si le statut change</li><li>Il n’y a pas besoin de créer de fichier et cela peut être utilisé n’importe où sur la page<ul><li><em>(l’indicateur de présence d’auteur de fichier SharePoint communique directement avec le serveur Skype en arrière-plan et fournit à SharePoint le HTML à afficher, mais cela se fait uniquement pour les librairies de documents)</em></li></ul></li></ul><h2 id=la-ucwa>La UCWA</h2><p>Cette API est un peu spéciale et différente des « API standards » (OAuth + REST). Les différences principales étant :</p><ul><li>Elle vous permet de vous abonner à certains objets du modèles (statut, conversations, flux audio/video…)</li><li>L’authentification est un peu (trop) complexe<ul><li>Non standard et s’attend à ce que vous receviez un 403 afin d’obtenir l’adresse du fournisseur d’identité</li><li>Le serveur de découverte agit comme un « relais » et l’API est segmentée en plusieurs ressources (au-delà des permissions) ce qui demande d’effectuer plusieurs cycles d’autorisation.</li></ul></li><li>N’est pas compatible OData (Microsoft nous a habitués à pouvoir utiliser OData sur ses APIs)</li></ul><p>Toutes ces différences impactent les quelques SDK’s disponibles et le SDK JavaScript (celui utilisé dans l’exemple) est un peu « vieux jeu ». Je pense que ce serait bénéfique s’ils passaient un peu de temps pour :</p><ul><li>Passer d’une variable globale à un UMD</li><li>Fournir les packages npm et non uniquement un bundle sur un CDN</li><li>Fournir des définitions de types</li><li>Fournir de meilleures informations de versions (+ semver)</li><li>Permettre aux développeurs d’utiliser leurs propres librairies « d’auth » (comme helloJS ou msal) au lieu de l’implémentation qu’ils ont fournie dans le bundle.</li></ul><p>Pour toutes ces raisons l’exemple charge le SDK par injection et n’inclue pas le script comme dépendance externe.</p><p>Pour terminer, la documentation est assez éparse, je vous suggère de corréler l’information, même si elle provient d’une source officielle car il semble qu’elle est loin d’être à jour. Voici quelques points d’entrée :</p><ul><li><a href="https://msdn.microsoft.com/en-us/skype/ucwa/unifiedcommunicationswebapi2_0?f=255&MSPPError=-2147217396">https://msdn.microsoft.com/en-us/skype/ucwa/unifiedcommunicationswebapi2_0?f=255&MSPPError=-2147217396</a></li><li><a href=https://ucwa.skype.com/>https://ucwa.skype.com/</a></li><li><a href=https://ucwa.skype.com/reference/WebSDK/modules/_s4b_sdk_d_.jcafe.html>https://ucwa.skype.com/reference/WebSDK/modules/_s4b_sdk_d_.jcafe.html</a></li></ul><h2 id=heading> </h2><h2 id=microsoft-teams-vs-skype>Microsoft Teams vs Skype</h2><p>Les API’s de Skype for business ne sont toujours pas disponibles via le Graph de Microsoft. Et Microsoft a <a href=https://www.theverge.com/2017/9/25/16360072/microsoft-teams-replacing-skype-for-business>déjà annoncé que Microsoft Teams sera la voie du futur</a> pour les communication unifiées, la messagerie instantanée et bien plus. Cependant Skype for business serveur restera toujours l’infrastructure qui supportera tout cela (et fournira au moins certaines des APIs) pour au moins quelques années.</p></div><br><p class=heading>Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/5cba38584db289d1659a8cfb224a453f3ed9ff48>13 Sep 2020</a> par <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/fr/tags/ucwa><span class=tag>Ucwa</span></a></div><div class=control><a href=/fr/tags/sharepoint-framework><span class=tag>Sharepoint Framework</span></a></div><div class=control><a href=/fr/tags/webpart><span class=tag>Webpart</span></a></div><div class=control><a href=/fr/tags/spfx><span class=tag>Spfx</span></a></div><div class=control><a href=/fr/tags/react><span class=tag>React</span></a></div><div class=control><a href=/fr/tags/developpement><span class=tag>Developpement</span></a></div><div class=control><a href=/fr/tags/skype><span class=tag>Skype</span></a></div><div class=control><a href=/fr/tags/sharepoint><span class=tag>Sharepoint</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/git-forkimportercopie-manuell/><span class="icon is-small"><i class="fa fa-chevron-left"></i></span><span class="is-hidden-touch is-hidden-desktop-only">Git : fork/importer/copie manuelle, bonnes pratiques</span>
<span class="is-hidden-touch is-hidden-widescreen">Git : fork/importer/copie manuelle, bonnes pratiques</span>
<span class="is-hidden-mobile is-hidden-desktop">Git : fork/importer/copie manuelle, bonnes...</span>
<span class=is-hidden-tablet>Git : fork/importer/copie manuelle,...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/la-version-complete-de-lodash/><span class="is-hidden-touch is-hidden-desktop-only">La version complète de lodash est disponible avec le SharePoint Framework</span>
<span class="is-hidden-touch is-hidden-widescreen">La version complète de lodash est disponible avec le SharePoint Framework</span>
<span class="is-hidden-mobile is-hidden-desktop">La version complète de lodash est disponible avec...</span>
<span class=is-hidden-tablet>La version complète de lodash est...</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/nouveaux-exemples-sharepoint-f/";this.page.identifier=window.location.pathname;};(function(){var d=document,s=d.createElement('script');s.src='https://baywet.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/fr/la-version-complete-de-lodash/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>La version complète de lodash est disponible avec le SharePoint Framework&nbsp;<div class=tag>Sharepoint Framework</div><div class=tag>Spfx</div><div class=tag>Developpement</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/utiliser-pnp-powershell-avec-v/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Utiliser PnP PowerShell avec Visual Studio Team Services (VSTS) et l'agent hébergé&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/renouvele-mvp-pour-lannee-2017/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Renouvelé MVP pour l’année 2017-2018&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-sharepoint-sat-2017-07-07-08-00-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Conférencier au SharePoint Saturday Paris 2017&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sharepoint-framework-dans-mes/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>SharePoint framework dans mes propres mots&nbsp;<div class=tag>Sharepoint Framework</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/mise-a-jour-des-definitions-de/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Mise à jour des définitions de types pour _spPageContextInfo - nouvelles propriétés disponibles&nbsp;<div class=tag>Sharepoint Framework</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/personnalisation-de-page-layou/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Personnalisation de page layouts, master pages et image renditions dans SharePoint Online&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-sharepoint-sat-2017-04-25-14-00-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Conférencier au SharePoint Saturday Monaco 2017&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/publier-des-image-renditions-p/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Publier des Image renditions pour SharePoint à l’aide de PnP Provisioning&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-aos-tours-mont/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Conférencier au Aos Tours Montréal et Québec&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/diagnotiquer-les-problemes-de/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Diagnotiquer les problèmes de load balancing sous SharePoint&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sharepoint-saturday-quebec/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>SharePoint Saturday Québec&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/systemupdate-enfin-disponible/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>SystemUpdate enfin disponible en CSOM&nbsp;<div class=tag>Developpement</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-sharepoint-sat-2016-09-12-14-00-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Conférencier au SharePoint Saturday Lyon 2016&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/determiner-si-la-librairie-sha/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Déterminer si la librairie SharePoint est utilisée avec la nouvelle expérience&nbsp;<div class=tag>Sharepoint</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/fr><span class=icon><i class="fa fa-home"></i></span></a>&nbsp;
<a class=button href><span class=icon><i class="fa fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>