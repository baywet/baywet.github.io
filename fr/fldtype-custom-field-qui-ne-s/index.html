<!doctype html><html lang=fr dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Fldtype / custom field qui ne s’affiche pas dans la liste des colonnes de la liste (paramètres) après ajout.</title><meta name=author content><meta name=description content="Bonjour à tous,
Aujourd’hui je suis tombé sur un « bug » (ou du moins comportement de SharePoint) assez étrange.
On m’avait demandé de coder un custom field type pour un client qui affichait la..."><meta name=generator content="Hugo 0.74.3"><meta itemprop=name content="Fldtype / custom field qui ne s’affiche pas dans la liste des colonnes de la liste (paramètres) après ajout."><meta itemprop=description content="Bonjour à tous,
Aujourd’hui je suis tombé sur un « bug » (ou du moins comportement de SharePoint) assez étrange.
On m’avait demandé de coder un custom field type pour un client qui affichait la..."><meta itemprop=image content><meta property="og:title" content="Fldtype / custom field qui ne s’affiche pas dans la liste des colonnes de la liste (paramètres) après ajout."><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/fr/fldtype-custom-field-qui-ne-s/"><meta property="og:image" content><meta property="og:description" content="Bonjour à tous,
Aujourd’hui je suis tombé sur un « bug » (ou du moins comportement de SharePoint) assez étrange.
On m’avait demandé de coder un custom field type pour un client qui affichait la..."><meta property="og:site_name" content="Le blog de baywet"><meta property="article:published_time" content="2012-10-06T02:41:34+00:00"><meta property="article:section" content><meta property="article:tag" content="readonly"><meta property="article:tag" content="workaround"><meta property="article:tag" content="field"><meta property="article:tag" content="bug"><meta property="article:tag" content="type"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Fldtype / custom field qui ne s’affiche pas dans la liste des colonnes de la liste (paramètres) après ajout."><meta name=twitter:description content="Bonjour à tous,
Aujourd’hui je suis tombé sur un « bug » (ou du moins comportement de SharePoint) assez étrange.
On m’avait demandé de coder un custom field type pour un client qui affichait la..."><meta name=twitter:creator content><meta name=twitter:image:src content><link rel=stylesheet type=text/css href=/css/capsule.min.css></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/fr><div class="title is-4">&nbsp;Le blog de baywet</div></a><label class="button navbar-burger is-white" for=navbar-burger-state><span></span><span></span><span></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=/en>English</a></div></div></div></nav><section class=section style=flex:1><div class=container><p class=title>Fldtype / custom field qui ne s’affiche pas dans la liste des colonnes de la liste (paramètres) après ajout.</p><p class=subtitle>Oct 6, 2012</p><div class=content><p>Bonjour à tous,</p><p>Aujourd’hui je suis tombé sur un « bug » (ou du moins comportement de SharePoint) assez étrange.</p><p>On m’avait demandé de coder un custom field type pour un client qui affichait la sécurité courante de l’item. Jusque-là tout fonctionnait bien, rien de très difficile, si ce n’est que quand le client ajoutait le champ à une liste (via create column par exemple), il n’apparaissait pas dans la liste des colonnes de la liste.</p><p>Assez embêtant pour renommer la colonne vous me direz ou encore pour la supprimer. Je suis assez d’accord.</p><p>J’ai commencé, comme tout bon développeur, par chercher des cas similaires sur internet, de la doc, et il n’y avait pas grand-chose sur le sujet donc après avoir trouvé la solution j’ai décidé de la partager.</p><p>Donc après n’avoir rien trouvé sur Internet, je me suis décidé à regarder comment SharePoint fonctionnait. N’hésitez pas à le faire quand vous manquez de documentation, si Microsoft avait voulu cacher le code ils auraient pu le faire, le tout est de ne pas publier/réutiliser leur code.</p><p>Je me commence donc par aller chercher la page qui me pose problème pour ensuite retomber sur les assemblies qui m’intéresseront et là, surprise, tout est en code inline ! On est très loin des recommandations de Microsoft sur le code behind, qui facilite le débug, qui est plus performant etc etc. Allez y faire un tour c’est instructif {14hive}\TEMPLATE\layouts\listedit.aspx</p><p>Sans surprise on se rend compte que le code d’affichage se base de nombreux tests sur le type et des propriétés des champs. Et que notre nouveau type de champ ne faisant pas partie de l’énumération SPFieldType, il passe un peu à la trappe.</p><p>J’ai pu identifier trois cas canoniques qui nous intéressent :</p><ul><li><p>Soit votre type de champ fait aussi de la saisie (enregistre des données), il s’affiche normalement dans cette liste de colonnes</p></li><li><p>Soit votre type de champ est en readonly (définit via sa class dérivant de SPField), et la propriété XPath est null, il ne s’affiche pas</p></li><li><p>Soit votre type de champ est en readonly et la propriété XPath est définie (même à string.empty), il s’affiche dans la liste de colonnes, mais pas de lien (ce qui est cohérent puisqu’il est en readonly)</p></li></ul><p>Maintenant comment faire si comme moi vous voulez un type de champ dans lequel les utilisateurs ne puissent pas rentrer de données, mais qu’ils puissent le supprimer/renommer (et donc l’avoir dans la liste des colonnes de la liste) ?</p><p>C’est simple (et incongru) mais il ne faut pas le mettre en readonly, il faut se servir des propriétés showin… (celles de la classe dérivant de SPField) et les mettre à false (enfin sauf ShowInListSettings hein).</p><p>Autre astuce, pendant vos tests, ces propriétés ne sont prises en compte que lorsque vous ajoutez/ supprimez le champ à vos colonnes dans une liste (donc une mise à jour de l’assembly + du fldtype + iireset /noforce ne suffisent pas), merci à Pascal Bonheur mon technical lead qui m’a fait remarquer ça alors que je n’étais pas très réveillé (et que je venais de faire une heure d’investigations à blanc)</p><p>Voilà j’espère que cette information fera gagner du temps à nombre d’entre vous sur cette problématique.</p><p>PS: si quelqu’un sait à quoi sert la propriété XPath qui n’est pas documentée je suis preneur.</p><p>PPS : à ce qui se demandent pourquoi j’ai besoin d’un type de champ juste pour faire de l’affichage, j’affiche la sécurité courante de l’élément, qui ne fait malheureusement partie des données dont on dispose dans un xslt de rendu. Du coup si je ne veux rien stocker/pré-calculer je suis obligé de passer par ça.</p></div><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/fr/tags/readonly><span class=tag>Readonly</span></a></div><div class=control><a href=/fr/tags/workaround><span class=tag>Workaround</span></a></div><div class=control><a href=/fr/tags/field><span class=tag>Field</span></a></div><div class=control><a href=/fr/tags/bug><span class=tag>Bug</span></a></div><div class=control><a href=/fr/tags/type><span class=tag>Type</span></a></div><div class=control><a href=/fr/tags/custom><span class=tag>Custom</span></a></div><div class=control><a href=/fr/tags/sharepoint><span class=tag>Sharepoint</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/sharepoint-2013-rtm-disponible/><span class="icon is-small"><i class="fa fa-chevron-left"></i></span><span class="is-hidden-touch is-hidden-desktop-only">SharePoint 2013 RTM disponible pour les abonnés MSDN!</span>
<span class="is-hidden-touch is-hidden-widescreen">SharePoint 2013 RTM disponible pour les abonnés MSDN!</span>
<span class="is-hidden-mobile is-hidden-desktop">SharePoint 2013 RTM disponible pour les abonnés...</span>
<span class=is-hidden-tablet>SharePoint 2013 RTM disponible pour les...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/fin-de-la-gamme-forefront/><span class="is-hidden-touch is-hidden-desktop-only">Fin de la gamme ForeFront</span>
<span class="is-hidden-touch is-hidden-widescreen">Fin de la gamme ForeFront</span>
<span class="is-hidden-mobile is-hidden-desktop">Fin de la gamme ForeFront</span>
<span class=is-hidden-tablet>Fin de la gamme ForeFront</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/fldtype-custom-field-qui-ne-s/";this.page.identifier=window.location.pathname;};(function(){var d=document,s=d.createElement('script');s.src='https://baywet.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/fr/traduire-sharepoint-2013/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Traduire SharePoint 2013&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sharepoint-2013-beta-failed-t/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>SharePoint 2013 beta – failed to open sms.resx&nbsp;<div class=tag>Bug</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/warmmeup-warmup-sharepoint-20/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>WarmMeUp – WarmUp SharePoint 2013 (et 2010)&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sharepoint-2013-app-et-wsp/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>SharePoint 2013 App et WSP&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sharepoint-2013-et-les-workflo/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>SharePoint 2013 et les workflows - nouveautés&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sortie-de-la-preview-publique/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Sortie de la Preview publique de SharePoint 2013&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/les-outils-de-developpement-po/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Les outils de développement pour SharePoint dans Visual Studio 2012&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/creer-des-librairies-pour-les/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Créer des librairies pour les projets SharePoint&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sharepoint-auto-upgrade-soluti/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>SharePoint Auto Upgrade Solution&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/video-de-ma-session-aux-techda/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Video de ma session aux techdays&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/session-aux-microsoft-techdays/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Session aux Microsoft Techdays 2012&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/ajouter-une-web-app-sharepoint/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Ajouter une Web App SharePoint à un SSO AD FS existant&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/localisation-du-repertoire-de/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Localisation du répertoire de décompression du setup SharePoint&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/introduction-au-single-sign-on-2011-09-26-22-29-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Introduction au single sign on sur SharePoint 2010 - partie 7&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/introduction-au-single-sign-on-2011-09-26-22-26-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Introduction au single sign on sur SharePoint 2010 - partie 6&nbsp;<div class=tag>Sharepoint</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://duckduckgo.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/><span class=icon><i class="fa fa-home"></i></span></a>&nbsp;
<a class=button href><span class=icon><i class="fa fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>