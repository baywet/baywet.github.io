<!doctype html><html lang=fr dir=ltr itemscope itemtype=https://schema.org/Article><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Convertir proprement des documents Word en HTML</title><meta name=author content="Vincent Biret"><meta name=description content="Nous allons revenir aujourd’hui sur un article plus technique pour faire un peu de développement Office. (ok c’est pas encore du développement SharePoint mais c’est pas mal non plus ;-))
Récemment..."><meta name=generator content="Hugo 0.74.3"><meta itemprop=name content="Convertir proprement des documents Word en HTML"><meta itemprop=description content="Nous allons revenir aujourd’hui sur un article plus technique pour faire un peu de développement Office. (ok c’est pas encore du développement SharePoint mais c’est pas mal non plus ;-))
Récemment..."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Convertir proprement des documents Word en HTML"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/fr/convertir-proprement-des-docum/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="Nous allons revenir aujourd’hui sur un article plus technique pour faire un peu de développement Office. (ok c’est pas encore du développement SharePoint mais c’est pas mal non plus ;-))
Récemment..."><meta property="og:site_name" content="Le blog de baywet"><meta property="og:updated_time" content="2020-09-13T11:23:07-04:00"><meta property="article:published_time" content="2010-10-27T05:27:00+00:00"><meta property="article:modified_time" content="2020-09-13T11:23:07-04:00"><meta property="article:section" content><meta property="article:tag" content="conversion"><meta property="article:tag" content="html"><meta property="article:tag" content="asp"><meta property="article:tag" content="word"><meta property="article:tag" content="microsoft"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Convertir proprement des documents Word en HTML"><meta name=twitter:description content="Nous allons revenir aujourd’hui sur un article plus technique pour faire un peu de développement Office. (ok c’est pas encore du développement SharePoint mais c’est pas mal non plus ;-))
Récemment..."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-176061333-1','auto');ga('send','pageview');</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/fr><div class="title is-4">&nbsp;Le blog de baywet</div></a><label class="button navbar-burger is-white" for=navbar-burger-state><span></span><span></span><span></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=/en>English</a></div></div></div></nav><section class=section style=flex:1><div class=container><h1 class=title>Convertir proprement des documents Word en HTML</h1><p class=subtitle>Oct 27, 2010</p><div class=content><p><img src=./word_2D00_2010_2D00_icon.png alt=word_2D00_2010_2D00_icon.png></p><p>Nous allons revenir aujourd’hui sur un article plus technique pour faire un peu de développement Office. (ok c’est pas encore du développement SharePoint mais c’est pas mal non plus ;-))</p><p>Récemment pour le <a href=https://www.labo-microsoft.com/>laboratoire Microsoft</a> j’ai dû développer un petit applicatif (client lourd) pour permettre la publication des articles des membres. (en effet, ce « détail » technique nous bloquait dans la publication de plus de 500 articles…)</p><p>Il faut savoir qu’actuellement les articles sont rédigés sous Word par les élèves de <a href=https://www.supinfo.com/>SUPINFO</a> membres du laboratoire Microsoft et que le site ne prend qu’un format très particulier fait à partir d’ASP (si si la techno qui est pratiquement aussi vieille que moi)</p><p>Il fallait donc depuis un document Word obtenir de l’html et avoir les éventuelles images correctement converties. Le plus aurait été de pouvoir valider automatiquement les révisions en attente et supprimer les commentaires (et d’autres détails…)</p><p>Voilà le décor est posé, passons au code maintenant.</p><p>Il faut savoir que depuis Microsoft Office Word 2003 il existe un assembly <a href=https://msdn.microsoft.com/fr-fr/library/kw65a0we%28VS.90%29.aspx>Microsoft.Office.Interop.Word</a>  très pratique pour faire du développement Word qui nous permet d’accéder à la majorité des fonctionnalités de Word. Le bémol étant tout de même qu’il faut que Word soit installé sur le poste cible.</p><p>Commençons donc par référencer cette assembly magique dans le projet et par importer les symboles dans notre portion de code :</p><p>using Microsoft.Office.Interop.Word;</p><p>Voici le code à proprement dit:</p><p>String PathdeMonDoc = &ldquo;&mldr;";</p><p>String PathRenduHTML = &ldquo;&mldr;";</p><p>//On commence par instancier une nouvelle application word qui traitera notre document</p><p>//Dans le cadre d&rsquo;un module supplémentaire de word il nous aurait suffit de récupérer l&rsquo;instance courante</p><p>Microsoft.Office.Interop.Word.Application mywordapp = new Microsoft.Office.Interop.Word.Application();</p><p>//On demande à l&rsquo;application d&rsquo;ouvrir notre document</p><p>Document myword = mywordapp.Documents.Open(PathdeMonDoc);</p><p>//On convertit le document vers la dernière version de document Word, cette méthode lève une exception si</p><p>//le document Word est déjà à la dernière version, on pourrait vérifier au préalable mais je vous laisse chercher ;-)</p><p>try</p><p>{</p><p>myword.Convert();</p><p>}</p><p>catch { }</p><p>//On accepte toutes les révisions en attente</p><p>myword.AcceptAllRevisions();</p><p>//S&rsquo;il y a des commentaires on les supprime</p><p>if (myword.Comments.Count != 0)</p><p>{</p><p>myword.DeleteAllComments();</p><p>}</p><p>//On sauvegarde au format HTML, notez que vous pouvez changer le format grâce à l&rsquo;énumération WdSaveFormat</p><p>myword.SaveAs2(PathRenduHTML, WdSaveFormat.wdFormatFilteredHTML);</p><p>myword.Close(); //On ferme le document word</p><p>mywordapp.Quit(WdSaveOptions.wdSaveChanges); //On ferme l&rsquo;application, en sauvegardant les modifications en attente des fois que&mldr;</p><p>//Notez que cela ne ferme que l&rsquo;instance que l&rsquo;on utilise, si l&rsquo;utilisateur était en train de travailler sur un autre document il ne sera pas perturbé</p><p>Voilà j’espère que ces quelques explications vous auront permis de vous lancer dans le traitement automatisé de documents Word. Dans mon cas j’ai ensuite traité le HTML rendu par Word à grand coup de regex pour le faire passer dans un format valide pour le site du labo.</p><p>Rendez-vous sur le site du labo sur lequel il y aura bientôt beaucoup de publications, sinon à bientôt sur mon blog et merci pour votre lecture :-)</p></div><br><p class=heading>Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/abf73ee782c5ef0d1f99c85f75cc687815ad93de>13 Sep 2020</a> par <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/fr/tags/conversion><span class=tag>Conversion</span></a></div><div class=control><a href=/fr/tags/html><span class=tag>Html</span></a></div><div class=control><a href=/fr/tags/asp><span class=tag>Asp</span></a></div><div class=control><a href=/fr/tags/word><span class=tag>Word</span></a></div><div class=control><a href=/fr/tags/microsoft><span class=tag>Microsoft</span></a></div><div class=control><a href=/fr/tags/labo><span class=tag>Labo</span></a></div><div class=control><a href=/fr/tags/office><span class=tag>Office</span></a></div><div class=control><a href=/fr/tags/developpement><span class=tag>Developpement</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/requtage-active-directory-depu/><span class="icon is-small"><i class="fa fa-chevron-left"></i></span><span class="is-hidden-touch is-hidden-desktop-only">Requêtage Active Directory depuis SharePoint.</span>
<span class="is-hidden-touch is-hidden-widescreen">Requêtage Active Directory depuis SharePoint.</span>
<span class="is-hidden-mobile is-hidden-desktop">Requêtage Active Directory depuis SharePoint.</span>
<span class=is-hidden-tablet>Requêtage Active Directory depuis...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/kinect-au-msp-day/><span class="is-hidden-touch is-hidden-desktop-only">Kinect au MSP Day</span>
<span class="is-hidden-touch is-hidden-widescreen">Kinect au MSP Day</span>
<span class="is-hidden-mobile is-hidden-desktop">Kinect au MSP Day</span>
<span class=is-hidden-tablet>Kinect au MSP Day</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/convertir-proprement-des-docum/";this.page.identifier=window.location.pathname;};(function(){var d=document,s=d.createElement('script');s.src='https://baywet.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/fr/kinect-au-msp-day/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Kinect au MSP Day&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/nomination-microsoft-student-p/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Nomination Microsoft Student Partner&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/microsoft-day-a-aix-en-provenc/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Microsoft Day à Aix en Provence le 30/09/10&nbsp;<div class=tag>Microsoft</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/fr><span class=icon><i class="fa fa-home"></i></span></a>&nbsp;
<a class=button href><span class=icon><i class="fa fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>