<!doctype html><html lang=fr dir=ltr itemscope itemtype=https://schema.org/Article><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Boostez vos solutions SharePoint avec le cache distribué !–Partie 2–Explications et astuces</title><meta name=author content="Vincent Biret"><meta name=description content="Explications, trucs, astuces et avertissements
Explications
Ce cluster de cache est en fait composé d’hôtes appfabric (caching services) Un des gros avantage est que les hôtes qui ne font pas partie..."><meta name=generator content="Hugo 0.104.1"><meta itemprop=name content="Boostez vos solutions SharePoint avec le cache distribué !–Partie 2–Explications et astuces"><meta itemprop=description content="Explications, trucs, astuces et avertissements
Explications
Ce cluster de cache est en fait composé d’hôtes appfabric (caching services) Un des gros avantage est que les hôtes qui ne font pas partie..."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Boostez vos solutions SharePoint avec le cache distribué !–Partie 2–Explications et astuces"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/fr/boostez-vos-solutions-sharepoi-2013-12-12-09-08-00/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="Explications, trucs, astuces et avertissements
Explications
Ce cluster de cache est en fait composé d’hôtes appfabric (caching services) Un des gros avantage est que les hôtes qui ne font pas partie..."><meta property="og:site_name" content="Le blog de baywet"><meta property="og:updated_time" content="2020-08-23T15:59:57-04:00"><meta property="article:published_time" content="2013-12-12T09:08:00+00:00"><meta property="article:modified_time" content="2020-08-23T15:59:57-04:00"><meta property="article:section" content><meta property="article:tag" content="performance"><meta property="article:tag" content="cache"><meta property="article:tag" content="2013"><meta property="article:tag" content="dev"><meta property="article:tag" content="distribué"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Boostez vos solutions SharePoint avec le cache distribué !–Partie 2–Explications et astuces"><meta name=twitter:description content="Explications, trucs, astuces et avertissements
Explications
Ce cluster de cache est en fait composé d’hôtes appfabric (caching services) Un des gros avantage est que les hôtes qui ne font pas partie..."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-176061333-1","auto"),ga("send","pageview")</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/fr><div class="title is-4">&nbsp;Le blog de baywet</div></a><label class="button navbar-burger is-white" for=navbar-burger-state><span></span>
<span></span>
<span></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=/en>English</a></div></div></div></nav><section class=section style=flex:1><div class=container><h1 class=title>Boostez vos solutions SharePoint avec le cache distribué !–Partie 2–Explications et astuces</h1><p class=subtitle>Dec 12, 2013</p><div class=content><h3 id=explications-trucs-astuces-et-avertissements>Explications, trucs, astuces et avertissements</h3><h4 id=explications>Explications</h4><p>Ce cluster de cache est en fait composé d’hôtes appfabric (caching services) Un des gros avantage est que les hôtes qui ne font pas partie du cluster mais interagissent avec gardent une copie locale des objets. Et cette copie est automatiquement maintenue à jour. En clair pas besoin d’implémenter un pattern lazy loading pour éviter les allers-retours sur le réseau.</p><p>Comment est-ce que ça fonctionne ? C’est assez simple. Le cluster de cache est divisé en partitions (définies par SharePoint, voir l’énumération SPDistributedCacheContainerType <a href=https://msdn.microsoft.com/en-us/library/office/microsoft.sharepoint.distributedcaching.utilities.spdistributedcachecontainertype.aspx>https://msdn.microsoft.com/en-us/library/office/microsoft.sharepoint.distributedcaching.utilities.spdistributedcachecontainertype.aspx</a> ) Vous ne pouvez donc pas créer de partition pour votre application. Essayez de mettre en cache vos données dans une partition qui correspond à ce que vous réalisez.</p><p>Les données mises en cache peuvent également appartenir à une région. Vous pouvez créer des régions si vous en avez besoin, elles vous permettront de manipuler vos objets plus facilement.</p><p>Le cache distribué gère aussi les problématiques de locking/unlocking. Des méthodes sont fournies pour gérer les statuts de verrouillage. De la même manière vous avez aussi accès à un ensemble d’informations sur les objets en cache telles que la version, la dernière mise à jour, le statut de verrouillage, la date d’expiration de la donnée… Ceci peut s’avérer utile dans le cadre d’une utilisation avancée.</p><h4 id=trucs-et-astuces>Trucs et astuces</h4><p>Avantage important, ce cluster de cache n’est pas accessible que depuis le contexte IIS. Vous pouvez donc lire et/ou écrire dans le cache depuis un timerjob, un service etc. Vraiment pratique pour les scénarios de pré chargement des données.</p><p>Autre information à considérer, la nature des données mises en cache. Il faut mettre en cache les données qui sont beaucoup utilisées (et pas forcément toute les données) et/ou qui prennent beaucoup de temps à générer. Evitez de mettre de gros objet en cache, le chargement d’objets lourds sur le réseau peut ajouter beaucoup de latence, de plus vous risquez de remplir le cache rapidement. Il faut stocker des objets les plus petits possibles, si vous avez des collections d’objets importantes par exemple, essayez de restructurer les données pour les éclater, quitte à avoir à maintenir un index (ou plusieurs).</p><p>Je vous conseille personnellement de toujours attribuer une région à vos données en cache. C’est toujours utile quand on veut vider le cache pour tout recharger.</p><p>Il arrive souvent que le service de cache se mette en défaut à cause des redéploiements fréquents. Ouvrez la console sharepoint et entrez ces deux cmdlets : use-cachecluster puis restart-cachecluster. Attendez de n’avoir plus de partitions fragmentées (get-cacheclusterhealth) et vous pouvez recommencer à débugger !</p><p>Dernière astuce, je ne stocke jamais mes données typées dans le cache. Je sérialise mes données avant (en passant par un dictionnaire par exemple pour toutes les propriétés). Pourquoi ? AppFabric est parfaitement capable de stocker vos données typées. Cependant j’ai cru remarquer que quand on fait ça, il a tendance à essayer de charger votre assembly dans son contexte applicatif. C’est assez gênant sur une machine de développeur où on redéploie sans arrêt et où ce genre de comportement peut bloquer la dll et faire échouer les déploiements…</p><h4 id=avertissements-et-inconvénients>Avertissements et inconvénients</h4><p>Attention, SharePoint utilise une version particulière (ancienne) d’appfabric, interdit de modifier quoi que ce soit dans la configuration des hôtes sans passer par les cmdlets SharePoint. N’essayez pas non plus de mettre à jour la version d’AppFabric, ce n’est pas supporté.</p><p>Point négatif de cette version d’app fabric, elle ne vous permet pas d’utiliser des méta-données. Prenons par exemple une donnée « carte de crédit » qui soit liée dans mon modèle relationnel à une donnée « banque » mais aussi à une donnée « utilisateur ». Pour faciliter la manipulation des cartes de crédit, je pourrais vouloir tagger chaque carte de crédit avec bank-&lt;bankID> et user-&lt;userID>. Ça me permettrait de remonter facilement les cartes par utilisateur et/ou par banque. Malheuresement ce n’est pas possible dans cette version d’appfabric et je suis dans ce cas de figure obligé de maintenir des index de données en cache, avec les risques que cela comporte.</p><p>Il faut bien comprendre que vous n’êtes pas le seul à pouvoir manipuler vos données en cache. Elles ont un délai d’expiration et peuvent donc « disparaitre » si le cycle de vie des données est mal géré dans votre solution. De la même manière, si le cluster vient à manquer d’espace disponible (moins de 10% de ram restant sur un des hôtes du cluster), il va se mettre à faire le ménage. Enfin, ne stockez pas de données sensibles en cache et prenne en compte le fait que pour diverses raisons, le cluster peut être indisponible mais votre solution sollicitée.</p><p>Autre inconvénient architectural, votre application repose sur un composant logiciel de plus : le cluster de cache. Si ce dernier ne fonctionne pas ou mal (parce que nos amis les admins ne font pas toujours bien leur travail :P ), votre solution ne fonctionnera plus ou plus correctement. C’est quelque chose qu’il faut prendre que compte, que ce soit dans le code ou même jusque dans la partie PRA/PCA de votre applicatif. En fonction de sa criticité vous pourrez donc laisser votre solution en défaut de fonctionnement, retourner à un mode dégradé avec un chargement des données direct depuis la source ou bien même choisir de ne pas implémenter ce cache. Tout dépend de vos contraintes. Notez que si le cluster ne fonctionne plus, de nombreuses fonctionnalités de SharePoint ne fonctionneront plus non plus ou plus lentement (social, sécurité, temps de chargement des pages…)</p></div><br><p class=heading>Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/5c1924c2f89aafa2b0c1558a1cf4c6fe2fd49a15>23 Aug 2020</a> par <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/fr/tags/performance><span class=tag>Performance</span></a></div><div class=control><a href=/fr/tags/cache><span class=tag>Cache</span></a></div><div class=control><a href=/fr/tags/2013><span class=tag>2013th</span></a></div><div class=control><a href=/fr/tags/dev><span class=tag>Dev</span></a></div><div class=control><a href=/fr/tags/distribu%c3%a9><span class=tag>Distribué</span></a></div><div class=control><a href=/fr/tags/sharepoint><span class=tag>Sharepoint</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/boostez-vos-solutions-sharepoi-2013-12-14-20-21-00/><span class="icon is-small"><i class="fa fa-chevron-left"></i></span>
<span class="is-hidden-touch is-hidden-desktop-only">Boostez vos solutions SharePoint avec le cache distribué !–Partie 3–Le code</span>
<span class="is-hidden-touch is-hidden-widescreen">Boostez vos solutions SharePoint avec le cache distribué !–Partie 3–Le code</span>
<span class="is-hidden-mobile is-hidden-desktop">Boostez vos solutions SharePoint avec le cache...</span>
<span class=is-hidden-tablet>Boostez vos solutions SharePoint avec le...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/boostez-vos-solutions-sharepoi-2013-12-11-01-15-14/><span class="is-hidden-touch is-hidden-desktop-only">Boostez vos solutions SharePoint avec le cache distribué !–Partie 1 Introduction</span>
<span class="is-hidden-touch is-hidden-widescreen">Boostez vos solutions SharePoint avec le cache distribué !–Partie 1...</span>
<span class="is-hidden-mobile is-hidden-desktop">Boostez vos solutions SharePoint avec le cache...</span>
<span class=is-hidden-tablet>Boostez vos solutions SharePoint avec le...</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/boostez-vos-solutions-sharepoi-2013-12-12-09-08-00/",this.page.identifier=window.location.pathname};(function(){var e=document,t=e.createElement("script");t.src="https://baywet.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/fr/boostez-vos-solutions-sharepoi-2013-12-11-01-15-14/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Boostez vos solutions SharePoint avec le cache distribué !–Partie 1 Introduction&nbsp;<div class=tag>Performance</div><div class=tag>Cache</div><div class=tag>2013th</div><div class=tag>Dev</div><div class=tag>Distribué</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sharepoint-autohosted-app-et-a/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>SharePoint autohosted app et ASP.NET MVC&nbsp;<div class=tag>2013th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/entity-framework-et-reference/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Entity Framework et référence au dataContext pour une application web&nbsp;<div class=tag>Dev</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sharepoint-2013-vectorized-log/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>SharePoint 2013 vectorized logo / logo SharePoint 2013 vectorialisé&nbsp;<div class=tag>2013th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/mise-a-jour-cumulative-doctobr/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Mise à jour cumulative d’Octobre 2013 pour SharePoint 2010&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/visual-studio-2013-rc-comptag/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Visual Studio 2013 RC : Comptage des références à votre code&nbsp;<div class=tag>2013th</div></span></a><a class=panel-block href=https://baywet.github.io/fr/mise-a-jour-des-outils-cks/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Mise à jour des Outils CKS&nbsp;<div class=tag>2013th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/le-developer-dashboard-reste-v/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Le developer dashboard reste vide sur SharePoint 2013&nbsp;<div class=tag>2013th</div><div class=tag>Dev</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sortie-du-service-pack-2-pour/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Sortie du Service Pack 2 pour SharePoint 2010&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sortie-de-la-mise-a-jour-cumul/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Sortie de la mise à jour cumulative de Juin 2013 pour SharePoint&nbsp;<div class=tag>2013th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/selectionne-pour-les-10-plus-g/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Sélectionné pour les 10 plus grands influenceurs SharePoint Francophones!&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/ecrire-du-code-securise-pour-s/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Ecrire du code sécurisé pour SharePoint&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/retour-sur-le-sharepoint-summi/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Retour sur le SharePoint Summit de Québec 2013&nbsp;<div class=tag>2013th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/la-mise-a-jour-davril-2013-pou/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>La mise à jour d’avril 2013 pour SharePoint est disponible&nbsp;<div class=tag>2013th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/the-name-initializecontrol-doe/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>The name 'InitializeControl' does not exist in the current context Controles utilisateur, SharePoint 2013 et Ressources&nbsp;<div class=tag>2013th</div><div class=tag>Sharepoint</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/fr><span class=icon><i class="fa fa-home"></i></span></a> &nbsp;
<a class=button href><span class=icon><i class="fa fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>