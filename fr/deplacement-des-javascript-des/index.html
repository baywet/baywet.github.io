<!doctype html><html lang=fr dir=ltr itemscope itemtype=https://schema.org/Article><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Déplacement des Javascript des Apps (add-ins) SharePoint</title><meta name=author content="Vincent Biret"><meta name=description content="Chez Negotium nous avons récemment rencontré un problème assez étrange.
Imaginez que vous avez bâti une app pour SharePoint précédement (Provider-Hosted)
Imaginez maintenant que vous avez mis à jour..."><meta name=generator content="Hugo 0.82.0"><meta itemprop=name content="Déplacement des Javascript des Apps (add-ins) SharePoint"><meta itemprop=description content="Chez Negotium nous avons récemment rencontré un problème assez étrange.
Imaginez que vous avez bâti une app pour SharePoint précédement (Provider-Hosted)
Imaginez maintenant que vous avez mis à jour..."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Déplacement des Javascript des Apps (add-ins) SharePoint"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/fr/deplacement-des-javascript-des/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="Chez Negotium nous avons récemment rencontré un problème assez étrange.
Imaginez que vous avez bâti une app pour SharePoint précédement (Provider-Hosted)
Imaginez maintenant que vous avez mis à jour..."><meta property="og:site_name" content="Le blog de baywet"><meta property="og:updated_time" content="2021-04-05T08:45:46-04:00"><meta property="article:published_time" content="2015-06-09T03:56:25+00:00"><meta property="article:modified_time" content="2021-04-05T08:45:46-04:00"><meta property="article:section" content><meta property="article:tag" content="add-ins"><meta property="article:tag" content="dev"><meta property="article:tag" content="javascript"><meta property="article:tag" content="office365"><meta property="article:tag" content="online"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Déplacement des Javascript des Apps (add-ins) SharePoint"><meta name=twitter:description content="Chez Negotium nous avons récemment rencontré un problème assez étrange.
Imaginez que vous avez bâti une app pour SharePoint précédement (Provider-Hosted)
Imaginez maintenant que vous avez mis à jour..."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-176061333-1','auto'),ga('send','pageview')</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/fr><div class="title is-4">&nbsp;Le blog de baywet</div></a><label class="button navbar-burger is-white" for=navbar-burger-state><span></span><span></span><span></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=/en>English</a></div></div></div></nav><section class=section style=flex:1><div class=container><h1 class=title>Déplacement des Javascript des Apps (add-ins) SharePoint</h1><p class=subtitle>Jun 9, 2015</p><div class=content><p>Chez Negotium nous avons récemment rencontré un problème assez étrange.</p><p>Imaginez que vous avez bâti une app pour SharePoint précédement (Provider-Hosted)</p><p>Imaginez maintenant que vous avez mis à jour vers la dernière version du SDK (mise à jour de Avril/Mai)</p><p>Maintenant imaginez que votre tenant a été mis à jour récemment (v16.0.4121.1212 ou supérieure).</p><p>Comme c’était préconisé lorsque Microsoft a livré le modèle d’applications, il y a de fortes chances que vous chargiez les SP.*.js et MicrosoftAjax.js (dont dépendaient SP.*.js) depuis &lt;HostWebUrl>/_layouts/15/fichierjs.js ou bien &lt;AppWebUrl>/_layouts/15/fichiersjs.js</p><p>Cependant cela fait plusieurs années que MicrosoftAjax.js est déprécié (il a été remplacé par les nouveautés d’EcmaScript 5 et par jqueryval)</p><p><a href=https://stackoverflow.com/questions/8782697/are-microsoftajax-js-microsoftmvcajax-js-and-microsoftmvcvalidation-js-obsolete>https://stackoverflow.com/questions/8782697/are-microsoftajax-js-microsoftmvcajax-js-and-microsoftmvcvalidation-js-obsolete</a></p><p>Du coup cette dernière mise à jour de tenant supprime le fichier en question.</p><p>Autre chose, la mise à jour du sdk (16.1.3912.1204) apporte la majorité des fichiers javascript SP*.js comme on peut le voir dans le dossier javascript du nuget Microsoft.SharePointOnline.CSOM.</p><p><img src=./96.png alt=96.png></p><p>Il semblerait donc que Microsoft ait changé de stratégie et préconise maintenant d’inclure les fichiers JS au sein de son application.</p><p>Personnellement j’ai créé un dossier SharePoint dans mon dossier Scripts et ajouté le bundle suivant</p><p>bundles.Add(new ScriptBundle("~/bundles/sharepoint").Include(</p><p>&ldquo;~/Scripts/sharepoint/*.js&rdquo;));</p><p>Oui mais voilà vous remarquerez qu’il manque le fichier SP.UI.Dialog.js (qui permet de faire des barres de notification) et ce fichier dépend toujours de MicrosoftAjax.js (à cause de Type.RegisterNamespace…)</p><p>Je pense qu’on verra une nouvelle version arriver très probablement dans une mise à jour du SDK, mais en attendant j’ai dû ajouter MicrosoftAjax.js et SP.UI.Dialog.js à mon dossier en les copiant depuis un vieux tenant. (ou une installation on prem, au choix)</p><p>En espérant que ça vous permettra d’anticiper par rapport au problème et de ne pas vous retrouver devant quand vos clients auront reçu la mise à jour de leur tenant.</p></div><br><p class=heading>Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/29171f60d616ec7fbc4e35a702d11d38128d4d16>5 Apr 2021</a> par <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/fr/tags/add-ins><span class=tag>Add Ins</span></a></div><div class=control><a href=/fr/tags/dev><span class=tag>Dev</span></a></div><div class=control><a href=/fr/tags/javascript><span class=tag>Javascript</span></a></div><div class=control><a href=/fr/tags/office365><span class=tag>Office365</span></a></div><div class=control><a href=/fr/tags/online><span class=tag>Online</span></a></div><div class=control><a href=/fr/tags/apps><span class=tag>Apps</span></a></div><div class=control><a href=/fr/tags/sharepoint><span class=tag>Sharepoint</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/resolution-de-dependance-commu/><span class="icon is-small"><i class="fa fa-chevron-left"></i></span>
<span class="is-hidden-touch is-hidden-desktop-only">Résolution de dépendance communes en développement de solutions full trust SharePoint</span>
<span class="is-hidden-touch is-hidden-widescreen">Résolution de dépendance communes en développement de solutions full trust...</span>
<span class="is-hidden-mobile is-hidden-desktop">Résolution de dépendance communes en développement...</span>
<span class=is-hidden-tablet>Résolution de dépendance communes en...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/azure-bug-avec-la-definition/><span class="is-hidden-touch is-hidden-desktop-only">Azure – Bug avec la définition de paramètres depuis Azure WebSites</span>
<span class="is-hidden-touch is-hidden-widescreen">Azure – Bug avec la définition de paramètres depuis Azure WebSites</span>
<span class="is-hidden-mobile is-hidden-desktop">Azure – Bug avec la définition de paramètres...</span>
<span class=is-hidden-tablet>Azure – Bug avec la définition de...</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/deplacement-des-javascript-des/",this.page.identifier=window.location.pathname};(function(){var a=document,b=a.createElement('script');b.src='https://baywet.disqus.com/embed.js',b.setAttribute('data-timestamp',+new Date),(a.head||a.body).appendChild(b)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-msdevmtl-deve/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Conférencier au MSDEVMTL – Développement office 365&nbsp;<div class=tag>Dev</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-sharepoint-sat-2015-05-25-01-12-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Conférencier au SharePoint Saturday New York City 2015&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-sharepoint-sat-2015-05-21-00-49-38/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Conférencier au SharePoint Saturday Montréal 2015&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-spbizconf/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Conférencier au SPBizConf&nbsp;<div class=tag>Office365</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/ce-que-jai-retenu-de-lignite-s/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Ce que j’ai retenu de l’ignite (SharePoint)&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/nombre-delements-fournis-pour/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Nombre d’éléments fournis pour la génération des facettes&nbsp;<div class=tag>Javascript</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sharepoint-saturday-montreal-2/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>SharePoint Saturday Montréal 2015&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/ignite-annonce-des-conferenci/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Ignite – Annonce des conférenciers et liste complète des sessions&nbsp;<div class=tag>Office365</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/participez-a-la-conception-de/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Participez à la conception de SharePoint 2016!&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/evenements-annonce-des-sessi/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Evènements - Annonce des sessions de l’Ignite&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/build-automatise-de-solutions/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Build automatisé de solutions SharePoint (full trust) 2013 – Où sont mes solutions?&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/visual-studio-2013-update-4-et/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Visual Studio 2013 Update 4 et build automatisé de solutions SharePoint (full trust)&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/mise-a-jour-de-novembre-des-ou/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Mise à jour de Novembre des outils développeurs Office&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/build-automatise-de-solution-s/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Build automatisé de solution SharePoint server (fulltrust) avec visual studio online&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conversion-dun-certificat-prot/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Conversion d’un certificat protégé par mot de passe (pfx) en certificat non protégé (snk)&nbsp;<div class=tag>Sharepoint</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/fr><span class=icon><i class="fa fa-home"></i></span></a> &nbsp;
<a class=button href><span class=icon><i class="fa fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>