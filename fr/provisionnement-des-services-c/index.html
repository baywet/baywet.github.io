<!doctype html><html lang=fr dir=ltr itemscope itemtype=https://schema.org/Article><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Provisionnement des services customs dans SharePoint</title><meta name=author content="Vincent Biret"><meta name=description content="Cet article s’adresse aux développeurs SharePoint full trust qui ont (vont) développé un service (SPService) pour SharePoint.
En effet dans le cadre où vous bâtissez un produit pour SharePoint comme..."><meta name=generator content="Hugo 0.104.1"><meta itemprop=name content="Provisionnement des services customs dans SharePoint"><meta itemprop=description content="Cet article s’adresse aux développeurs SharePoint full trust qui ont (vont) développé un service (SPService) pour SharePoint.
En effet dans le cadre où vous bâtissez un produit pour SharePoint comme..."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Provisionnement des services customs dans SharePoint"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/fr/provisionnement-des-services-c/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="Cet article s’adresse aux développeurs SharePoint full trust qui ont (vont) développé un service (SPService) pour SharePoint.
En effet dans le cadre où vous bâtissez un produit pour SharePoint comme..."><meta property="og:site_name" content="Le blog de baywet"><meta property="og:updated_time" content="2022-09-28T09:44:36-04:00"><meta property="article:published_time" content="2015-07-27T03:20:29+00:00"><meta property="article:modified_time" content="2022-09-28T09:44:36-04:00"><meta property="article:section" content><meta property="article:tag" content="service"><meta property="article:tag" content="provisionnement"><meta property="article:tag" content="solutions"><meta property="article:tag" content="full trust"><meta property="article:tag" content="développement"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Provisionnement des services customs dans SharePoint"><meta name=twitter:description content="Cet article s’adresse aux développeurs SharePoint full trust qui ont (vont) développé un service (SPService) pour SharePoint.
En effet dans le cadre où vous bâtissez un produit pour SharePoint comme..."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-176061333-1","auto"),ga("send","pageview")</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/fr><div class="title is-4">&nbsp;Le blog de baywet</div></a><label class="button navbar-burger is-white" for=navbar-burger-state><span></span>
<span></span>
<span></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=https://baywet.github.io/provisioning-custom-services-f/>English</a></div></div></div></nav><section class=section style=flex:1><div class=container><h1 class=title>Provisionnement des services customs dans SharePoint</h1><p class=subtitle>Jul 27, 2015</p><div class=content><p>Cet article s’adresse aux développeurs SharePoint full trust qui ont (vont) développé un service (SPService) pour SharePoint.</p><p>En effet dans le cadre où vous bâtissez un produit pour SharePoint comme on le fait chez Negotium (<a href=https://www.oceanik.com/>www.oceanik.com</a> <a href=https://www.theattributesolution.com/>www.theattributesolution.com</a> ) vous avez probablement intégré une application de service dans votre solution.</p><p>Si c’est le cas votre application de service a probablement un service SharePoint dédié pour exécuter son code (que ce soit un service porté par IIS ou un service windows).</p><p>Dans ce cas de figure il arrive à un moment (activation de la fonctionnalité, installation…) où vous voudrez provisionner le service (au moins sur une des machines)</p><p>Si vous appelez MonSPServiceInstance.Provision() sur le serveur courant, aucun problème. Par contre dès que vous commencez à vouloir le provisionner l’instance de service sur un serveur distant, vous prenez une exception.</p><p>Ceci est causé par le fait que l’instance de service ne veut pas se lancer sur un serveur distant. Voir plutôt le code décompilé de SharePoint.</p><p><img src=./94.png alt=94.png></p><p>Si on prend le temps d’y penser quelques minutes c’est quelque part censé, pour démarrer un service il faut être administrateur de la machine locale dans un contexte d’exécution privilégié. Et ce n’est pas le cas lorsque le code est exécuté à distance.</p><p>Du coup au lieu d’appeler la méthode de provisionnement directement il est préférable de lancer un timerjob pour effectuer ce provisionnement à votre place. Et pas besoin de le développer, il existe déjà.</p><p>Simplement instancier un SPServiceInstanceJobDefinition en passant en paramètre votre instance de service et un booléen pour le provisionner ou le dé-provisionner.</p><p>Ensuite il suffit de donner une Schedule (one time) et de mettre à jour le timerjob (.Update()).</p><p>Voilà qui devrait vous éviter pas mal de recherche sur le sujet puisque ce n’est actuellement pas très bien documenté sur MSDN.</p><p>Merci à Jordan de mon équipe qui a passé la majeure partie du temps sur le sujet et qui m’a permis de publier cet article.</p></div><br><p class=heading>Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/8eaed6004e7d1a84e12b04604a8b9d28015c03ac>28 Sep 2022</a> par <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/fr/tags/service><span class=tag>Service</span></a></div><div class=control><a href=/fr/tags/provisionnement><span class=tag>Provisionnement</span></a></div><div class=control><a href=/fr/tags/solutions><span class=tag>Solutions</span></a></div><div class=control><a href=/fr/tags/full-trust><span class=tag>Full Trust</span></a></div><div class=control><a href=/fr/tags/d%c3%a9veloppement><span class=tag>Développement</span></a></div><div class=control><a href=/fr/tags/custom><span class=tag>Custom</span></a></div><div class=control><a href=/fr/tags/sharepoint><span class=tag>Sharepoint</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/deploiement-de-cloud-services/><span class="icon is-small"><i class="fa fa-chevron-left"></i></span>
<span class="is-hidden-touch is-hidden-desktop-only">Déploiement de Cloud services Azure via les builds 2015</span>
<span class="is-hidden-touch is-hidden-widescreen">Déploiement de Cloud services Azure via les builds 2015</span>
<span class="is-hidden-mobile is-hidden-desktop">Déploiement de Cloud services Azure via les builds...</span>
<span class=is-hidden-tablet>Déploiement de Cloud services Azure via...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/resolution-de-dependance-commu/><span class="is-hidden-touch is-hidden-desktop-only">Résolution de dépendance communes en développement de solutions full trust SharePoint</span>
<span class="is-hidden-touch is-hidden-widescreen">Résolution de dépendance communes en développement de solutions full trust...</span>
<span class="is-hidden-mobile is-hidden-desktop">Résolution de dépendance communes en développement...</span>
<span class=is-hidden-tablet>Résolution de dépendance communes en...</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/provisionnement-des-services-c/",this.page.identifier=window.location.pathname};(function(){var e=document,t=e.createElement("script");t.src="https://baywet.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/fr/resolution-de-dependance-commu/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Résolution de dépendance communes en développement de solutions full trust SharePoint&nbsp;<div class=tag>Solutions</div><div class=tag>Full Trust</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/deplacement-des-javascript-des/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Déplacement des Javascript des Apps (add-ins) SharePoint&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-sharepoint-sat-2015-05-25-01-12-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Conférencier au SharePoint Saturday New York City 2015&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-sharepoint-sat-2015-05-21-00-49-38/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Conférencier au SharePoint Saturday Montréal 2015&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-spbizconf/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Conférencier au SPBizConf&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/ce-que-jai-retenu-de-lignite-s/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Ce que j’ai retenu de l’ignite (SharePoint)&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/nombre-delements-fournis-pour/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Nombre d’éléments fournis pour la génération des facettes&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sharepoint-saturday-montreal-2/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>SharePoint Saturday Montréal 2015&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/ignite-annonce-des-conferenci/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Ignite – Annonce des conférenciers et liste complète des sessions&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/participez-a-la-conception-de/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Participez à la conception de SharePoint 2016!&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/evenements-annonce-des-sessi/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Evènements - Annonce des sessions de l’Ignite&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/build-automatise-de-solutions/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Build automatisé de solutions SharePoint (full trust) 2013 – Où sont mes solutions?&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/visual-studio-2013-update-4-et/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Visual Studio 2013 Update 4 et build automatisé de solutions SharePoint (full trust)&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/mise-a-jour-de-novembre-des-ou/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Mise à jour de Novembre des outils développeurs Office&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/build-automatise-de-solution-s/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Build automatisé de solution SharePoint server (fulltrust) avec visual studio online&nbsp;<div class=tag>Sharepoint</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/fr><span class=icon><i class="fa fa-home"></i></span></a> &nbsp;
<a class=button href><span class=icon><i class="fa fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>