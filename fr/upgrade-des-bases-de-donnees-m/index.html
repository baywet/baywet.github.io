<!doctype html><html lang=fr dir=ltr itemscope itemtype=https://schema.org/Article><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Upgrade des bases de données mirrorées avec le SP1 de SharePoint</title><meta name=author content="Vincent Biret"><meta name=description content="Vous n’êtes pas sans savoir que le SP1 de SharePoint 2010 est sorti il y a déjà deux semaines et vous êtes peut être en train de planifier un déploiement de ce dernier.
Cet article est un retour..."><meta name=generator content="Hugo 0.74.3"><meta itemprop=name content="Upgrade des bases de données mirrorées avec le SP1 de SharePoint"><meta itemprop=description content="Vous n’êtes pas sans savoir que le SP1 de SharePoint 2010 est sorti il y a déjà deux semaines et vous êtes peut être en train de planifier un déploiement de ce dernier.
Cet article est un retour..."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Upgrade des bases de données mirrorées avec le SP1 de SharePoint"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/fr/upgrade-des-bases-de-donnees-m/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="Vous n’êtes pas sans savoir que le SP1 de SharePoint 2010 est sorti il y a déjà deux semaines et vous êtes peut être en train de planifier un déploiement de ce dernier.
Cet article est un retour..."><meta property="og:site_name" content="Le blog de baywet"><meta property="og:updated_time" content="2020-09-13T11:06:20-04:00"><meta property="article:published_time" content="2011-07-20T19:25:00+00:00"><meta property="article:modified_time" content="2020-09-13T11:06:20-04:00"><meta property="article:section" content><meta property="article:tag" content="mirroring"><meta property="article:tag" content="install"><meta property="article:tag" content="upgrade"><meta property="article:tag" content="mise à jour"><meta property="article:tag" content="sp1"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Upgrade des bases de données mirrorées avec le SP1 de SharePoint"><meta name=twitter:description content="Vous n’êtes pas sans savoir que le SP1 de SharePoint 2010 est sorti il y a déjà deux semaines et vous êtes peut être en train de planifier un déploiement de ce dernier.
Cet article est un retour..."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-176061333-1','auto');ga('send','pageview');</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/fr><div class="title is-4">&nbsp;Le blog de baywet</div></a><label class="button navbar-burger is-white" for=navbar-burger-state><span></span><span></span><span></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=/en>English</a></div></div></div></nav><section class=section style=flex:1><div class=container><h1 class=title>Upgrade des bases de données mirrorées avec le SP1 de SharePoint</h1><p class=subtitle>Jul 20, 2011</p><div class=content><p>Vous n’êtes pas sans savoir que le SP1 de SharePoint 2010 est sorti il y a déjà deux semaines et vous êtes peut être en train de planifier un déploiement de ce dernier.</p><p>Cet article est un retour d’expérience de déploiement du SP1 sur un certain type de topologies : les installations en mode ferme avec des bases de données mises en mirroir (voir mes précédents sujets à ce propos)</p><p>Dans ce cas de figure, voici les deux problèmes que vous pourrez rencontrer :</p><ul><li><p>Après l’installation des binaires, lorsque vous lancez le wizard de configuration des produits SharePoint (psconfig ou psconfigUI) pour mettre à jour le contenu et les webapp déployées, ce dernier échoue à la 9eme étape/10 à 15/30%</p></li><li><p>Une fois que le wizard s’est bien passé, lorsque vous vous rendez sur la section base de données de la ferme vous voyez certaines bases avec un message d’alerte du type « schéma de base de données trop ancien ou trop récent, procédez à un upgrade »</p></li></ul><p>Première erreur :</p><p>Vous avez donc cliqué sur le lien du log, lu et relu ce dernier sans trouver d’explication complète sur ce qui a fait échouer l’installation. A partir de là et pour ma part j’ai ouvert les logs SharePoint (grâce au SharePoint log viewer) et je me suis rendu compte qu’il n’arrivait pas à procéder à l’upgrade d’une des bases de données (l’Usage Application dans mon cas).</p><p>Il m’a suffi d’arrêter le mirroring sur cette base et de relancer le wizard pour qu’il arrive à se terminer.</p><p>Seconde erreur :</p><p>Deux cas de figure, ou bien vous êtes chanceux et les bases de données en échec d’upgrade sont des bases données de contenu (SPContentDatabase) et dans ce cas il suffit de procéder à un Upgrade-SPContentDatabase depuis powershell. Si ca ne passe pas, coupez le mirroring et refaites le après l’upgrade.</p><p>Second cas de figure pour les moins chanceux (et j’en fais partie) les bases de données ne sont pas des bases de contenu. Cet état de base de données a souvent tendance à causer tout un tas de problèmes sur la ferme : Services bloqués au démarrage ou à l’extinction, timerjobs plantés/bloqués, applications de services non fonctionnelles ou pire, impossible à supprimer…</p><p>Dans ce second cas de figure c’est un peu plus compliqué donc, vous pouvez essayer d’arrêter le mirroring sur toutes les bases de données en échec, relancer le psconfig et refaire le mirroring ensuite.</p><p>Si ça ne fonctionne toujours pas, il faut arrêter tous les jobs et services liés à ces bases et les refaire (donc refaire une bonne partie de la configuration de ce qui tourne au-dessus).</p><p>Au final, je conseille à tous les administrateurs dans ce cas de figure de supprimer le mirroring sur les bases de données le temps de passer le SP1 (juste avant le psconfig) puis de les remettre en mirroir ensuite une fois qu’il aura été vérifié que toutes les bases de données se sont upgradées correctement.</p><p>Si quelqu’un a l’explication du « pourquoi le mirroring met le bazard ? » qu’il n’hésite pas à commenter cet article J</p><p>Bon déploiement à tous !</p></div><br><p class=heading>Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/568d5785231309e09639a038db8aa4f4e71568c3>13 Sep 2020</a> par <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/fr/tags/mirroring><span class=tag>Mirroring</span></a></div><div class=control><a href=/fr/tags/install><span class=tag>Install</span></a></div><div class=control><a href=/fr/tags/upgrade><span class=tag>Upgrade</span></a></div><div class=control><a href=/fr/tags/mise-%c3%a0-jour><span class=tag>Mise À Jour</span></a></div><div class=control><a href=/fr/tags/sp1><span class=tag>Sp1</span></a></div><div class=control><a href=/fr/tags/miroir><span class=tag>Miroir</span></a></div><div class=control><a href=/fr/tags/2010><span class=tag>2010th</span></a></div><div class=control><a href=/fr/tags/sharepoint><span class=tag>Sharepoint</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/uploader-automatiquement-les-p/><span class="icon is-small"><i class="fa fa-chevron-left"></i></span><span class="is-hidden-touch is-hidden-desktop-only">Uploader automatiquement les photos des utilisateurs SharePoint sur leur profil en PowerShell</span>
<span class="is-hidden-touch is-hidden-widescreen">Uploader automatiquement les photos des utilisateurs SharePoint sur leur...</span>
<span class="is-hidden-mobile is-hidden-desktop">Uploader automatiquement les photos des...</span>
<span class=is-hidden-tablet>Uploader automatiquement les photos des...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/re-realease-de-la-mise-a-jour/><span class="is-hidden-touch is-hidden-desktop-only">Re-Realease de la mise à jour cumulative de Juin (CU1 June)</span>
<span class="is-hidden-touch is-hidden-widescreen">Re-Realease de la mise à jour cumulative de Juin (CU1 June)</span>
<span class="is-hidden-mobile is-hidden-desktop">Re-Realease de la mise à jour cumulative de Juin...</span>
<span class=is-hidden-tablet>Re-Realease de la mise à jour cumulative...</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/upgrade-des-bases-de-donnees-m/";this.page.identifier=window.location.pathname;};(function(){var d=document,s=d.createElement('script');s.src='https://baywet.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/fr/re-realease-de-la-mise-a-jour/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Re-Realease de la mise à jour cumulative de Juin (CU1 June)&nbsp;<div class=tag>Mise À Jour</div><div class=tag>Sp1</div><div class=tag>2010th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/industrialisation-des-installa-2011-07-06-16-42-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Industrialisation des installations de ferme SharePoint 2010(CU, SP, Langues, SlipStream) Part 3&nbsp;<div class=tag>Sp1</div><div class=tag>2010th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/industrialisation-des-installa-2011-07-06-16-11-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Industrialisation des installations de ferme SharePoint 2010(CU, SP, Langues, SlipStream) Part 2&nbsp;<div class=tag>Sp1</div><div class=tag>2010th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/industrialisation-des-installa-2011-07-06-15-47-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Industrialisation des installations de ferme SharePoint 2010(CU, SP, Langues, SlipStream) Part 1&nbsp;<div class=tag>Sp1</div><div class=tag>2010th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sp1-pour-sharepoint-2010/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>SP1 pour SharePoint 2010&nbsp;<div class=tag>Sp1</div><div class=tag>2010th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/mirroring-sql-et-sharepoint-t/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Mirroring SQL et SharePoint : Tips & Piège&nbsp;<div class=tag>Mirroring</div><div class=tag>Miroir</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/webconference-sur-la-securite/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>WebConférence sur la sécurité avec la gamme ForeFront 2010&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/topologie-des-fermes-sharepoin/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Topologie des fermes SharePoint et déploiement de ForeFront Protection for SharePoint&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/vue-densemble-des-services-de/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Vue d’ensemble des services de conversion des documents dans SharePoint 2010&nbsp;<div class=tag>2010th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/requtage-active-directory-depu/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Requêtage Active Directory depuis SharePoint.&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/feedback-msday-aix-en-provence/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Feedback MSDay Aix-En-Provence 30/09/10&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/ajouter-un-nouvel-administrate/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Ajouter un nouvel administrateur de ferme SharePoint pouvant éxécuter la console PowerShell sans encombres&nbsp;<div class=tag>2010th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/configuration-du-service-profi/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Configuration du service profil utilisateur sous SharePoint 2010/2007&nbsp;<div class=tag>2010th</div><div class=tag>Sharepoint</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/fr><span class=icon><i class="fa fa-home"></i></span></a>&nbsp;
<a class=button href><span class=icon><i class="fa fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>