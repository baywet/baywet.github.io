<!doctype html><html lang=fr dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Gestion des ressources, rendre vos solutions SharePoint « globally deployed »</title><meta name=author content="Vincent Biret"><meta name=description content="Introduction
Cela fait quelques temps déjà que je voulais rédiger cet article, j’ai trouvé cette solution il y a quatre ou cinq mois déjà. Mais par manque de temps je n’ai pas pu le faire avant...."><meta name=generator content="Hugo 0.74.3"><meta itemprop=name content="Gestion des ressources, rendre vos solutions SharePoint « globally deployed »"><meta itemprop=description content="Introduction
Cela fait quelques temps déjà que je voulais rédiger cet article, j’ai trouvé cette solution il y a quatre ou cinq mois déjà. Mais par manque de temps je n’ai pas pu le faire avant...."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Gestion des ressources, rendre vos solutions SharePoint « globally deployed »"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/fr/gestion-des-ressources-rendre/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="Introduction
Cela fait quelques temps déjà que je voulais rédiger cet article, j’ai trouvé cette solution il y a quatre ou cinq mois déjà. Mais par manque de temps je n’ai pas pu le faire avant...."><meta property="og:site_name" content="Le blog de baywet"><meta property="og:updated_time" content="2020-09-13T10:55:23-04:00"><meta property="article:published_time" content="2014-01-23T03:37:00+00:00"><meta property="article:modified_time" content="2020-09-13T10:55:23-04:00"><meta property="article:section" content><meta property="article:tag" content="2013"><meta property="article:tag" content="dev"><meta property="article:tag" content="resources"><meta property="article:tag" content="multinlingue"><meta property="article:tag" content="developer"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Gestion des ressources, rendre vos solutions SharePoint « globally deployed »"><meta name=twitter:description content="Introduction
Cela fait quelques temps déjà que je voulais rédiger cet article, j’ai trouvé cette solution il y a quatre ou cinq mois déjà. Mais par manque de temps je n’ai pas pu le faire avant...."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-176061333-1','auto');ga('send','pageview');</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/fr><div class="title is-4">&nbsp;Le blog de baywet</div></a><label class="button navbar-burger is-white" for=navbar-burger-state><span></span><span></span><span></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=https://baywet.github.io/managing-resources-how-to-make/>English</a></div></div></div></nav><section class=section style=flex:1><div class=container><h1 class=title>Gestion des ressources, rendre vos solutions SharePoint « globally deployed »</h1><p class=subtitle>Jan 23, 2014</p><div class=content><h3 id=clip_5f00_image002_5f00_thumb_5f00_2cb1cf09jpgclip_5f00_image002_5f00_thumb_5f00_2cb1cf09jpg><img src=./clip_5F00_image002_5F00_thumb_5F00_2CB1CF09.jpg alt=clip_5F00_image002_5F00_thumb_5F00_2CB1CF09.jpg></h3><h2 id=introduction>Introduction</h2><p>Cela fait quelques temps déjà que je voulais rédiger cet article, j’ai trouvé cette solution il y a quatre ou cinq mois déjà. Mais par manque de temps je n’ai pas pu le faire avant. Récemment Sébastien LEVERT, développeur SharePoint de haut vol et membre de la communauté SharePoint à Montréal, a publié un article qui traite du même genre de problématique. Allez le lire, je vais faire en sorte que nos deux articles soient complémentaires (faute d’avoir publié plus tôt) <a href=https://www.pimpmysharepoint.com/2014/01/09/deployer-des-fichiers-de-ressources-simplement/>https://www.pimpmysharepoint.com/2014/01/09/deployer-des-fichiers-de-ressources-simplement/</a></p><h2 id=un-peu-de-rappels>Un peu de rappels</h2><p>Si je résume rapidement, lorsque l’on développe des solutions SharePoint et qu’on veut les localiser (les rendre utilisables en plusieurs langues) on utilise des ressources .net. Ces fichiers .resx viennent de l’asp.net et sont structurés sous la forme clef/valeur. Il faut créer un fichier par langue prise en charge. Au lieu de mettre les textes directement dans notre code (ce qui est très sale de toute manière) on les référence grâce aux clefs définies.</p><p>Certaines contraintes techniques nous imposent de déployer ces fichiers à deux endroits :</p><ul><li><p>Hive\config\resources : pour les textes utilisés dans les pages web, les contrôles utilisateurs etc.</p></li><li><p>Hive\Resources : pour les textes utilisés dans les workflows, timerjobs etc (ce qui est « caché » en gros)</p></li></ul><p>On a par extension deux autres « emplacements » à connaitre :</p><ul><li><p>Hive\admin\resources : resources pour le site web d’administration centrale de SharePoint.</p></li><li><p>App_GlobalResources : répertoire dans chacune des applications web, est une copie du hive\config\resources (copie étant effectuée via stsadm –o copyappbincontent par exemple)</p></li></ul><p>Il est possible de déployer nos ressources « web » directement dans le répertoire App_GlobalResources. Cela économise un peu de travail à nos administrateurs lors du déploiement des solutions. Sébastien explique cela, mais il explique aussi une méthode pour qu’un même fichier de ressources soit déployé dans App_GlobalResources et hive\Resources. Ça permet d’utiliser de manière simple vos ressources au travers de toute votre solution (dans vos timer jobs comme au sein de vos pages applicatives par exemple). En effet on se retrouve assez rapidement dans une situation où l’on a besoin d’une ressource dans une page et dans un timerjob par exemple, nous obligeant normalement à faire des copies. C’est une bonne solution et je la recommande si vous n’avez pas la contrainte que je vais vous expliquer plus bas.</p><h2 id=mise-en-contexte>Mise en contexte</h2><p>J’ai récemment participé au développement d’un produit pour SharePoint. Ce produit ajoute une nouvelle application de service à SharePoint et un nouveau service. Lors des phases de tests avant la version finale, j’ai voulu essayer quelque chose : faire tourner le service sur un serveur applicatif.</p><p>En effet c’est un cas de figure qui se présente assez souvent dès que les fermes SharePoint commencent à avoir une taille moyenne : une partie des serveurs est dédiée à la génération des pages, les web front end et l’autre à l’exécution des services gourmands, les serveurs applicatifs.</p><p>A ce moment-là nous avons été assez surpris de constater que puisque nos solutions contenaient des fichiers ressources déployés dans App_GlobalResources, elles étaient déployées uniquement sur les serveurs ayant le rôle « Microsoft SharePoint Web Foundation » activé. Du coup les dll requises pour le bon fonctionnement de notre service n’était pas présentes et ce dernier ne s’enregistrait pas correctement/ne démarrait pas.</p><h2 id=solution>Solution</h2><p>Il fallait donc que je trouve un moyen de pouvoir utiliser des ressources au sien d’un contrôle ou d’une page sans pour autant avoir la nécessité de déployer mes fichiers dans App_GlobalResources.</p><p>La première partie de la solution m’a été apportée dans ce projet codeplex <a href=https://spexpressions.codeplex.com/>https://spexpressions.codeplex.com/</a> qui permet aux développeurs et/ou intégrateurs de disposer de plus de variables d’environnements SharePoint au sein des pages qu’ils conçoivent.</p><p>La solution est donc simple :</p><ul><li><p>Une ligne dans le web.config qui indique à IIS comment interpréter une nouvelle expression</p></li><li><p>Une classe pour traiter cette nouvelle expression</p></li><li><p>Une fonctionnalité pour inscrire/enlever cette ligne du web.config</p></li><li><p>Les fichiers ressources déployés dans hive\Resources</p></li></ul><p>Comme je suis sympa j’ai inclus un exemple dans les fichiers téléchargeables inclus à cet article.</p><p>Avantages par rapport à la solution de Sébastien :</p><ul><li><p>Un seul fichier déployé</p></li><li><p>Vos solutions restent déployées de manière globale (enfin sauf si un autre élément la force à se déployer par web app)</p></li></ul><p>Inconvénients :</p><ul><li>Plus complexe</li></ul><p><img src=./clip_5F00_image004_5F00_thumb_5F00_607C560B.jpg alt=clip_5F00_image004_5F00_thumb_5F00_607C560B.jpg></p><p>Note: la solution que je fournis en pièce jointe est ciblée pour SharePoint 2010 mais fonctionne tout aussi bien sous 2013, notre produit est dans les deux versions.</p></div><br><p class=heading>Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/c9bd5af2a5bebecf70aecb95cd5a8c2700debba1>13 Sep 2020</a> par <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/fr/tags/2013><span class=tag>2013th</span></a></div><div class=control><a href=/fr/tags/dev><span class=tag>Dev</span></a></div><div class=control><a href=/fr/tags/resources><span class=tag>Resources</span></a></div><div class=control><a href=/fr/tags/multinlingue><span class=tag>Multinlingue</span></a></div><div class=control><a href=/fr/tags/developer><span class=tag>Developer</span></a></div><div class=control><a href=/fr/tags/deployment><span class=tag>Deployment</span></a></div><div class=control><a href=/fr/tags/2010><span class=tag>2010th</span></a></div><div class=control><a href=/fr/tags/sharepoint><span class=tag>Sharepoint</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/trois-nouveaux-sur-la-platefor/><span class="icon is-small"><i class="fa fa-chevron-left"></i></span><span class="is-hidden-touch is-hidden-desktop-only">Trois nouveaux sur la plateforme Microsoft Touch !</span>
<span class="is-hidden-touch is-hidden-widescreen">Trois nouveaux sur la plateforme Microsoft Touch !</span>
<span class="is-hidden-mobile is-hidden-desktop">Trois nouveaux sur la plateforme Microsoft Touch !</span>
<span class=is-hidden-tablet>Trois nouveaux sur la plateforme...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/aidez-moi-a-tre-conferencier-a/><span class="is-hidden-touch is-hidden-desktop-only">Aidez-moi à être conférencier à la SP24 la première web conférence tout autour du monde !</span>
<span class="is-hidden-touch is-hidden-widescreen">Aidez-moi à être conférencier à la SP24 la première web conférence tout...</span>
<span class="is-hidden-mobile is-hidden-desktop">Aidez-moi à être conférencier à la SP24 la...</span>
<span class=is-hidden-tablet>Aidez-moi à être conférencier à la SP24...</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/gestion-des-ressources-rendre/";this.page.identifier=window.location.pathname;};(function(){var d=document,s=d.createElement('script');s.src='https://baywet.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/fr/aidez-moi-a-tre-conferencier-a/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Aidez-moi à être conférencier à la SP24 la première web conférence tout autour du monde !&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferences-a-venir-en-2014/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Conférences à venir en 2014&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/invite-au-webcast-de-pimpmysha/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Invité au webcast de @PimpMySharePoint !&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/installing-sharepoint-2013-pre/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Installing SharePoint 2013 prerequisites on offline environments&nbsp;<div class=tag>Deployment</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/installation-des-prerequis-sha/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Installation des prérequis SharePoint 2013 sur des serveurs hors ligne&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/boost-your-sharepoint-solution/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Boost your SharePoint solutions with distributed cache!–Part 3–Let’s Code!&nbsp;<div class=tag>2013th</div><div class=tag>Dev</div><div class=tag>Developer</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/boostez-vos-solutions-sharepoi-2013-12-14-20-21-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Boostez vos solutions SharePoint avec le cache distribué !–Partie 3–Le code&nbsp;<div class=tag>2013th</div><div class=tag>Dev</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/boostez-vos-solutions-sharepoi-2013-12-12-09-08-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Boostez vos solutions SharePoint avec le cache distribué !–Partie 2–Explications et astuces&nbsp;<div class=tag>2013th</div><div class=tag>Dev</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/boostez-vos-solutions-sharepoi-2013-12-11-01-15-14/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Boostez vos solutions SharePoint avec le cache distribué !–Partie 1 Introduction&nbsp;<div class=tag>2013th</div><div class=tag>Dev</div><div class=tag>Developer</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sharepoint-autohosted-app-et-a/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>SharePoint autohosted app et ASP.NET MVC&nbsp;<div class=tag>2013th</div><div class=tag>Developer</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/entity-framework-et-reference/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Entity Framework et référence au dataContext pour une application web&nbsp;<div class=tag>Dev</div><div class=tag>Developer</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sharepoint-2013-vectorized-log/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>SharePoint 2013 vectorized logo / logo SharePoint 2013 vectorialisé&nbsp;<div class=tag>2013th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/mise-a-jour-cumulative-doctobr/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Mise à jour cumulative d’Octobre 2013 pour SharePoint 2010&nbsp;<div class=tag>2010th</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/visual-studio-2013-rc-comptag/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Visual Studio 2013 RC : Comptage des références à votre code&nbsp;<div class=tag>2013th</div></span></a><a class=panel-block href=https://baywet.github.io/fr/mise-a-jour-des-outils-cks/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Mise à jour des Outils CKS&nbsp;<div class=tag>2013th</div><div class=tag>Sharepoint</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/fr><span class=icon><i class="fa fa-home"></i></span></a>&nbsp;
<a class=button href><span class=icon><i class="fa fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>