<!doctype html><html lang=fr dir=ltr itemscope itemtype=https://schema.org/Article>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<title>Boostez vos solutions SharePoint avec le cache distribué !–Partie 3–Le code</title>
<meta name=author content="Vincent Biret">
<meta name=description content="Passons au code !
Tout ce dont vous avez besoin se situe dans ces namespaces Microsoft.SharePoint.DistributedCaching (...">
<meta name=generator content="Hugo 0.88.1">
<meta itemprop=name content="Boostez vos solutions SharePoint avec le cache distribué !–Partie 3–Le code">
<meta itemprop=description content="Passons au code !
Tout ce dont vous avez besoin se situe dans ces namespaces Microsoft.SharePoint.DistributedCaching (...">
<meta itemprop=image content="/img/logo.svg">
<meta property="og:title" content="Boostez vos solutions SharePoint avec le cache distribué !–Partie 3–Le code">
<meta property="og:type" content="article">
<meta property="og:url" content="https://baywet.github.io/fr/boostez-vos-solutions-sharepoi-2013-12-14-20-21-00/">
<meta property="og:image" content="/img/logo.svg">
<meta property="og:description" content="Passons au code !
Tout ce dont vous avez besoin se situe dans ces namespaces Microsoft.SharePoint.DistributedCaching (...">
<meta property="og:site_name" content="Le blog de baywet">
<meta property="og:updated_time" content="2021-09-06T09:54:53-07:00">
<meta property="article:published_time" content="2013-12-14T20:21:00+00:00">
<meta property="article:modified_time" content="2021-09-06T09:54:53-07:00">
<meta property="article:section" content>
<meta property="article:tag" content="performance">
<meta property="article:tag" content="cache">
<meta property="article:tag" content="2013">
<meta property="article:tag" content="dev">
<meta property="article:tag" content="distribué">
<meta name=twitter:card content="summary">
<meta name=twitter:site content>
<meta name=twitter:title content="Boostez vos solutions SharePoint avec le cache distribué !–Partie 3–Le code">
<meta name=twitter:description content="Passons au code !
Tout ce dont vous avez besoin se situe dans ces namespaces Microsoft.SharePoint.DistributedCaching (...">
<meta name=twitter:creator content>
<meta name=twitter:image:src content="/img/logo.svg">
<link rel=stylesheet type=text/css href=/css/capsule.min.css>
<script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-176061333-1','auto'),ga('send','pageview')</script>
<link rel=apple-touch-icon href=/img/apple-touch-icon.png>
<link rel=icon href=/img/favicon.ico>
</head>
<body style=min-height:100vh;display:flex;flex-direction:column>
<nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation">
<div class=container>
<div class=navbar-brand>
<a class=navbar-item href=/fr>
<div class="title is-4">&nbsp;Le blog de baywet</div>
</a>
<label class="button navbar-burger is-white" for=navbar-burger-state>
<span></span>
<span></span>
<span></span>
</label>
</div>
<input type=checkbox id=navbar-burger-state>
<div class=navbar-menu>
<div class=navbar-end>
<a class=navbar-item href=/en>English</a>
</div>
</div>
</div>
</nav>
<section class=section style=flex:1>
<div class=container>
<h1 class=title>Boostez vos solutions SharePoint avec le cache distribué !–Partie 3–Le code</h1>
<p class=subtitle>Dec 14, 2013</p>
<div class=content>
<h3 id=passons-au-code->Passons au code !</h3>
<p>Tout ce dont vous avez besoin se situe dans ces namespaces Microsoft.SharePoint.DistributedCaching (<a href=https://msdn.microsoft.com/en-us/library/office/microsoft.sharepoint.distributedcaching.aspx>https://msdn.microsoft.com/en-us/library/office/microsoft.sharepoint.distributedcaching.aspx</a> ), Microsoft.SharePoint.DistributedCaching.Utilities, Microsoft.ApplicationServer.Caching (<a href="https://msdn.microsoft.com/en-us/library/microsoft.applicationserver.caching%28v=azure.10%29.aspx">https://msdn.microsoft.com/en-us/library/microsoft.applicationserver.caching(v=azure.10).aspx</a> ), interdit de référencer quoi que ce soit d’autre venant d’appfabric.</p>
<p>Autre information, il est possible que selon la version de visual studio installée et celle de sharepoint vous n’ayez pas les dll dans l’ISAPI de SharePoint (les dossiers que va regarder Visual Studio pour savoir quels sont les assemblies à disposition). Dans ce cas il faudra aller référencer les dlls directement depuis l’emplacement dans le GAC. Vous pouvez utiliser ILSPY ou équivalent pour connaitre l’emplacement exact. (ou bien demandez moi dans les commentaires si vous en avez besoin).</p>
<p>Comme je suis gentil, vous trouverez en pièce jointe de cet article un fichier cs qui vous aidera à manipuler le cache. Ce n’est pas très compliqué, le modèle de connexion au cluster de cache repose sur un pattern factory. D’ailleurs à ce propos, pour faire proprement les choses, il faudra à la fin de la requête (via le global.asax par exemple) et/ou à la fin des traitements (cas d’un timerjob par exemple) s’assurer que les factories sont bien disposées proprement.</p>
<p>Une fois la factory instanciée, on obtient le cache qui correspond à la partition ciblée (même chose, DataCache n’est pas disposable, mais si vous disposez les factories, pensez à déréférencer ces objets aussi). Dès lors il n’y a plus qu’à utiliser le cache via les méthodes fournies par Microsoft.</p>
<p>A noter que je me suis fait une petite méthode PutAndCheckRegion. En effet, les régions disparaissent quand elles ne contiennent plus d’éléments, il faut donc s’assurer de leur présence à chaque fois qu’on veut y stocker quelque chose.</p>
<h3 id=conclusion>Conclusion</h3>
<p>J’espère que vous avez appris plein de choses sur cette solution de mise en cache offerte par SharePoint. Encore une fois c’est une solution parmi d’autres, elle peut s’avérer utile ou inutile en fonction de vos besoins. Je me suis efforcé de vous donner un maximum d’informations afin que vous soyez en capacité de comprendre les implications de son utilisation.</p>
<p>Plus d’excuses pour avoir une solution qui est lente maintenant ! Si vous avez des questions/remarques/plaintes, n’hésitez pas à commenter.</p>
</div>
<br>
<p class=heading>
Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/f1c07980424f8c88fce2580454819da383433fb8>
6 Sep 2021
</a> par <a href=https://github.com/baywet>Vincent Biret</a>
</p>
<br>
<div class=heading>Tags:</div>
<div class="field is-grouped is-grouped-multiline">
<div class=control>
<a href=/fr/tags/performance>
<span class=tag>Performance</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/cache>
<span class=tag>Cache</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/2013>
<span class=tag>2013th</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/dev>
<span class=tag>Dev</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/distribu%c3%a9>
<span class=tag>Distribué</span>
</a>
</div>
<div class=control>
<a href=/fr/tags/sharepoint>
<span class=tag>Sharepoint</span>
</a>
</div>
</div>
</div>
</section>
<section class=section>
<div class=container>
<div class=level>
<div class=level-left>
<div class=level-item>
<p class="control has-addons">
<a class=button href=https://baywet.github.io/fr/boost-your-sharepoint-solution/>
<span class="icon is-small"><i class="fa fa-chevron-left"></i></span>
<span class="is-hidden-touch is-hidden-desktop-only">
Boost your SharePoint solutions with distributed cache!–Part 3–Let’s Code!
</span>
<span class="is-hidden-touch is-hidden-widescreen">
Boost your SharePoint solutions with distributed cache!–Part 3–Let’s Code!
</span>
<span class="is-hidden-mobile is-hidden-desktop">
Boost your SharePoint solutions with distributed...
</span>
<span class=is-hidden-tablet>
Boost your SharePoint solutions with...
</span>
</a>
</p>
</div>
</div>
<div class=level-right>
<div class=level-item>
<p class="control has-addons">
<a class=button href=https://baywet.github.io/fr/boostez-vos-solutions-sharepoi-2013-12-12-09-08-00/>
<span class="is-hidden-touch is-hidden-desktop-only">
Boostez vos solutions SharePoint avec le cache distribué !–Partie 2–Explications et astuces
</span>
<span class="is-hidden-touch is-hidden-widescreen">
Boostez vos solutions SharePoint avec le cache distribué !–Partie...
</span>
<span class="is-hidden-mobile is-hidden-desktop">
Boostez vos solutions SharePoint avec le cache...
</span>
<span class=is-hidden-tablet>
Boostez vos solutions SharePoint avec le...
</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
</a>
</p>
</div>
</div>
</div>
</div>
<br>
<br>
<div class=container>
<div id=disqus_thread></div>
<script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/boostez-vos-solutions-sharepoi-2013-12-14-20-21-00/",this.page.identifier=window.location.pathname};(function(){var a=document,b=a.createElement('script');b.src='https://baywet.disqus.com/embed.js',b.setAttribute('data-timestamp',+new Date),(a.head||a.body).appendChild(b)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
</div>
<br>
<div class=container>
<nav class=panel>
<p class=panel-heading>Related</p>
<a class=panel-block href=https://baywet.github.io/fr/boostez-vos-solutions-sharepoi-2013-12-12-09-08-00/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Boostez vos solutions SharePoint avec le cache distribué !–Partie 2–Explications et astuces&nbsp;
<div class=tag>Performance</div>
<div class=tag>Cache</div>
<div class=tag>2013th</div>
<div class=tag>Dev</div>
<div class=tag>Distribué</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/boostez-vos-solutions-sharepoi-2013-12-11-01-15-14/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Boostez vos solutions SharePoint avec le cache distribué !–Partie 1 Introduction&nbsp;
<div class=tag>Performance</div>
<div class=tag>Cache</div>
<div class=tag>2013th</div>
<div class=tag>Dev</div>
<div class=tag>Distribué</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/sharepoint-autohosted-app-et-a/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>SharePoint autohosted app et ASP.NET MVC&nbsp;
<div class=tag>2013th</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/entity-framework-et-reference/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Entity Framework et référence au dataContext pour une application web&nbsp;
<div class=tag>Dev</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/sharepoint-2013-vectorized-log/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>SharePoint 2013 vectorized logo / logo SharePoint 2013 vectorialisé&nbsp;
<div class=tag>2013th</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/mise-a-jour-cumulative-doctobr/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Mise à jour cumulative d’Octobre 2013 pour SharePoint 2010&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/visual-studio-2013-rc-comptag/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Visual Studio 2013 RC : Comptage des références à votre code&nbsp;
<div class=tag>2013th</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/mise-a-jour-des-outils-cks/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Mise à jour des Outils CKS&nbsp;
<div class=tag>2013th</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/le-developer-dashboard-reste-v/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Le developer dashboard reste vide sur SharePoint 2013&nbsp;
<div class=tag>2013th</div>
<div class=tag>Dev</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/sortie-du-service-pack-2-pour/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Sortie du Service Pack 2 pour SharePoint 2010&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/sortie-de-la-mise-a-jour-cumul/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Sortie de la mise à jour cumulative de Juin 2013 pour SharePoint&nbsp;
<div class=tag>2013th</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/selectionne-pour-les-10-plus-g/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Sélectionné pour les 10 plus grands influenceurs SharePoint Francophones!&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/ecrire-du-code-securise-pour-s/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Ecrire du code sécurisé pour SharePoint&nbsp;
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/retour-sur-le-sharepoint-summi/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Retour sur le SharePoint Summit de Québec 2013&nbsp;
<div class=tag>2013th</div>
<div class=tag>Sharepoint</div>
</span>
</a>
<a class=panel-block href=https://baywet.github.io/fr/la-mise-a-jour-davril-2013-pou/>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>La mise à jour d’avril 2013 pour SharePoint est disponible&nbsp;
<div class=tag>2013th</div>
<div class=tag>Sharepoint</div>
</span>
</a>
</nav>
</div>
</section>
<footer class=footer>
<div class=container>
<nav class=level>
</nav>
<nav class=level>
<div class="level-left has-text-centered">
<div class=level-item>
<form class="control has-icons has-icons-right" method=get action=https://bing.com>
<input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span>
</form>
</div>
</div>
<div class="level-right has-text-centered">
<div class=level-item>
<a class=button href=https://baywet.github.io/fr>
<span class=icon><i class="fa fa-home"></i></span>
</a> &nbsp;
<a class=button href>
<span class=icon><i class="fa fa-rss"></i></span>
</a>
</div>
</div>
</nav>
</div>
</footer>
<script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script>
</body>
</html>