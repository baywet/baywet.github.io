<!doctype html><html lang=fr dir=ltr itemscope itemtype=https://schema.org/Article><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Microsoft Graph et HTTP/2</title>
<meta name=author content="Vincent Biret"><meta name=description content="Pendant des années, Microsoft Graph a répondu à des milliards de requêtes par jour en tant que l&rsquo;une des principales API REST des services Microsoft. Le service est devenu une infrastructure clé..."><meta name=generator content="Hugo 0.124.1"><meta itemprop=name content="Microsoft Graph et HTTP/2"><meta itemprop=description content="Pendant des années, Microsoft Graph a répondu à des milliards de requêtes par jour en tant que l&rsquo;une des principales API REST des services Microsoft. Le service est devenu une infrastructure clé..."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Microsoft Graph et HTTP/2"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/fr/microsoft-graph-http2/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="Pendant des années, Microsoft Graph a répondu à des milliards de requêtes par jour en tant que l&rsquo;une des principales API REST des services Microsoft. Le service est devenu une infrastructure clé..."><meta property="og:site_name" content="Le blog de baywet"><meta property="og:updated_time" content="2024-04-15T10:13:42-04:00"><meta property="article:published_time" content="2024-02-19T15:41:45+00:00"><meta property="article:modified_time" content="2024-04-15T10:13:42-04:00"><meta property="article:section" content><meta property="article:tag" content="http2"><meta property="article:tag" content="microsoft"><meta property="article:tag" content="graph"><meta property="article:tag" content="msgraph"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Microsoft Graph et HTTP/2"><meta name=twitter:description content="Pendant des années, Microsoft Graph a répondu à des milliards de requêtes par jour en tant que l&rsquo;une des principales API REST des services Microsoft. Le service est devenu une infrastructure clé..."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/js/all.js integrity=sha384-IkmLcEDxkvCioiswmdraONwAU9uwbPWUbvuHAGrejK3zNlL74FCwCjvnTGJcrdbQ crossorigin=anonymous></script><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-176061333-1","auto"),ga("send","pageview")</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/fr/><div class="title is-4">&nbsp;Le blog de baywet</div></a><label role=button class="navbar-burger has-text-dark" aria-label=menu aria-expanded=false for=navbar-burger-state><span aria-hidden=true></span>
<span aria-hidden=true></span>
<span aria-hidden=true></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=https://baywet.github.io/microsoft-graph-http2/>English</a></div></div></div></nav><section class=section style=flex:1><div class=container><h1 class=title>Microsoft Graph et HTTP/2</h1><p class=subtitle>Feb 19, 2024</p><div class=content><p>Pendant des années, Microsoft Graph a répondu à des milliards de requêtes par jour en tant que l&rsquo;une des principales API REST des services Microsoft. Le service est devenu une infrastructure clé pour les applications de Microsoft, les solutions métier et les solutions commerciales tierces.</p><p>Tout élément d&rsquo;infrastructure critique s&rsquo;accompagne de responsabilités rigoureuses : maintenance, support et sécurisation. Et parfois, cette infrastructure doit être « mise à niveau » vers les normes les plus récentes, ce qui améliore la valeur fournie à ses utilisateurs grâce à une meilleure sécurité, une meilleure interopérabilité et de meilleures performances.</p><p>Sur le plan de la sécurité, l&rsquo;équipe de service a déployé la prise en charge de TLS1.2/1.3, ainsi que <a href=https://techcommunity.microsoft.com/t5/microsoft-sharepoint-blog/tls-1-0-and-1-1-deprecation/ba-p/1620264>désactivé la prise en charge de TLS1.0/1.1</a>. Sur le front de l&rsquo;interopérabilité, <a href=https://learn.microsoft.com/en-us/troubleshoot/azure/active-directory/azure-ad-ipv6-support>IPv6 a été activé pour Microsoft Graph il y a quelques mois</a>. Les deux mises à niveau ont également permis de réduire la latence.</p><p>De même, HTTP/2 (h2) permet de réduire la latence, l&rsquo;utilisation de la bande passante (protocole binaire, compression des en-têtes&mldr;) et permet un meilleur parallélisme des requêtes multiples par rapport à HTTP/1.1.</p><p>Cet article raconte l&rsquo;histoire du déploiement h2 pour Microsoft Graph, une histoire de planification et de collaboration minutieuses.</p><h2 id=début>Début</h2><p>À l&rsquo;époque où j&rsquo;étais MVP Microsoft, je plaidais déjà auprès de l&rsquo;équipe produit, alors plus petite, pour obtenir un support h2. En fait, je crois que le fait de m&rsquo;exprimer à ce sujet est l&rsquo;une des raisons pour lesquelles je fais partie de l&rsquo;équipe maintenant : « arrête de te plaindre de cela et viens nous aider à la place ». Bien sûr, h2 avait toujours une priorité inférieure par rapport à l’ajout de fonctionnalités supplémentaires.</p><p>Avance rapide jusqu&rsquo;en février 2022, je travaille maintenant dans l&rsquo;équipe de l&rsquo;expérience des développeurs (SDK, outils, etc.) et l&rsquo;équipe de service est occupée à mettre à niveau Microsoft Graph de dotnet « classique » à core. Lors du déploiement de cette nouvelle version, les clients ont commencé à se plaindre de problèmes avec d&rsquo;anciennes versions du SDK Java. Cela semblait étrange car les mises à niveau internes ne devraient pas avoir d&rsquo;impact sur la surface de l&rsquo;API elle-même.</p><p>Il s&rsquo;avère que :</p><ul><li>h2 est activé par défaut avec asp.net core. (désactivé en classique)</li><li>h2 normalise les en-têtes en lower-kebab-case. (par opposition à Upper-Kebab-Case avec HTTP/1.1)</li><li>ces anciennes versions du SDK Java utilisaient des comparaisons sensibles à la casse pour piloter leur logique.</li></ul><h2 id=planification>Planification</h2><p>Après cette première expérience avec h2, l&rsquo;équipe de service a configuré une plate-forme de validation avec h2 activé afin que nous puissions tester tous les SDK pour h2 et corriger les SDK problématiques.</p><p>C&rsquo;était d&rsquo;autant plus préoccupant que nous n&rsquo;avions aucun moyen de mesurer correctement le problème : les requêtes/réponses n&rsquo;échouaient pas, si une défaillance se produisait, elle se situait sur l&rsquo;infrastructure des clients.</p><p>L&rsquo;équipe de service a ensuite communiqué un changement de protocole à venir et a donné aux clients plus d&rsquo;un an pour se préparer à ce changement. Les clients pouvaient soit :</p><ul><li>Désactiver h2 via le code ou la configuration. (moins désiré)</li><li>Vérifier qu&rsquo;ils utilisaient les versions « testées pour h2 » des SDK.</li><li>Vérifier leur code où il lit les en-têtes.</li></ul><h2 id=livraison>Livraison</h2><p>Nous avions initialement prévu de commencer à déployer h2 en septembre 2023, mais nous avons dû le reporter à février 2024 en raison <a href=https://www.cisa.gov/news-events/alerts/2023/10/10/http2-rapid-reset-vulnerability-cve-2023-44487>de la vulnérabilité Rapid Reset découverte dans certaines implémentations de serveur h2</a>.</p><p>Après le déploiement progressif de h2, l&rsquo;équipe de service a remarqué que certaines instances de service montaient en charge tandis que d&rsquo;autres restaient inactives. Cela était dû au fait que l&rsquo;affinité de partition au niveau du répartiteur de charge ne tenait pas compte du nombre maximal de flux parallèles par connexion, ce qui a été rapidement corrigé.</p><p>H2 est enfin entièrement déployé et la seule chose que vous auriez dû remarquer, c&rsquo;est que « les choses semblent un peu plus rapides ». Ces mises à niveau de protocole (h2, IPv6, TLS1.2+) permettent à notre infrastructure de fonctionner comme sur des roulettes.</p><p>Nous envisageons déjà de déployer HTTP3 qui devrait permettre une latence encore plus faible grâce à sa nouvelle couche QUIC !</p><p>J&rsquo;espère que ce genre d&rsquo;article sur les coulisses vous a intéressé, dites-moi ce que vous en avez pensé dans les commentaires !</p></div><br><p class=heading>Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/f9e991747e54c1ef20df74731781a7d829a3984e>15 Apr 2024
</a>par <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/fr/tags/http2><span class=tag>Http2</span></a></div><div class=control><a href=/fr/tags/microsoft><span class=tag>Microsoft</span></a></div><div class=control><a href=/fr/tags/graph><span class=tag>Graph</span></a></div><div class=control><a href=/fr/tags/msgraph><span class=tag>Msgraph</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=# disabled><span class="icon is-small"><i class="fas fa-chevron-left"></i></span>
<span>Newest</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/installer-le-sdk-dotnet-sous-ubuntu-wsl/><span class="is-hidden-touch is-hidden-desktop-only">Installer le SDK dotnet sous Ubuntu WSL
</span><span class="is-hidden-touch is-hidden-widescreen">Installer le SDK dotnet sous Ubuntu WSL
</span><span class="is-hidden-mobile is-hidden-desktop">Installer le SDK dotnet sous Ubuntu WSL
</span><span class=is-hidden-tablet>Installer le SDK dotnet sous Ubuntu WSL
</span><span class="icon is-small"><i class="fas fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/microsoft-graph-http2/",this.page.identifier=window.location.pathname};(function(){var e=document,t=e.createElement("script");t.src="https://baywet.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/fr/livrer-un-produit-chez-microsoft/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Livrer un produit chez Microsoft: Kiota&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/un-an-developpeur-microsoft/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Un an en tant que développeur chez Microsoft&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/nouveau-job-program-manager-c/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Nouveau Job : Program Manager chez Microsoft sur le Microsoft Graph&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/global-office-365-dev-bootcamp/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Global Office 365 Dev Bootcamp Montreal 2018&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/renouvele-mvp-pour-lannee-2017/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Renouvelé MVP pour l’année 2017-2018&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/nouvelle-conference-microsoft/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Nouvelle conférence Microsoft la AzureCon&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/fin-de-la-gamme-forefront/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Fin de la gamme ForeFront&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/microsoft-student-partner-cana/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Microsoft Student Partner Canada&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/session-aux-microsoft-techdays/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Session aux Microsoft Techdays 2012&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/le-laboratoire-microsoft-aux-t/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Le Laboratoire Microsoft aux TechDays - Venez nous rencontrer&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/les-techdays-2011-cest-bon-ma/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Les Techdays 2011 : C’est bon, Mangez-en!&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/laboratoire-microsoft-repris/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Laboratoire Microsoft - Reprise des publications des articles&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/migrations-du-laboratoire-part-2010-11-22-14-46-00/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Migrations du Laboratoire Partie 3 - FaqXP, BlogSeven et CertifExpress&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/migrations-du-laboratoire-part-2010-11-15-17-06-00/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Migrations du Laboratoire Partie 2 - Forum&nbsp;<div class=tag>Microsoft</div></span></a><a class=panel-block href=https://baywet.github.io/fr/debut-de-la-publication-des-ar/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Début de la publication des articles des membres sur le site du labo&nbsp;<div class=tag>Microsoft</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fas fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/fr><span class=icon><i class="fa fa-home"></i></span>
</a>&nbsp;
<a class=button href><span class=icon><i class="fas fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>