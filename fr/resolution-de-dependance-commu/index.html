<!doctype html><html lang=fr dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Résolution de dépendance communes en développement de solutions full trust SharePoint</title><meta name=author content="Vincent Biret"><meta name=description content="Bonjour à tous,
Chez Negotium technologies nous développons plusieurs produits pour SharePoint. (www.oceanik.com www.theattributesolution.com …)
Un problème assez complexe nous est récemment arrivé...."><meta name=generator content="Hugo 0.74.3"><meta itemprop=name content="Résolution de dépendance communes en développement de solutions full trust SharePoint"><meta itemprop=description content="Bonjour à tous,
Chez Negotium technologies nous développons plusieurs produits pour SharePoint. (www.oceanik.com www.theattributesolution.com …)
Un problème assez complexe nous est récemment arrivé...."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Résolution de dépendance communes en développement de solutions full trust SharePoint"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/fr/resolution-de-dependance-commu/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="Bonjour à tous,
Chez Negotium technologies nous développons plusieurs produits pour SharePoint. (www.oceanik.com www.theattributesolution.com …)
Un problème assez complexe nous est récemment arrivé...."><meta property="og:site_name" content="Le blog de baywet"><meta property="og:updated_time" content="2020-09-09T14:15:55+00:00"><meta property="article:published_time" content="2015-07-18T20:01:51+00:00"><meta property="article:modified_time" content="2020-09-09T14:15:55+00:00"><meta property="article:section" content><meta property="article:tag" content="dependances"><meta property="article:tag" content="solutions"><meta property="article:tag" content="full trust"><meta property="article:tag" content="resiliance"><meta property="article:tag" content="sharepoint"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Résolution de dépendance communes en développement de solutions full trust SharePoint"><meta name=twitter:description content="Bonjour à tous,
Chez Negotium technologies nous développons plusieurs produits pour SharePoint. (www.oceanik.com www.theattributesolution.com …)
Un problème assez complexe nous est récemment arrivé...."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-176061333-1','auto');ga('send','pageview');</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/fr><div class="title is-4">&nbsp;Le blog de baywet</div></a><label class="button navbar-burger is-white" for=navbar-burger-state><span></span><span></span><span></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=https://baywet.github.io/shared-dependencies-resolution/>English</a></div></div></div></nav><section class=section style=flex:1><div class=container><p class=title>Résolution de dépendance communes en développement de solutions full trust SharePoint</p><p class=subtitle>Jul 18, 2015</p><div class=content><p>Bonjour à tous,</p><p>Chez Negotium technologies nous développons plusieurs produits pour SharePoint. (<a href=https://www.oceanik.com/>www.oceanik.com</a> <a href=https://www.theattributesolution.com/>www.theattributesolution.com</a> …)</p><p>Un problème assez complexe nous est récemment arrivé. Imaginez que ces deux produits aient une dépendance commune (newtonsoft.json pour ne pas la nommer). Maintenant imaginez que les deux produits soient installés sur une même ferme SharePoint et que pour une raison quelconque vous vouliez désinstaller uniquement un des produits.</p><p>Quand SharePoint va rétracter le wsp, il va naturellement rétracter toutes les dll’s qui étaient dedans. Y compris la dépendance commune dont l’autre produit a toujours besoin. Ceci va mettre en défaut l’autre produit.</p><p>Un administrateur avisé le remarquera rapidement et effectuera un install-spsolution &lt;nomsolution> -GacDeployment –Local –Force sur chacun des serveurs impactés.</p><p>Cependant tous les clients n’ont pas la chance d’avoir des administrateurs correctement formés sur SharePoint. La question suivante se pose vite : <strong>comment s’assurer que ma solution sera assez résiliante pour se réparer toute seule dans ce genre de cas de figure ?</strong></p><p>Après plusieurs réflexions, il apparait que SharePoint ne possède pas de système complet de <a href=https://fr.wikipedia.org/wiki/D%C3%A9pendance_logicielle>résolution de dépendance</a>. (en fait le problème vient de .NET en général et de Windows).</p><p>Certains développeurs SharePoint chevronnés me diront qu’il existe les <a href=https://msdn.microsoft.com/en-us/library/ff512761.aspx>ActivationDependency</a> pour les solutions. Oui mais cela ne sert qu’au déploiement, rien n’empêche de rétracter une solution dont d’autres dépendent.</p><p>D’autres diront qu’on peut essayer de combler ce manque avec de la dépendance de fonctionnalités, qui elles vérifient les dépendances lors de la désactivation. Non les fonctionnalités sont là pour le provisionnement d’éléments, de plus rien n’empêche techniquement quelqu’un de rétracter une solution qui comporte des fonctionnalités toujours activées (même si c’est très mal de le faire).</p><p>Du coup la seule solution technique pour résoudre ce problème (et j’ai aussi pris le temps d’échanger avec l’équipe produits SharePoint sur le sujet) c’est de faire un timerjob sans aucune dépendance qui va venir vérifier si nos dépendances sont là et si elles sont absentes redéployer les solutions.</p><p><a href=https://github.com/baywet/blogsamples/tree/master/CommonDepedency>Vous trouverez un exemple ici.</a></p><p>Encore une fois, si vous pouvez faire des apps au lieu de solutions full trust, envisagez-le, vous n’aurez pas ce genre de problème ;-)</p><p>PS : je tiens à remercier les gars de mon équipe pour avoir passé du temps à réfléchir sur le sujet à savoir Benoit, Pascal, Yann, Sébastien, Jeff et Jordan.</p></div><br><p class=heading>Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/1f602078aeb3de5976d11c03c39825e54c6066ac>9 Sep 2020</a> par <a href=https://github.com/baywet>Vincent</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/fr/tags/dependances><span class=tag>Dependances</span></a></div><div class=control><a href=/fr/tags/solutions><span class=tag>Solutions</span></a></div><div class=control><a href=/fr/tags/full-trust><span class=tag>Full Trust</span></a></div><div class=control><a href=/fr/tags/resiliance><span class=tag>Resiliance</span></a></div><div class=control><a href=/fr/tags/sharepoint><span class=tag>Sharepoint</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/provisionnement-des-services-c/><span class="icon is-small"><i class="fa fa-chevron-left"></i></span><span class="is-hidden-touch is-hidden-desktop-only">Provisionnement des services customs dans SharePoint</span>
<span class="is-hidden-touch is-hidden-widescreen">Provisionnement des services customs dans SharePoint</span>
<span class="is-hidden-mobile is-hidden-desktop">Provisionnement des services customs dans...</span>
<span class=is-hidden-tablet>Provisionnement des services customs...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/deplacement-des-javascript-des/><span class="is-hidden-touch is-hidden-desktop-only">Déplacement des Javascript des Apps (add-ins) SharePoint</span>
<span class="is-hidden-touch is-hidden-widescreen">Déplacement des Javascript des Apps (add-ins) SharePoint</span>
<span class="is-hidden-mobile is-hidden-desktop">Déplacement des Javascript des Apps (add-ins)...</span>
<span class=is-hidden-tablet>Déplacement des Javascript des Apps...</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/resolution-de-dependance-commu/";this.page.identifier=window.location.pathname;};(function(){var d=document,s=d.createElement('script');s.src='https://baywet.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/fr/deplacement-des-javascript-des/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Déplacement des Javascript des Apps (add-ins) SharePoint&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-sharepoint-sat-2015-05-25-01-12-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Conférencier au SharePoint Saturday New York City 2015&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-sharepoint-sat-2015-05-21-00-49-38/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Conférencier au SharePoint Saturday Montréal 2015&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conferencier-au-spbizconf/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Conférencier au SPBizConf&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/ce-que-jai-retenu-de-lignite-s/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Ce que j’ai retenu de l’ignite (SharePoint)&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/nombre-delements-fournis-pour/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Nombre d’éléments fournis pour la génération des facettes&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/sharepoint-saturday-montreal-2/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>SharePoint Saturday Montréal 2015&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/ignite-annonce-des-conferenci/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Ignite – Annonce des conférenciers et liste complète des sessions&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/participez-a-la-conception-de/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Participez à la conception de SharePoint 2016!&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/evenements-annonce-des-sessi/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Evènements - Annonce des sessions de l’Ignite&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/build-automatise-de-solutions/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Build automatisé de solutions SharePoint (full trust) 2013 – Où sont mes solutions?&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/visual-studio-2013-update-4-et/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Visual Studio 2013 Update 4 et build automatisé de solutions SharePoint (full trust)&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/mise-a-jour-de-novembre-des-ou/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Mise à jour de Novembre des outils développeurs Office&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/build-automatise-de-solution-s/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Build automatisé de solution SharePoint server (fulltrust) avec visual studio online&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/conversion-dun-certificat-prot/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span><span>&nbsp;</span>
<span>Conversion d’un certificat protégé par mot de passe (pfx) en certificat non protégé (snk)&nbsp;<div class=tag>Sharepoint</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/fr><span class=icon><i class="fa fa-home"></i></span></a>&nbsp;
<a class=button href><span class=icon><i class="fa fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>