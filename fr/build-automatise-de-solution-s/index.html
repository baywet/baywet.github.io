<!doctype html><html lang=fr dir=ltr itemscope itemtype=https://schema.org/Article><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Build automatisé de solution SharePoint server (fulltrust) avec visual studio online</title><meta name=author content="Vincent Biret"><meta name=description content="Introduction
Depuis plusieurs articles j’évoque le fait que nous (Negotium, la compagnie où je travaille) avons migré vers visual studio online (TFS Online). Ce service offre une majorité des..."><meta name=generator content="Hugo 0.83.1"><meta itemprop=name content="Build automatisé de solution SharePoint server (fulltrust) avec visual studio online"><meta itemprop=description content="Introduction
Depuis plusieurs articles j’évoque le fait que nous (Negotium, la compagnie où je travaille) avons migré vers visual studio online (TFS Online). Ce service offre une majorité des..."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Build automatisé de solution SharePoint server (fulltrust) avec visual studio online"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/fr/build-automatise-de-solution-s/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="Introduction
Depuis plusieurs articles j’évoque le fait que nous (Negotium, la compagnie où je travaille) avons migré vers visual studio online (TFS Online). Ce service offre une majorité des..."><meta property="og:site_name" content="Le blog de baywet"><meta property="og:updated_time" content="2021-05-12T08:04:46+02:00"><meta property="article:published_time" content="2014-10-29T02:22:08+00:00"><meta property="article:modified_time" content="2021-05-12T08:04:46+02:00"><meta property="article:section" content><meta property="article:tag" content="build"><meta property="article:tag" content="alm"><meta property="article:tag" content="visual studio"><meta property="article:tag" content="sharepoint"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Build automatisé de solution SharePoint server (fulltrust) avec visual studio online"><meta name=twitter:description content="Introduction
Depuis plusieurs articles j’évoque le fait que nous (Negotium, la compagnie où je travaille) avons migré vers visual studio online (TFS Online). Ce service offre une majorité des..."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-176061333-1','auto'),ga('send','pageview')</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/fr><div class="title is-4">&nbsp;Le blog de baywet</div></a><label class="button navbar-burger is-white" for=navbar-burger-state><span></span><span></span><span></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=https://baywet.github.io/automated-build-for-sharepoint-2014-10-29-02-22-54/>English</a></div></div></div></nav><section class=section style=flex:1><div class=container><h1 class=title>Build automatisé de solution SharePoint server (fulltrust) avec visual studio online</h1><p class=subtitle>Oct 29, 2014</p><div class=content><h2 id=introduction>Introduction</h2><p>Depuis plusieurs articles j’évoque le fait que nous (Negotium, la compagnie où je travaille) avons migré vers visual studio online (TFS Online). Ce service offre une <strong>majorité des fonctionnalités offertes par la version on premises de Team Foundation Server 2013 et même certaines fonctionnalités exclusives.</strong></p><p>Si vous n’avez qu’une vague idée de ce que peut faire TFS2013/VSO et que vous voulez en apprendre plus je vous recommande très fortement <a href="https://www.amazon.ca/Professional-Application-Lifecycle-Management-Visual/dp/1118836588/ref=sr_1_1?ie=UTF8&qid=1412643305&sr=8-1&keywords=professional+application+lifecycle">Professional Application Lifecycle Management</a> de chez Wrox.</p><h2 id=les-grands-axes-de-visual-studio-online>Les grands axes de Visual Studio Online</h2><p>De manière générale TFS2013/VSO s’articule et intègre fortement les uns avec les autres les axes suivants :</p><ul><li>Planification : Permet de planifier le travail à effectuer (agile ou cascade,&mldr;), suivre l’avancement, voir l’évolution de la capacité de travail&mldr;</li><li>Code : Permet de centraliser le code, suivre l’évolution du code, tout ce que faire un contrôle de code source digne de ce nom de manière générale.</li><li>Compilation : Permet de générer des versions compilées et versionées du code, suivies, avec un résumé des changements.</li><li>Tests : Permet de s’assurer de la qualité des versions en exécutant des tests unitaires, des déploiements, des tests fonctionnels automatisés ou non.</li></ul><h2 id=méthodologie-de-mise-en-place>Méthodologie de mise en place</h2><p>Bien évidement tous ces éléments sont liés les uns aux autres ce qui permets des scénarios du genre « tel test automatisé utilise telle portion du code et a planté, remontée des rapports et des traces au développeur concerné et ajout des éléments pour suivre la correction du bug ».</p><p>Quand on commence à apprendre comment fonctionne cette industrie logicielle on s’aperçoit qu’il faut <strong>mettre les choses en place dans un certain ordre</strong>. En Juillet nous avons migré notre code existant (ok pas dans l’ordre mais dû à la migration), tout de suite après ça nous avons reconsolidé nos backlogs et réorganisé les équipes en scrum. Nous étions déjà en scrum par le passé mais suite à de nombreux mouvements d’équipes, la méthodologie s’était un peu relâchée.</p><h2 id=compilation-automatisée--avantages>Compilation automatisée – avantages</h2><p>L’étape suivante était donc la mise en place de compilation automatisée avec les objectifs principaux suivants :</p><ul><li>Suivit, versionnement et constitution de notes de versions des livrables (déjà fait mais à la main)</li><li>Avancer vers la mise en place de tests automatisés</li><li>Gain de temps</li></ul><h2 id=les-options-avec-visual-studio-online>Les options avec Visual Studio Online</h2><p>Vous avez deux possibilités pour effectuer de la compilation automatisée avec Visual Studio Online :</p><ul><li>Utiliser le service de build préconfiguré en ligne</li><li>Configurer votre propre machine et la connecter au service</li></ul><p>L’avantage évident du service de build hébergé c’est de <strong>ne pas avoir à passer du temps en configuration de l’environnement</strong> et de ne <strong>payer que pour les minutes de compilation</strong> que vous consommez et non pour le reste du temps où la machine serait inutilisée.</p><p>Si l’on se fie à cette page <a href=https://www.visualstudio.com/en-us/get-started/hosted-build-controller-vs.aspx#software>https://www.visualstudio.com/en-us/get-started/hosted-build-controller-vs.aspx#software</a> il est <strong>indiqué que SharePoint 2010 et 2013</strong> (ainsi que de nombreux autres composants) sont <strong>installés sur les environnements</strong> de build fournis par Visual Studio Online. J’ai donc naturellement commencé à configurer mon plan de build pour utiliser ce service.</p><p>Cependant ce qui n’est pas préciser c’est que <strong>l’édition de SharePoint installée est Foundation</strong>. Mon projet se basant sur certains des dll’s de l’édition Server (publication, traduction…) deux choix s’offraient à moi :</p><ul><li>Embarquer une copie locale des dll’s manquantes sur mon contrôle de code source</li><li>Monter ma machine de build</li></ul><p>Il est évident qu’embarquer les dll’s manquantes va nettement alourdir le poids des sources, risque de causer des conflits et nécessitera de les mettre à jour régulièrement. Je me suis donc tourné vers la seconde option.</p><h2 id=configurer-sa-machine-de-build-pour-sharepoint-server-2013-full-trust>Configurer sa machine de build pour SharePoint Server 2013 (full trust)</h2><p>Les étapes de configuration de la machine de build ne sont pas si compliquées que ça ce que j’ai eu à faire :</p><ul><li>Installer SharePoint server 2013 (uniquement les binaires, pas de psconfig à passer)</li><li>Installer Visual Studio 2013</li><li>Installer les Office dev tools (depuis web platform installer)</li><li>Installer le contrôleur et l’agent de build TFS, puis le connecter à mon visual studio online (<a href=https://msdn.microsoft.com/en-US/library/ms181712#deploy>https://msdn.microsoft.com/en-US/library/ms181712#deploy</a> )</li></ul><h2 id=première-erreur-version-passée-par-msbuild>Première erreur : version passée par MSBuild</h2><p>Une fois terminé j’ai eu le droit à un beau message d’erreur de ce genre : cannot find build process template for project type SharePoint…</p><p>Ceci est dû au fait que pour je ne sais quelle raison, le framework MSBuild (c’est la technologie qui gère le processus de build) estime que c’est la version 11 (2012) de visual studio qu’il faut utiliser. Cela ne correspond pas à la version de visual studio et des outils de développement Office installés.</p><p>Pour fixer ce problème il suffit d’éditer la définition de build, dans l’onglet process, puis avancé, puis spécifier /p:VisualStudioVersion=12.0 pour MS Build Arguments.</p><h2 id=seconde-erreur-version-du-tooling-sharepoint>Seconde erreur : Version du tooling SharePoint</h2><p>Une fois que c’est fait, une autre erreur, principalement liée au même problème : avec l’arrivée de la nouvelle version de workflows, les process templates de workflows traditionnels ont été déplacés mais les références pas mises à jour. Je suis d’ailleurs surpris que 2 ans après la sortie des première versions des outils cela n’ait toujours pas été corrigé.</p><p>Commencez par faire un backup du fichier C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v12.0\SharePointTools\Microsoft.VisualStudio.SharePoint.Workflow.targets puis éditez le.</p><p>Au lignes 37 et 38 remplacez</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#f92672>&lt;Import</span> <span style=color:#a6e22e>Condition=</span><span style=color:#e6db74>&#34;&#39;$(Language)&#39; == &#39;C#&#39;&#34;</span> <span style=color:#a6e22e>Project=</span><span style=color:#e6db74>&#34;$(MSBuildFrameworkToolsPath)\Workflow.Targets&#34;</span> <span style=color:#f92672>/&gt;</span>

<span style=color:#f92672>&lt;Import</span> <span style=color:#a6e22e>Condition=</span><span style=color:#e6db74>&#34;&#39;$(Language)&#39; == &#39;VB&#39;&#34;</span> <span style=color:#a6e22e>Project=</span><span style=color:#e6db74>&#34;$(MSBuildFrameworkToolsPath)\Workflow.VisualBasic.targets&#34;</span> <span style=color:#f92672>/&gt;</span>
</code></pre></div><p>Par</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#f92672>&lt;Import</span> <span style=color:#a6e22e>Condition=</span><span style=color:#e6db74>&#34;&#39;$(Language)&#39; == &#39;C#&#39;&#34;</span> <span style=color:#a6e22e>Project=</span><span style=color:#e6db74>&#34;$(MSBuildFrameworkToolsPath)\Microsoft\Windows Workflow Foundation\v3.5\Workflow.Targets&#34;</span> <span style=color:#f92672>/&gt;</span>

<span style=color:#f92672>&lt;Import</span> <span style=color:#a6e22e>Condition=</span><span style=color:#e6db74>&#34;&#39;$(Language)&#39; == &#39;VB&#39;&#34;</span> <span style=color:#a6e22e>Project=</span><span style=color:#e6db74>&#34;$(MSBuildFrameworkToolsPath)\Microsoft\Windows Workflow Foundation\v3.5\Workflow.VisualBasic.targets&#34;</span> <span style=color:#f92672>/&gt;</span>
</code></pre></div><h2 id=mot-de-la-fin>Mot de la fin</h2><p>Et voilà! Maintenant les builds automatisés de projets full trust pour SharePoint Server 2013 sont en place. A noter que c’est valable pour Team Foundation Server 2013 comme pour Visual Studio Online. Aussi ma machine de build est hébergée dans Azure mais qu’elle pourrait l’être on prem dans les deux cas de figure.</p><p>La prochaine fois je vous parlerai probablement d’incrémentation des numéros de version des assemblies et/ou de scripts pré/post build puisque ce sont les deux éléments qui me manquent avant de pouvoir commencer à mettre en place du test automatisé.</p></div><br><p class=heading>Edité la dernière fois le
<a href=https://github.com/baywet/blogsource/commit/100173b5fbb365c93c7d1696742555fac7c2fbc7>12 May 2021</a> par <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/fr/tags/build><span class=tag>Build</span></a></div><div class=control><a href=/fr/tags/alm><span class=tag>Alm</span></a></div><div class=control><a href=/fr/tags/visual-studio><span class=tag>Visual Studio</span></a></div><div class=control><a href=/fr/tags/sharepoint><span class=tag>Sharepoint</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/mise-a-jour-de-novembre-des-ou/><span class="icon is-small"><i class="fa fa-chevron-left"></i></span>
<span class="is-hidden-touch is-hidden-desktop-only">Mise à jour de Novembre des outils développeurs Office</span>
<span class="is-hidden-touch is-hidden-widescreen">Mise à jour de Novembre des outils développeurs Office</span>
<span class="is-hidden-mobile is-hidden-desktop">Mise à jour de Novembre des outils développeurs...</span>
<span class=is-hidden-tablet>Mise à jour de Novembre des outils...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/fr/conversion-dun-certificat-prot/><span class="is-hidden-touch is-hidden-desktop-only">Conversion d’un certificat protégé par mot de passe (pfx) en certificat non protégé (snk)</span>
<span class="is-hidden-touch is-hidden-widescreen">Conversion d’un certificat protégé par mot de passe (pfx) en certificat non...</span>
<span class="is-hidden-mobile is-hidden-desktop">Conversion d’un certificat protégé par mot de...</span>
<span class=is-hidden-tablet>Conversion d’un certificat protégé par...</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/fr/build-automatise-de-solution-s/",this.page.identifier=window.location.pathname};(function(){var a=document,b=a.createElement('script');b.src='https://baywet.disqus.com/embed.js',b.setAttribute('data-timestamp',+new Date),(a.head||a.body).appendChild(b)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/fr/conversion-dun-certificat-prot/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Conversion d’un certificat protégé par mot de passe (pfx) en certificat non protégé (snk)&nbsp;<div class=tag>Build</div><div class=tag>Alm</div><div class=tag>Visual Studio</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/localisation-du-javascript-dun/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Localisation du JavaScript d’une solution Full Trust&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/pourquoi-ne-pas-inclure-de-con/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Pourquoi ne pas inclure de contrôles télérik dans vos produits SharePoint ?&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/changement-dans-le-cycle-de-li/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Changement dans le cycle de livraison des CU pour SharePoint&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/ayez-tous-les-outils-dune-star/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Ayez tous les outils d’une startup de première classe en 10 min&nbsp;<div class=tag>Visual Studio</div></span></a><a class=panel-block href=https://baywet.github.io/fr/migration-team-foundation-serv/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Migration Team Foundation Server 2010 vers Visual Studio Online : différence de modèle de processus&nbsp;<div class=tag>Visual Studio</div></span></a><a class=panel-block href=https://baywet.github.io/fr/office-365-mise-a-disposition/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Office 365 mise à disposition de la roadmap&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/selectionne-pour-le-sharepoint/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Sélectionné pour le SharePoint Saturday New York City !&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/depreciation-des-apps-auto-heb/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Dépréciation des Apps Auto-hébergées&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/petit-msp-devient-grand-mvp/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Petit MSP devient grand MVP&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/remise-a-disposition-du-sp1-po/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Remise à disposition du SP1 pour SharePoint 2013&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/retrait-du-sp1-de-sp2013-sp1/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Retrait du SP1 de SP2013 / SP1 for SP2013 not available anymore&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/donnez-votre-avis-sur-le-rempl/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Donnez votre avis sur le remplaçant d’infopath !&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/les-annonces-marquantes-de-la/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Les annonces marquantes de la SharePoint Conference 2014 pour Office 365&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/fr/webcast-pour-les-itpros-sur-of/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Webcast pour les ITPros sur Office 365&nbsp;<div class=tag>Sharepoint</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/fr><span class=icon><i class="fa fa-home"></i></span></a> &nbsp;
<a class=button href><span class=icon><i class="fa fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>