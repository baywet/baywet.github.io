<!doctype html><html lang=en dir=ltr itemscope itemtype=https://schema.org/Article><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Managing Resources, how to make your SharePoint solutions “globally deployed”</title><meta name=author content="Vincent Biret"><meta name=description content="
Introduction
I wanted to publish this article months ago, back to the time I found this solution. But I did not mostly because of a lack of free time. Sebastien LEVERT, a top SharePoint developer and..."><meta name=generator content="Hugo 0.111.3"><meta itemprop=name content="Managing Resources, how to make your SharePoint solutions “globally deployed”"><meta itemprop=description content="
Introduction
I wanted to publish this article months ago, back to the time I found this solution. But I did not mostly because of a lack of free time. Sebastien LEVERT, a top SharePoint developer and..."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Managing Resources, how to make your SharePoint solutions “globally deployed”"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/managing-resources-how-to-make/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="
Introduction
I wanted to publish this article months ago, back to the time I found this solution. But I did not mostly because of a lack of free time. Sebastien LEVERT, a top SharePoint developer and..."><meta property="og:site_name" content="Baywet's blog"><meta property="og:updated_time" content="2023-04-07T15:30:25-04:00"><meta property="article:published_time" content="2014-01-23T03:39:00+00:00"><meta property="article:modified_time" content="2023-04-07T15:30:25-04:00"><meta property="article:section" content><meta property="article:tag" content="2013"><meta property="article:tag" content="dev"><meta property="article:tag" content="multilingual"><meta property="article:tag" content="resources"><meta property="article:tag" content="solution"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Managing Resources, how to make your SharePoint solutions “globally deployed”"><meta name=twitter:description content="
Introduction
I wanted to publish this article months ago, back to the time I found this solution. But I did not mostly because of a lack of free time. Sebastien LEVERT, a top SharePoint developer and..."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-176061333-1","auto"),ga("send","pageview")</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/en><div class="title is-4">&nbsp;Baywet's blog</div></a><label class="button navbar-burger is-white" for=navbar-burger-state><span></span>
<span></span>
<span></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=https://baywet.github.io/fr/gestion-des-ressources-rendre/>Français</a></div></div></div></nav><section class=section style=flex:1><div class=container><h1 class=title>Managing Resources, how to make your SharePoint solutions “globally deployed”</h1><p class=subtitle>Jan 23, 2014</p><div class=content><h3 id=clip_5f00_image002_5f00_thumb_5f00_0fecb56fjpgclip_5f00_image002_5f00_thumb_5f00_0fecb56fjpg><img src=./clip_5F00_image002_5F00_thumb_5F00_0FECB56F.jpg alt=clip_5F00_image002_5F00_thumb_5F00_0FECB56F.jpg></h3><h2 id=introduction>Introduction</h2><p>I wanted to publish this article months ago, back to the time I found this solution. But I did not mostly because of a lack of free time. Sebastien LEVERT, a top SharePoint developer and a member of Montreal’s SharePoint community, recently published a post about the same subject. Read it (sorry it’s in French), I’ll write my post so it is complementary. <a href=https://www.pimpmysharepoint.com/2014/01/09/deployer-des-fichiers-de-ressources-simplement/>https://www.pimpmysharepoint.com/2014/01/09/deployer-des-fichiers-de-ressources-simplement/</a></p><h2 id=reminders>Reminders</h2><p>To quickly summarize, when you develop SharePoint solutions and you want to support multiple languages (localize it) you need to use .net resources. These resx files are a mechanism coming from asp.net and work as a dictionary (key/value). You have to create one file by supported language. Instead of writing texts in the code (which is a bad practice anyway), you now reference these by defined keys.</p><p>Due to certain technical constraints SharePoint has two main deployment locations:</p><ul><li><p>Hive\config\resources: for texts used in web pages, user controls etc</p></li><li><p>Hive\resources: for texts used in workflows, timerjobs, etc (the “hidden” part of the solution)</p></li></ul><p>SharePoint also has two other locations related to previous ones:</p><ul><li><p>Hive\admin\resources: for central administration web site.</p></li><li><p>App_GlobalResources: in each web application, is a copy of hive\config\resources (you can trigger the copy with command stsadm –o copyappbincontent)</p></li></ul><p>You can deploy your “web” resources directly to App_GlobalResources directory. It saves administrative work ofr our itpro’s when deploying the solution. Sébastien explains that in his blog, he also explains a method to deploy the same resource file to App_GlobalResources and hive\resources. It allows you to use your resources files in a simpler way from every part of your solution (in your timerjobs and/or in your application pages for example). Indeed if often comes to a situation where you need to use the same string at multiple places, forcing you to make copies. Sebastien’s solution is a good trick and I recommend it unless you have the same constraint I’m going to explain right after.</p><h2 id=context>Context</h2><p>I’ve recently been involved in a SharePoint product development. This products adds a new service application and a new service to SharePoint. During tests preceding RTM, I wanted to try something: run the service on an applicative server.</p><p>Indeed, this is a prevalent case for medium/big sized SharePoint farms: part of the servers is dedicated handling users’ requests (web front ends) and another part to heavy workload, apps servers.</p><p>We were surprised to discover that our solutions containing resources directly deployed to App_GlobalResources were only deployed to WFE’s: servers with Microsoft SharePoint Web Foundation service enabled. That caused our dll’s not to be deployed to apps servers and the service wasn’t starting properly.</p><h2 id=solution>Solution</h2><p>I had to find a way to be able to use resources within pages without deploying files to App_GlobalResources.</p><p>First part of the solution came from this codeplex project <a href=https://spexpressions.codeplex.com/>https://spexpressions.codeplex.com/</a> which allows developers/integrators to use more SharePoint context variables inside pages.</p><p>Here is the solution:</p><ul><li><p>A few entries in web.config to tell IIS there is a new expression to interpret</p></li><li><p>A class to treat this new expression</p></li><li><p>A feature to add/delete these entries to web.config</p></li><li><p>Resources files deployed to hive\resources</p></li></ul><p>As always I’m providing you a downloadable example attached to this post.</p><p>Advantages of this method:</p><ul><li><p>Only one file deployed</p></li><li><p>Your solutions are deployed globally (except if something else forces it to deploy per web application)</p></li></ul><p>Disadvantages:</p><ul><li>More complex</li></ul><p><img src=./clip_5F00_image004_5F00_thumb_5F00_33A86DBA.jpg alt=clip_5F00_image004_5F00_thumb_5F00_33A86DBA.jpg></p><p>Note: the solution I’m providing is for SharePoint 2010, but it works just fine for 2013, our product is on both versions.</p></div><br><p class=heading>Last edited
<a href=https://github.com/baywet/blogsource/commit/605e3673b260df245d78622a6b90ac6850f55219>Apr 7, 2023</a> by <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/tags/2013><span class=tag>2013th</span></a></div><div class=control><a href=/tags/dev><span class=tag>Dev</span></a></div><div class=control><a href=/tags/multilingual><span class=tag>Multilingual</span></a></div><div class=control><a href=/tags/resources><span class=tag>Resources</span></a></div><div class=control><a href=/tags/solution><span class=tag>Solution</span></a></div><div class=control><a href=/tags/developer><span class=tag>Developer</span></a></div><div class=control><a href=/tags/deployment><span class=tag>Deployment</span></a></div><div class=control><a href=/tags/2010><span class=tag>2010th</span></a></div><div class=control><a href=/tags/sharepoint><span class=tag>Sharepoint</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/march-update-of-visual-studio/><span class="icon is-small"><i class="fa fa-chevron-left"></i></span>
<span class="is-hidden-touch is-hidden-desktop-only">March Update of Visual Studio tools for Office</span>
<span class="is-hidden-touch is-hidden-widescreen">March Update of Visual Studio tools for Office</span>
<span class="is-hidden-mobile is-hidden-desktop">March Update of Visual Studio tools for Office</span>
<span class=is-hidden-tablet>March Update of Visual Studio tools for...</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/help-me-to-speak-at-sp24-the-f/><span class="is-hidden-touch is-hidden-desktop-only">Help me to speak at SP24 the first SharePoint (web) conference all around the world!</span>
<span class="is-hidden-touch is-hidden-widescreen">Help me to speak at SP24 the first SharePoint (web) conference all around...</span>
<span class="is-hidden-mobile is-hidden-desktop">Help me to speak at SP24 the first SharePoint...</span>
<span class=is-hidden-tablet>Help me to speak at SP24 the first...</span>
<span class="icon is-small"><i class="fa fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/managing-resources-how-to-make/",this.page.identifier=window.location.pathname};(function(){var e=document,t=e.createElement("script");t.src="https://baywet.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/help-me-to-speak-at-sp24-the-f/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Help me to speak at SP24 the first SharePoint (web) conference all around the world!&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/boost-your-sharepoint-solution-2013-12-15-12-06-00/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Boost your SharePoint solutions with distributed cache!–Part 2–Explanations tips and warnings&nbsp;<div class=tag>2013th</div><div class=tag>Dev</div><div class=tag>Developer</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/boost-your-sharepoint-solution-2013-12-13-02-35-30/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Boost your SharePoint solutions with distributed cache!- Part 1–Introduction&nbsp;<div class=tag>2013th</div><div class=tag>Developer</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/sharepoint-auto-hosted-app-and/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>SharePoint Auto hosted app and ASP.NET MVC&nbsp;<div class=tag>2013th</div><div class=tag>Dev</div><div class=tag>Developer</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/entity-framework-and-dataconte/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Entity Framework and dataContext reference for a web application&nbsp;<div class=tag>Dev</div><div class=tag>Developer</div></span></a><a class=panel-block href=https://baywet.github.io/speaker-at-sharepoint-saturday/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Speaker at SharePoint Saturday Ottawa!&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/the-name-initializecon/><span class="icon is-small"><i class="fa fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>(English) The name 'InitializeControl' does not exist in the current context Controles utilisateur, SharePoint 2013 and Ressources&nbsp;<div class=tag>2013th</div><div class=tag>Resources</div><div class=tag>Sharepoint</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fa fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/en><span class=icon><i class="fa fa-home"></i></span></a> &nbsp;
<a class=button href><span class=icon><i class="fa fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>