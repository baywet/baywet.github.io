<!doctype html><html lang=en dir=ltr itemscope itemtype=https://schema.org/Article><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Automated build for SharePoint server (fulltrust) solutions with visual studio online</title>
<meta name=author content="Vincent Biret"><meta name=description content="Introduction
It has been a few articles I’ve been mentioning the fact that we (Negotium, the company I work for) have migrated to visual studio online (TFS Online). This service offers most of the..."><meta name=generator content="Hugo 0.124.1"><meta itemprop=name content="Automated build for SharePoint server (fulltrust) solutions with visual studio online"><meta itemprop=description content="Introduction
It has been a few articles I’ve been mentioning the fact that we (Negotium, the company I work for) have migrated to visual studio online (TFS Online). This service offers most of the..."><meta itemprop=image content="/img/logo.svg"><meta property="og:title" content="Automated build for SharePoint server (fulltrust) solutions with visual studio online"><meta property="og:type" content="article"><meta property="og:url" content="https://baywet.github.io/automated-build-for-sharepoint-2014-10-29-02-22-54/"><meta property="og:image" content="/img/logo.svg"><meta property="og:description" content="Introduction
It has been a few articles I’ve been mentioning the fact that we (Negotium, the company I work for) have migrated to visual studio online (TFS Online). This service offers most of the..."><meta property="og:site_name" content="Baywet's blog"><meta property="og:updated_time" content="2024-04-15T10:13:42-04:00"><meta property="article:published_time" content="2014-10-29T02:22:54+00:00"><meta property="article:modified_time" content="2024-04-15T10:13:42-04:00"><meta property="article:section" content><meta property="article:tag" content="build"><meta property="article:tag" content="alm"><meta property="article:tag" content="visual studio"><meta property="article:tag" content="sharepoint"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:title content="Automated build for SharePoint server (fulltrust) solutions with visual studio online"><meta name=twitter:description content="Introduction
It has been a few articles I’ve been mentioning the fact that we (Negotium, the company I work for) have migrated to visual studio online (TFS Online). This service offers most of the..."><meta name=twitter:creator content><meta name=twitter:image:src content="/img/logo.svg"><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/js/all.js integrity=sha384-IkmLcEDxkvCioiswmdraONwAU9uwbPWUbvuHAGrejK3zNlL74FCwCjvnTGJcrdbQ crossorigin=anonymous></script><link rel=stylesheet type=text/css href=/css/capsule.min.css><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-176061333-1","auto"),ga("send","pageview")</script><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=icon href=/img/favicon.ico></head><body style=min-height:100vh;display:flex;flex-direction:column><nav class="navbar has-shadow is-white" role=navigation aria-label="main navigation"><div class=container><div class=navbar-brand><a class=navbar-item href=/><div class="title is-4">&nbsp;Baywet's blog</div></a><label role=button class="navbar-burger has-text-dark" aria-label=menu aria-expanded=false for=navbar-burger-state><span aria-hidden=true></span>
<span aria-hidden=true></span>
<span aria-hidden=true></span></label></div><input type=checkbox id=navbar-burger-state><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=https://baywet.github.io/fr/build-automatise-de-solution-s/>Français</a></div></div></div></nav><section class=section style=flex:1><div class=container><h1 class=title>Automated build for SharePoint server (fulltrust) solutions with visual studio online</h1><p class=subtitle>Oct 29, 2014</p><div class=content><h2 id=introduction>Introduction</h2><p>It has been a few articles I’ve been mentioning the fact that we (Negotium, the company I work for) have migrated to visual studio online (TFS Online). <strong>This service offers most of the features offered by the on premises version of Team Foundation Server 2013 and even some exclusive features</strong>.</p><p>If you have only a vague idea of what can do TFS2013/VSO and you want to learn more I very highly recommend <a href="https://www.amazon.ca/Professional-Application-Lifecycle-Management-Visual/dp/1118836588/ref=sr_1_1?ie=UTF8&qid=1412643305&sr=8-1&keywords=professional+application+lifecycle">Professional Application Lifecycle Management</a> from Wrox.</p><h2 id=the-main-parts-of-visual-studio-online>The main parts of Visual Studio Online</h2><p>TFS2013/VSO is divided in the strongly integrated with each other following parts:</p><ul><li>Work (understand plan): Allows you to schedule the work to be performed (agile or waterfall,&mldr;), track the progress, see the evolution of the delivery capacity&mldr;</li><li>Code: Allows to centralize the code, follow the evolution of the code, everything that makes a great source control.</li><li>Build: Generate compiled and versioned versions of code, tracked, with a changelog.</li><li>Test: Ensures the quality of versions by running unit tests, deployments, functional tests automated or not.</li></ul><h2 id=how-to-set-up-everything>How to set up everything?</h2><p>Of course all these elements are related to each other which allows scenarios like “such automated test uses this portion of the code and has crashed, send reports and traces to the concerned developer and add elements to track the progress of the bug fix”.</p><p>When we begin to learn how this software factory works one realizes the need to <strong>implement things in a certain order</strong>. In July we migrated our existing code (ok not in order but it’s due to migration), immediately after that we reconsolidated our backlogs and reorganized the scrum teams. We were already using scrum in the past but following numerous movements of teams, the methodology was just not very well applied.</p><h2 id=automated-build---benefits>Automated build - benefits</h2><p>The next step was the establishment of automated build with the following main objectives:</p><ul><li>Tracked, versioning and change notes of releases (already done but manually)</li><li>Progress towards the implementation of automated tests</li><li>Save Time</li></ul><h2 id=choices-you-have-with-visual-studio-online>Choices you have with Visual Studio Online</h2><p>You have two possibilities to perform automated builds with Visual Studio Online:</p><ul><li>Use the preconfigured online build service (hosted build)</li><li>Setup your own machine and connect it to the service</li></ul><p>The obvious advantage of hosted build service is <strong>not having to spend time in configuration of the environment</strong> and <strong>paying only for the build time that you use</strong> and not for the rest of the time where the machine would be unused.</p><p>According to this page <a href=https://www.visualstudio.com/en-us/get-started/hosted-build-controller-vs.aspx#software>https://www.VisualStudio.com/en-us/get-started/hosted-build-controller-vs.aspx#software</a> <strong>SharePoint 2010 and 2013</strong> (as well as many other components) <strong>are installed on the hosted build</strong> <strong>environments</strong> provided by Visual Studio Online. So I naturally started to configure my build plan using this service.</p><p>However what is not clear it is that <strong>installed SharePoint edition is Foundation</strong>. My project being based on some of the dll&rsquo;s of the Server edition (publication, translation&mldr;) two choices were available to me:</p><ul><li>Including a local copy of the missing dll&rsquo;s in my source code control</li><li>Set up my build machine</li></ul><p>It is obvious that including the missing dll&rsquo;s will clearly increase the weight of source code, may cause conflicts and will require updating them regularly. I therefore chose the second option.</p><h2 id=configure-build-machine-for-sharepoint-server-2013-full-trust>Configure build machine for SharePoint Server 2013 (full trust)</h2><p>The build machine setup steps are not so complicated that what I had to do:</p><ul><li>Install SharePoint server 2013 (only the binary, not psconfig to pass)</li><li>Install Visual Studio 2013</li><li>Install the Office dev tools (from web platform installer)</li><li>Install the TFS build agent and controller, then connect it to my visual studio online (<a href=https://msdn.microsoft.com/en-US/library/ms181712#deploy>https://msdn.microsoft.com/en-US/library/ms181712#deploy</a> ) )</li></ul><h2 id=first-error-version-msbuild-is-using>First error: version MSBuild is using</h2><p>Once finished I had the privilege to get this beautiful error message: cannot find build process template for project type SharePoint&mldr;</p><p>This is due to the fact that for some reason, MSBuild framework (this is the technology that runs the build process) believes that it has to use version 11 (2012) of Visual studio. This does not match the installed versions of visual studio and Office development tools.</p><p>To fix this problem simply edit build definition, on the process tab, click on advanced, and then specify /p:VisualStudioVersion=12.0 for MS Build Arguments.</p><h2 id=second-error-version-of-the-sharepoint-tooling>Second error: Version of the SharePoint tooling</h2><p>Once this is done, you’ll get another error, which is mainly related to the same problem: with the new version of workflows, process templates of traditional workflows have been moved but the references were not updated. I am also surprised that 2 years after the first releases of the tools, this still hasn’t been fixed.</p><p>Start by making a backup of the file C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v12.0\SharePointTools\Microsoft.VisualStudio.SharePoint.Workflow.targets and then edit it.</p><p>Replace lines 37 and 38</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;Import</span> <span style=color:#a6e22e>Condition=</span><span style=color:#e6db74>&#34;&#39;$(Language)&#39; == &#39;C#&#39;&#34;</span> <span style=color:#a6e22e>Project=</span><span style=color:#e6db74>&#34;$(MSBuildFrameworkToolsPath)\Workflow.Targets&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;Import</span> <span style=color:#a6e22e>Condition=</span><span style=color:#e6db74>&#34;&#39;$(Language)&#39; == &#39;VB&#39;&#34;</span> <span style=color:#a6e22e>Project=</span><span style=color:#e6db74>&#34;$(MSBuildFrameworkToolsPath)\Workflow.VisualBasic.targets&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span></code></pre></div><p>By</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;Import</span> <span style=color:#a6e22e>Condition=</span><span style=color:#e6db74>&#34;&#39;$(Language)&#39; == &#39;C#&#39;&#34;</span> <span style=color:#a6e22e>Project=</span><span style=color:#e6db74>&#34;$(MSBuildFrameworkToolsPath)\Microsoft\Windows Workflow Foundation\v3.5\Workflow.Targets&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;Import</span> <span style=color:#a6e22e>Condition=</span><span style=color:#e6db74>&#34;&#39;$(Language)&#39; == &#39;VB&#39;&#34;</span> <span style=color:#a6e22e>Project=</span><span style=color:#e6db74>&#34;$(MSBuildFrameworkToolsPath)\Microsoft\Windows Workflow Foundation\v3.5\Workflow.VisualBasic.targets&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span></code></pre></div><h2 id=conclusion>Conclusion</h2><p>Et voila! Now automated builds of SharePoint Server 2013 full trust projects are set up. Note that this works for Team Foundation Server 2013 as well as for Visual Studio Online. Also, my build machine is hosted on Azure but it could be on prem too.</p><p>Next time I&rsquo;ll probably be writing about assemblies version numbers increment and/or pre/post build scripts since these are the two elements that I’m me before being able to implement automated test.</p></div><br><p class=heading>Last edited
<a href=https://github.com/baywet/blogsource/commit/f9e991747e54c1ef20df74731781a7d829a3984e>Apr 15, 2024
</a>by <a href=https://github.com/baywet>Vincent Biret</a></p><br><div class=heading>Tags:</div><div class="field is-grouped is-grouped-multiline"><div class=control><a href=/tags/build><span class=tag>Build</span></a></div><div class=control><a href=/tags/alm><span class=tag>Alm</span></a></div><div class=control><a href=/tags/visual-studio><span class=tag>Visual Studio</span></a></div><div class=control><a href=/tags/sharepoint><span class=tag>Sharepoint</span></a></div></div></div></section><section class=section><div class=container><div class=level><div class=level-left><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/presenting-at-the-mvp-showcase/><span class="icon is-small"><i class="fas fa-chevron-left"></i></span>
<span class="is-hidden-touch is-hidden-desktop-only">Presenting at the MVP Showcase 2014
</span><span class="is-hidden-touch is-hidden-widescreen">Presenting at the MVP Showcase 2014
</span><span class="is-hidden-mobile is-hidden-desktop">Presenting at the MVP Showcase 2014
</span><span class=is-hidden-tablet>Presenting at the MVP Showcase 2014</span></a></p></div></div><div class=level-right><div class=level-item><p class="control has-addons"><a class=button href=https://baywet.github.io/qampa-with-the-sharepoint-mvp/><span class="is-hidden-touch is-hidden-desktop-only">Q&amp;A with the SharePoint MVP Experts Chat On Oct 29th @1pm EST or 10am PDT
</span><span class="is-hidden-touch is-hidden-widescreen">Q&amp;A with the SharePoint MVP Experts Chat On Oct 29th @1pm EST or 10am PDT
</span><span class="is-hidden-mobile is-hidden-desktop">Q&amp;A with the SharePoint MVP Experts Chat On Oct...
</span><span class=is-hidden-tablet>Q&amp;A with the SharePoint MVP Experts Chat...
</span><span class="icon is-small"><i class="fas fa-chevron-right"></i></span></a></p></div></div></div></div><br><br><div class=container><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://baywet.github.io/automated-build-for-sharepoint-2014-10-29-02-22-54/",this.page.identifier=window.location.pathname};(function(){var e=document,t=e.createElement("script");t.src="https://baywet.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><br><div class=container><nav class=panel><p class=panel-heading>Related</p><a class=panel-block href=https://baywet.github.io/qampa-with-the-sharepoint-mvp/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Q&amp;A with the SharePoint MVP Experts Chat On Oct 29th @1pm EST or 10am PDT&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/speaking-at-the-sharepoint-sat-2014-10-08-23-40-00/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Speaking at the SharePoint Saturday Ottawa 2014 !&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/converting-a-protected-by-pass/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Converting a protected by password certificate (pfx) to an unprotected one (snk)&nbsp;<div class=tag>Build</div><div class=tag>Alm</div><div class=tag>Visual Studio</div><div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/speaking-at-the-sharepoint-sat-2014-10-01-23-34-03/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Speaking at the SharePoint Saturday New Hampshire 2014 !&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/localizing-javascript-of-a-ful/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Localizing JavaScript of a Full Trust solution&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/why-should-you-not-include-tel/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Why should you not include telerik controls in your SharePoint products?&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/have-all-the-tools-of-a-first/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Have all the tools of a first class startup's in 10 min&nbsp;<div class=tag>Visual Studio</div></span></a><a class=panel-block href=https://baywet.github.io/migrating-team-foundation-serv/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Migrating Team Foundation Server 2010 to Visual Studio Online: difference of process model&nbsp;<div class=tag>Visual Studio</div></span></a><a class=panel-block href=https://baywet.github.io/the-roadmap-for-office-365-is/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>The roadmap for Office 365 is available&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/selected-for-sharepoint-saturd/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Selected for SharePoint Saturday New York City&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/auto-hosted-applications-are-d/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Auto-hosted applications are deprecated&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/the-former-msp-becomes-mvp/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>The former MSP becomes MVP&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/write-a-review-on-infopaths-re/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Write a review on infopath’s replacer!&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/outstanding-announcements-of-t/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Outstanding announcements of the SharePoint Conference 2014 for Office 365&nbsp;<div class=tag>Sharepoint</div></span></a><a class=panel-block href=https://baywet.github.io/anonymous-access-for-sharepoin/><span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
<span>&nbsp;</span>
<span>Anonymous access for SharePoint autohosted apps&nbsp;<div class=tag>Sharepoint</div></span></a></nav></div></section><footer class=footer><div class=container><nav class=level></nav><nav class=level><div class="level-left has-text-centered"><div class=level-item><form class="control has-icons has-icons-right" method=get action=https://bing.com><input class=input type=text name=q maxlength=255 placeholder=Search>
<input class=input type=hidden name=sites value=https://baywet.github.io/>
<span class="icon is-small is-right"><i class="fas fa-search"></i></span></form></div></div><div class="level-right has-text-centered"><div class=level-item><a class=button href=https://baywet.github.io/en><span class=icon><i class="fa fa-home"></i></span>
</a>&nbsp;
<a class=button href><span class=icon><i class="fas fa-rss"></i></span></a></div></div></nav></div></footer><script id=dsq-count-scr src=//baywet.disqus.com/count.js async></script></body></html>